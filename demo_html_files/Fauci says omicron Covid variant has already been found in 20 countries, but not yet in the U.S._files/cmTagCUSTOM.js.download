!function(){var e={9652:function(e){function t(e){window.cmTag=window.cmTag||{},e=e||{},this.unitType=e.unitType,this.className=this.className||e.className}t.prototype.info=function(e,t){this.hasLoggerMethod("info")&&window.cmTag.logger.info("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},t.prototype.debug=function(e,t){this.hasLoggerMethod("info")&&window.cmTag.logger.info("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},t.prototype.error=function(e,t){this.hasLoggerMethod("error")&&window.cmTag.logger.error("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},t.prototype.hasLoggerMethod=function(e){return window.cmTag&&window.cmTag.logger&&window.cmTag.logger[e]&&"function"==typeof window.cmTag.logger[e]},e.exports=t},2707:function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=i(9453),o=i(1999),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opions=t}var t,i,s;return t=e,(i=[{key:"getPreset",value:function(e){var t=e.key,i=e.value,n=e.unitType,s=e.platform;if(r[t]&&r[t][i]){var a=r[t],l=r[t].strength||1,c=r[t].atr||{};return c=o.extend(c,a[i].atr),a[i]&&a[i].units&&(c=this._getFromUnits(c,a[i].units,n,s)||c),{presetData:c,strength:l}}}},{key:"_getFromUnits",value:function(e,t,i,n){if(t[i]){var r=t[i].atr||{};return e=o.extend(e,r),t[i].platform&&(e=this._getByPlatform(e,t[i].platform,n)||e),e}}},{key:"_getByPlatform",value:function(e,t,i){if(t[i]){var n=t[i].atr||{};return e=o.extend(e,n)}}}])&&n(t.prototype,i),s&&n(t,s),e}();e.exports=s},2227:function(e){e.exports={strength:101,atr:{},1:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1,mntmbtwfs:999,mintimwf:999e3,mxtmbtwfs:999,time_between_waterfall:999}},onOutOfView:"pause",isPWOV:!1,noaop:1}},2:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},3:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1184655,"midroll.pubId":133128,"midroll.pubTagId":1184655,"postroll.pubId":133128,"postroll.pubTagId":1184655,pubId:133128,pubTagId:1184655,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},isPWOV:!1}},4:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1046821,"midroll.pubId":133128,"midroll.pubTagId":1046821,"postroll.pubId":133128,"postroll.pubTagId":1046821,pubId:133128,pubTagId:1046821,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},5:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":1633025,"midroll.pubId":133128,"midroll.pubTagId":1633025,"postroll.pubId":133128,"postroll.pubTagId":1633025,pubId:133128,pubTagId:1633025,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause",isPWOV:!1}}}},5413:function(e){e.exports={strength:102,1:{atr:{player:{settings:{encwfrs:!1}}}}}},3365:function(e){e.exports={strength:101,atr:{},1:{atr:{pixels:{startWithABT:{isFire:!0},getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0},secondsToCloseTimer:{isFire:!0},secondsToCloseGlobalTimer:{isFire:!0},midrollCollapseTimer:{isFire:!0}}}},2:{atr:{pixels:{getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0}}}}}},5650:function(e){var t={atr:{},platform:{Desktop:{atr:{}},Mobile:{atr:{secondsBW:20}}}},i={strength:1,atr:{},101:{atr:{pubId:165757,pubTagId:946347,preroll:{pubId:165757,pubTagId:946347},midroll:{pubId:165757,pubTagId:946347},postroll:{pubId:165757,pubTagId:946347}}},2:{atr:{secondsToClose:120,secondsBW:20}},3:{atr:{secondsToClose:120,pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},units:{FEED_MANAGER:t,INLINE_INSTREAM_OLD:t,INLINE_INSTREAM_VFORCE:t,SLIDER_INSTREAM:t,SLIDER_OUTSTREAM:t,WIDGET_ITEM:t}},4:{atr:{pubId:292045,pubTagId:1565025,preroll:{pubId:292045,pubTagId:1565025},midroll:{pubId:292045,pubTagId:1565025},postroll:{pubId:292045,pubTagId:1565025}}},5:{atr:{pubId:383725,pubTagId:2077655,preroll:{pubId:383725,pubTagId:2077655},midroll:{pubId:383725,pubTagId:2077655},postroll:{pubId:383725,pubTagId:2077655}}}};e.exports=i},2290:function(e){e.exports={strength:101,1:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}},2:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!1},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}},firstScroll:{isActive:!0,predictPoints:[0,0]}}}},3:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},4:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},5:{atr:{predictors:{multiAd:{isActive:!1},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},99:{atr:{predictors:{autoKill:{isActive:!1},getAdFail:{isActive:!1},multiAd:{isActive:!1},loading:{isActive:!1},repeat:{isActive:!1},playerReady:{isActive:!1},distancePercent:{isActive:!1},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},101:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}}}},9453:function(e,t,i){var n={};n.demo=i(2227),n.level=i(5650),n.isFireAllPixels=i(3365),n.predictorsPresets=i(2290),n.isDebug=i(5413),e.exports=n},3474:function(e){e.exports={"AR-EG":"إعلان","AR-AE":"إعلان","AR-SA":"إعلان","CS-CZ":"Reklama","DA-DK":"Annonce","DE-DE":"Anzeige","DE-AT":"Anzeige","DE-CH":"Anzeige","EL-GR":"Ad","EN-AE":"Ad","EN-AU":"Ad","EN-CA":"Ad","EN-GB":"Ad","EN-IE":"Ad","EN-IN":"Ad","EN-SG":"Ad","EN-PH":"Ad","EN-MY":"Ad","EN-NZ":"Ad","EN-US":"Ad","EN-ZA":"Ad","EN-XL":"Ad","ES-ES":"Publicidad","ES-AR":"Patrocinado","ES-CO":"Patrocinado","ES-CL":"Patrocinado","ES-PE":"Patrocinado","ES-MX":"Patrocinado","ES-US":"Patrocinado","ES-XL":"Patrocinado","ES-VE":"Patrocinado","EN-ID":"Ad","FI-FI":"Mainos","FR-FR":"Sponsorisé","FR-BE":"Sponsorisé","FR-CA":"Pub","FR-CH":"Sponsorisé","HE-IL":"מודעה","HI-IN":"एड","HU-HU":"Hird.","ID-ID":"Ad","IT-IT":"Ann.","JA-JP":"PR","KO-KR":"AD","NB-NO":"Annonse","NL-NL":"Adv","NL-BE":"Adv","PL-PL":"Reklama","PT-BR":"Publicidade","PT-PT":"Pub","RU-RU":"Реклама","SV-SE":"Annons","TH-TH":"Ad","TR-TR":"R","VI-VN":"Ad","ZH-CN":"广告 ","ZH-TW":"廣告","ZH-HK":"廣告"}},2130:function(e){e.exports={UNIT_TYPES:{INLINE:0,INTERSTITIAL:1,SLIDER_OUTSTREAM:2,SLIDER_INSTREAM:3,EXPANDABLE:4,"300X600":5,INLINE_FEED:6,COFFEEBREAK:7,SLIDESHOW:8,INLINE_INSTREAM:9,COFFEEBREAK_MOBILE:10,"300X600_MOBILE":11,INLINE_MOBILE:12,INTERSTITIAL_MOBILE:14,SLIDER_OUTSTREAM_MOBILE:15,SLIDER_INSTREAM_MOBILE:16,EXPANDABLE_MOBILE:17,INLINE_INSTREAM_MOBILE:18,INLINE_OUT_OF_VIEW:19,INLINE_OUT_OF_VIEW_MOBILE:20,INLINE_VIEWABILITY_EXPAND:21,INLINE_VIEWABILITY_EXPAND_MOBILE:22,INLINE_INSTREAM_VIEWABILITY_EXPAND:23,INLINE_INSTREAM_VIEWABILITY_EXPAND_MOBILE:24,INLINE_FEED_MOBILE:25,WIDGET_ITEM:26,WIDGET_ITEM_MOBILE:27,NEW_INLINE:28,NEW_INLINE_MOBILE:29,NEW_INLINE_ADJACENT:30,NEW_INLINE_ADJACENT_MOBILE:31,FEED_MANAGER:32,FEED_MANAGER_MOBILE:33,MSN_WIDGET:34,SLIDER_INSTREAM_VFORCE:36,SLIDER_INSTREAM_MOBILE_VFORCE:37},STREAM_TYPES:{IN_STREAM:1,OUT_STREAM:0},UNITS_STREAM_TYPE:{INLINE:0,INTERSTITIAL:0,SLIDER_OUTSTREAM:0,SLIDER_INSTREAM:1,EXPANDABLE:1,"300X600":1,OMNI_TAG:0},APPEND_TYPE:{BEFORE_BEGIN:0,AFTER_BEGIN:1,BEFORE_END:2,AFTER_END:3,beforebegin:0,afterbegin:1,beforeend:2,afterend:3},INVALID_SELECTOR_TAG_NAMES:{IMG:0,UL:1,BUTTON:3,INPUT:4,LABEL:5},OMNI_TAG_UNIT_NAMES:{rightrail1:1,rightrail2:2,rightrail3:3,inlineTop:4,inlineMiddle:5,inlineBottom:6,interstitial:7,sliderOutstream1:8,sliderOutstream2:9,sliderInstream1:10,sliderInstream2:11,coffeeBreak:12,expandable1:13,expandable2:14,expandable3:15,invalidUnitName:1e3},ROLL_TYPE:{preroll:0,"pre-roll":0,midroll:-1,"mid-roll":-1,postroll:-2,"post-roll":-2},TAB_STATE:{focus:0,blur:1,tabOut:2},DFP_KEYWORDS:["google","dfp","gpt"],MIME_TYPES:{1:"video/mp4",5:"video/webm",7:"video/ogg",10:"video/mp4",11:"video/ogg",12:"video/webm"},SUB_UNIT_TYPE:{PLAIN:0,START_FROM_SLIDER:1,DETACH_TO_SLIDER:2,SUPER_SLIDER:3,INLINE_SINGLE_SELECTOR:4,INLINE_MULTI_SELECTOR:5,STICKY_BELOW:6,STICKY_ABOVE:7,STICKY_BELOW_ABOVE:8,WIDGET:9},FEED_SELECTOR:"tbl-feed-container",AD_CHOICE_TYPE:{TITLE:"title",VIDEO_AD:"videoAd",SLIDER:"slider"},REPLAY_AD_CLICK:{ALL:"all",RESTART_PLAYER:"restartPlayer"},DISPLAY_FILLER:{BEFORE_AD:{NONE:"none",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},BETWEEN_ADS:{LOADING:"loading",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},ON_TIMEOUT:{CLOSE:"close",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"}},TITLE_POSITION:{ABOVE:"above",BELOW:"below"},KIBANA_EVENTS:{start:"start",renderWasCalled:"renderWasCalled",getAd:"getAd",getAdFailed:"getAdFailed",gotAd:"gotAd",adPlay:"adPlay",conversion:"conversion",adPaused:"adPaused",viewability:"viewability",continueAd:"continueAd",adComplete:"adComplete",firstEligibility:"firstEligibility",unitCloseByUser:"unitCloseByUser",unitClosedByMidRollTimeOut:"unitClosedByMidRollTimeOut",attach:"attach",detach:"detach",topParentSelectorLost:"topParentSelectorLost",playerWidthLost:"playerWidthLost",playerHeightLost:"playerHeightLost",invalidCDBobject:"invalidCDBobject",rvHandlerState:"rvHandlerState",playerHasRvInQ:"playerHasRvInQ",rvHandlerTimerExpired:"rvHandlerTimerExpired",D2DClick:"D2DClick"},DEBUG_DATA:{pn:"pn",sqg:"sqg",sqv:"sqv",rv:"rv",sqp:"sqp",rvps:"rvps",rvvs:"rvvs",pps:"pps",ppsc:"ppsc",vms:"vms",gpps:"gpps",gppsc:"gppsc",ft:"ft",fsc:"fsc",fpc:"fpc",sa:"sa",pi:"pi",dt:"dt",vb:"vb",dur:"dur",ttv:"ttv",bovpg:"bovpg",bovpv:"bovpv",be:"be",pap:"pap",mty:"mty",esv:"esv",rot:"rot",roid:"roid",rom:"rom",tti:"tti"},DEBUG_DATA_PIXELS:{ft:"ft",fsc:"fsc",fpc:"fpc"},PREDICT_NAMES:{distancePercentPredict:0,distancePixelsPredict:1,getAdFailPredict:2,loadingPredict:3,multiAdPredict:4,playerReadyPredict:5,repeatPredict:6,autoKillPredict:7,firstScrollPredict:8,emptyQueuePredict:9,bForcePredict:10,intersectionPredict:11,fullEligibilityPredict:12,feedXPredict:13,adProgressionAfterBeginPredict:14,adProgressionBeforeEndPredict:15,feedContainerChangedPredict:16,mp4Predict:17,timePredict:19,transitionPredict:20,feedCardsPredict:22,msnFullEligibilityPredict:23},ANIMATION_TYPE:{none:0,attaching:1,detaching:2,expanding:3,collapsing:4},FLOATING_VIEW_TOP_COMPONENT:{video:0,loading:1,repeat:2,d2d:3,content:4},FRAME_TYPE:{plainPage:0,friendlyIframe:1,nonFriendlyIframe:2,amp:3,inApp:4},CHECK_FOR_RV_PRIORITY:{onEligibility:"hasReachedEligibility",pixelsFromSelector:"hasReachedPixelsFromSelector",intersectionPercent:"intersectionPercent",beforeLoaderEnd:"beforeLoaderEnd"},TIMER_NAMES:{viewability:"viewability",viewabilityOneS:"viewabilityOneS",viewability100:"viewability100",viewabilityAMP:"viewabilityAMP"},AD_STATUS:{new:0,adLoaded:1,startAd:2,adImpression:3,adPlay:4,adError:5,adComplete:6},GENERAL_ERROR:{1:"empty data from player"},CSS_PROPERTIES_FROM_RBOX:["font","@font-face","font-family","font-feature-settings","@font-feature-values","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","line-break","line-height","outline","outline-color","outline-offset","outline-style","outline-width","text-decoration-line","text-underline-position","padding","padding-bottom","padding-left","padding-right","padding-top","margin","margin-bottom","margin-left","margin-right","margin-top","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","text-transform","z-index","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-indent","text-justify","text-orientation","text-overflow","text-shadow","text-transform","text-underline-position","direction","color"],NATIVE_AD:{DESC_TITLE_FONT_RATIO:.8,FIT_TO_SIZE:{TITLE:"title",FULL:"full",NONE:"none"}},UNIT_QUERY_LANGUAGE:{SUPPORTED_CONFIG_FLAGS:["stickyCard"],MAPPING:[{search:"@Ad@",replaceWith:"activeAd"}]},RV_TYPES:{NON_RV:0,RV:1,ANY:"any"},VIDEO_READY_STATE:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},TRC_PERFORMANCE_ACTIONS:{START:"Start",STOP:"Stop"},OS:{IOS:"iOS"},BROWSER:{IE:"IE",EDGE:"Edge",FIREFOX:"Firefox"},WF_ACTION:{START:"start",STOP:"stop"},TIME_UNITS:{SECOND:1e3},MINUTELY_AD_STATUS:{PLAY:"play",CLOSE:"close"},DEFAULT_TIME_LIMITS:{REPEAT_SLIDER_TIMER_SECS:5e3},CANCEL_GET_AD_REASONS:{LOST_ELIGIBILITY:"cancelGetAdOnLostEligibility"},ARROW_KEYS_CODES:{LEFT:37,UP:38,RIGHT:39,DOWN:40}}},5264:function(e){e.exports={player:void 0,oppsula:void 0,pms:void 0,serviceLoader:void 0,microServices:{base_url:"//vidstat.taboola.com/",async:!0,PMS:{version:"2.2.1"}}}},2167:function(e,t,i){var n=i(1999);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t.model,this.subModel=t.subModel?t.subModel:null,this.observerOptions={root:null,rootMargin:"0px",threshold:n.buildObserverThresholdList()},this.model.get("isSliderOn")?this._createSliderObserver():this._createFeedObserver()}var t,i,o;return t=e,(i=[{key:"_createSliderObserver",value:function(){this.intersectionObserver=new IntersectionObserver(function(e){var t=this;e.map((function(e){t.updateModel("isViewableAMP",e.intersectionRect.height+5>=t.model.get("detachToSlider.height"))}))}.bind(this),this.observerOptions)}},{key:"_createFeedObserver",value:function(){this.intersectionObserver=new IntersectionObserver(function(e){var t=this;e.map((function(e){t.updateModel("isViewableAMP",e.intersectionRatio>.5)}))}.bind(this),this.observerOptions)}},{key:"startObserver",value:function(e){this.updateModel("isViewableAMP",!1),this.intersectionObserver.observe(e)}},{key:"stopObserver",value:function(e){this.intersectionObserver.unobserve(e),this.intersectionObserver.disconnect()}},{key:"updateModel",value:function(e,t){null!=this.subModel&&this.subModel.set(e,t),this.model.set(e,t)}}])&&r(t.prototype,i),o&&r(t,o),e}();e.exports=o},5422:function(e){function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=null,n=function(e){return/\{\s*\[native code\]\s*\}/.test(""+e)},r=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i||(i=this),i}var r,o,s;return r=e,(o=[{key:"set",value:function(e,t,i){n(window[e])&&n(window[e].prototype[t])||(this.iframe||this.createIframe(),this.iframe.contentWindow[e].prototype[t]&&(window[e].prototype||(window[e]=function(){}),window[e].prototype[t]=this.iframe.contentWindow[e].prototype[t],i&&(window[e]=this.iframe.contentWindow[e])))}},{key:"setWindowFunctions",value:function(e){e&&(this.iframe||this.createIframe(),e.split(",").forEach(function(e){var t=e.split(".");this.setWindowNestedFunctions(window,t)}.bind(this)))}},{key:"createIframe",value:function(){this.iframe=document.createElement("iframe"),this.iframe.style.width=0,this.iframe.style.height=0,this.iframe.style.visibility="hidden",this.iframe.style.display="none",document.body.appendChild(this.iframe)}},{key:"setWindowNestedFunctions",value:function(e,t){var i=t.shift();0==t.length?e[i]=this.iframe.contentWindow[i]:this.setWindowNestedFunctions(e[i],t)}}])&&t(r.prototype,o),s&&t(r,s),e}();e.exports=new r},9006:function(e){function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arrayFrom()}var i,n,r;return i=e,n=[{key:"arrayFrom",value:function(){var e,t,i,n;Array.from||(Array.from=(e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},i=Math.pow(2,53)-1,n=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),i)},function(e){var i=this,r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,s=arguments.length>1?arguments[1]:void 0;if(void 0!==s){if(!t(s))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var a,l=n(r.length),c=t(i)?Object(new i(l)):new Array(l),d=0;d<l;)a=r[d],c[d]=s?void 0===o?s(a,d):s.call(o,a,d):a,d+=1;return c.length=l,c}))}}],n&&t(i.prototype,n),r&&t(i,r),e}();e.exports=i},3629:function(e,t,i){var n=i(1999),r=i(2130),o=i(5422),s=i(9006),a=function(e){n.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoBeforeCMTagNativeCode",r.TRC_PERFORMANCE_ACTIONS.START),o.set("Function","bind"),o.set("Event","constructor",!0),o.set("Array","forEach",!1),o.set("Array","every",!1),o.setWindowFunctions(e.nativeFunctions),n.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoBeforeCMTagNativeCode",r.TRC_PERFORMANCE_ACTIONS.STOP),new s,window.cmTag.customDataForTest={startWithABT:!1},!!e.gaFactor&&n.isFactor(parseInt(e.gaFactor))&&window.addEventListener("error",(function(t){try{if(-1==t.filename.indexOf("infra/cmTag"))return;var i={timestamp:(new Date).toISOString(),message:t.message,lineNum:t.lineno,fullUrl:window.location.href,userAgent:window.navigator.userAgent,firedStartWithABT:window.cmTag.customDataForTest.startWithABT,unitType:e.unitType};t.error&&(i.callStack=t.error.stack);var n=new XMLHttpRequest;n.open("POST","//vidanalytics.taboola.com/putes/cm_units_error_logs",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var r=JSON.stringify(i);n.send(r)}catch(t){}}))};e.exports=a},7904:function(e,t,i){e.exports={beforeCMTag:i(3629)}},5545:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});var n=i(5281);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.unitType,o=t.className,s=t.logger,a=void 0===s?n.Z.getInstance():s,l=t.version,c=t.isDebug,d=void 0===c||c;r(this,e),this._logger=a,this.unitType=i,this.className=o,this.version=l,this.isDebug=d}var t,i,s;return t=e,(i=[{key:"info",value:function(e,t){this._logger.info("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"success",value:function(e,t){this._logger.success("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"important",value:function(e,t){this._logger.important("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"warning",value:function(e,t){this._logger.warning("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"pixel",value:function(e,t){this._logger.pixel("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"debug",value:function(e,t){this.isDebug&&this._logger.debug("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"error",value:function(e,t){this.isDebug&&this._logger.error("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"ga",value:function(e){this._logger.ga(this.unitType,e,this.version)}},{key:"ul",value:function(e,t,i){this._logger.ul(e,t,i)}},{key:"predict",value:function(e){this._logger.predict("unit type: ".concat(this.unitType,", predictor: ").concat(this.className,", predictlog: ").concat(e))}}])&&o(t.prototype,i),s&&o(t,s),e}()},5281:function(e,t,i){"use strict";function n(e,t,i){return n=r()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&o(r,i.prototype),r},n.apply(null,arguments)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.d(t,{Z:function(){return B}});var a=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"instance"in this.constructor)throw new Error("Cannot instantiate more than one '".concat(this.constructor.name,"'"));if("Singleton"==this.constructor.name)throw new Error("Cannot instantiate abstract class 'Singleton'");this.constructor.instance=this}var t,i,r;return t=e,r=[{key:"getInstance",value:function(){return"instance"in this||this.create.apply(this,arguments),this.instance}},{key:"create",value:function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return n(e,i)}}],(i=null)&&s(t.prototype,i),r&&s(t,r),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t,i){return c=p()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&u(r,i.prototype),r},c.apply(null,arguments)}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function h(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var t,i,n,r,o,s=(t=a,i=p(),function(){var e,n=f(t);if(i){var r=f(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return h(this,e)});function a(e,t){var i,n,r,o,l,c,d,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this)).version=e,i.isGa=t,i.isGa&&(window.ga&&"function"==typeof window.ga||(n=window,r=document,o="script",l="//www.google-analytics.com/analytics.js",c="ga",n.GoogleAnalyticsObject=c,n[c]=n[c]||function(){(n[c].q=n[c].q||[]).push(arguments)},n[c].l=1*new Date,d=r.createElement(o),u=r.getElementsByTagName(o)[0],d.async=1,d.src=l,u.parentNode.insertBefore(d,u),window.ga("create","UA-66399520-1","auto"),window.ga("send","pageview")),i._setup()),i}return n=a,o=[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return c(a,t)}}],(r=[{key:"_setup",value:function(){window.ga("create","UA-66399520-1","auto",{name:"cmGa"}),window.ga("cmGa.send","pageview")}},{key:"send",value:function(e,t){this.isGa&&window.ga("cmGa.send","event",e+" "+this.version,t,location.host)}}])&&d(n.prototype,r),o&&d(n,o),a}(a);var g=i(9057);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t,i){return v=T()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&_(r,i.prototype),r},v.apply(null,arguments)}function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function w(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(a,e);var t,i,n,r,o,s=(t=a,i=T(),function(){var e,n=P(t);if(i){var r=P(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return w(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this)}return n=a,o=[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return v(a,t)}}],(r=[{key:"send",value:function(e,t,i){i||(i="ul");var n=JSON.stringify({timestamp:(new Date).toISOString(),type:e,data:t});g.default.ajax({type:"POST",url:"//vidanalytics.taboola.com/putes/"+i,data:n,contentType:"text/plain"})}}])&&b(n.prototype,r),o&&b(n,o),a}(a);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function E(e,t,i){return E=I()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&O(r,i.prototype),r},E.apply(null,arguments)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}function D(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}var x=i(1999),B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(a,e);var t,i,n,r,o,s=(t=a,i=I(),function(){var e,n=R(t);if(i){var r=R(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return D(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.addTrace,n=void 0!==i&&i,r=t.isDebug,o=void 0!==r&&r,l=t.isConsole,c=void 0===l?o:l,d=t.isSaveLog,u=void 0===d?o:d,h=t.extraLogGA,p=void 0!==h&&h,f=t.version,g=t.isGA;return C(this,a),(e=s.call(this)).addTrace=n,e.isDebug=x.parseBool(o),e.isConsole=x.parseBool(c),e.isSaveLog=x.parseBool(u),e.isGA=x.parseBool(g),e.extraLogGA=p,e._ga=m.getInstance(f,e.isGA),e._ul=S.getInstance(),e.dataIndexName="units_debug_logs",e.isDebug&&(window.cmLogs=window.cmLogs||[]),e.initModel={},e}return n=a,o=[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return E(a,t)}}],(r=[{key:"pushLog",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(window.cmLogs.push({ts:(new Date).getTime(),message:e,obj:t}),"cmTag: init"===e&&(this.initModel=t,this.initModel["debugDataStore.indexName"]&&(this.dataIndexName=this.initModel["debugDataStore.indexName"]),console.log("cmTag: init obj:",JSON.stringify(t)),this.sessionID=this.getUniqSessionId(),this.showSessionID()),this.initModel["debugDataStore.isActive"]&&this.sendToServer(e,t))}},{key:"info",value:function(e,t){this.isDebug&&this._hasConsoleMethod("info")&&(console.info("cmTag: ".concat(e),t),this.pushLog("cmTag: ".concat(e),t),this.addTrace&&this._hasConsoleMethod("trace")&&console.trace())}},{key:"debug",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: RoyalBlue",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"error",value:function(e,t){this._hasConsoleMethod("error")&&(console.error("cmTag: ".concat(e),t),this.pushLog("cmTag: ".concat(e),t))}},{key:"ga",value:function(e,t,i){return this.extraLogGA&&this.info("GA extra log",{unitType:e,action:t,version:i}),this._ga.send(e,t,i)}},{key:"ul",value:function(e,t,i){return this._ul.send(e,t,i)}},{key:"success",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: green",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"important",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: purple",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"warning",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: orange",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"pixel",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: #00A0B2",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"sendToServer",value:function(e,t){var i="no data";try{var n=JSON.stringify(t);t&&(i=n)}catch(e){}var r="".concat(this.initModel["player.settings.kbnul"],"/putes/").concat(this.dataIndexName);g.default.ajax({type:"POST",url:r,data:JSON.stringify({message:e,dataObject:i,timestamp:(new Date).toISOString(),sessionID:this.sessionID}),contentType:"text/plain"})}},{key:"getUniqSessionId",value:function(){return"".concat(this.getRandomNumber()).concat(this.getRandomNumber()).concat(this.getRandomNumber())}},{key:"showSessionID",value:function(){var e=document.createElement("div");e.setAttribute("id","_cm-session-id-div"),e.setAttribute("style","background: black; color: wheat; position: fixed; top: 0; left: 0;z-index:999999999");var t=document.createTextNode("SessionID: ".concat(this.sessionID)),i=document.createElement("button");i.innerHTML="X",i.addEventListener("click",(function(){document.querySelector("#_cm-session-id-div").remove()})),e.appendChild(t),e.appendChild(i),document.querySelector("body").appendChild(e)}},{key:"getRandomNumber",value:function(){return Math.floor(10*Math.random())}},{key:"_hasConsoleMethod",value:function(e){return console&&console[e]&&"function"==typeof console[e]}},{key:"predict",value:function(e){this.info("%c ".concat(e),"color: #bada55")}}])&&k(n.prototype,r),o&&k(n,o),a}(a)},9245:function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=i(9288),o=i(1999),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callBacks={},this._mapCallbackNames(),this._setCallbacks(t)}var t,i,s;return t=e,(i=[{key:"_setCallbacks",value:function(e){this.isValidCallback(e,this.callbackNames.conversion)&&(this.callBacks.onConversion=e.onConversion,r.on("global:creativeEvent",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.conversion))),this.isValidCallback(e,this.callbackNames.fill)&&(this.callBacks.onFilledImpression=e.onFilledImpression,r.on("filledImpression",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.fill))),this.isValidCallback(e,this.callbackNames.impression)&&(this.callBacks.onImpression=e.onImpression,r.on("onImpression",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.impression))),this.isValidCallback(e,this.callbackNames.play)&&(this.callBacks.onPlay=e.onPlay,r.on("global:adState:playing",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.play))),this.isValidCallback(e,this.callbackNames.terminate)&&(this.callBacks.onTerminate=e.onTerminate,r.once("global:closeState:changed",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.terminate))),this.isValidCallback(e,this.callbackNames.passback)&&(this.callBacks.onPassback=e.onPassback,r.once("global:passback",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.passback)))}},{key:"_onGlobalCreativeEvent",value:function(e,t,i){t=t||{},this.callBacks[t.type]&&this.callBacks[t.type](i),t.name&&TRC&&TRC.dispatch&&TRC.dispatch("api::video."+t.name,e)}},{key:"isValidCallback",value:function(e,t){if("string"==typeof e[t.type]){var i=this._getCallbackFunction(e[t.type]),n=new Function("additionalData",i);delete e[t.type],Object.defineProperty(e,t.type,{value:n})}return!(!o.isFunction(e[t.type])&&!this._isApiCallbackExist(t.name))}},{key:"_getCallbackFunction",value:function(e){var t=e.substr(e.indexOf("{")+1);return t.substr(0,t.lastIndexOf("}"))}},{key:"_isApiCallbackExist",value:function(e){if(TRC&&TRC._taboolaClone)for(var t=0;t<TRC._taboolaClone.length;t++)if(TRC._taboolaClone[t].listenTo=="video."+e)return!0;return!1}},{key:"_mapCallbackNames",value:function(){this.callbackNames={conversion:{type:"onConversion",name:"conversion"},fill:{type:"onFilledImpression",name:"fill"},impression:{type:"onImpression",name:"impression"},play:{type:"onPlay",name:"play"},terminate:{type:"onTerminate",name:"terminate"},passback:{type:"onPassback",name:"passback"}}}}])&&n(t.prototype,i),s&&n(t,s),e}();e.exports=s},9791:function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=i(1999),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,o;return t=e,(i=[{key:"addUnit",value:function(e,t){r.isEmpty(window.TRC.videoUnitList)&&(window.TRC.videoUnitList={}),this.unitsList=window.TRC.videoUnitList||{},this.unitsList[e]=t,window.TRC.videoUnitList=this.unitsList,this._listenUnitsEvents(e)}},{key:"_listenUnitsEvents",value:function(e){this.unitsList[e].on("change:isUnitEligible",this._onUnitEligibilityChange.bind(this,e))}},{key:"_onUnitEligibilityChange",value:function(e,t,i){r.size(this.unitsList)>1&&(!0===i||!1===i)&&this._decidePlayOrPause()}},{key:"_decidePlayOrPause",value:function(){var e=this,t=[];r.each(this.unitsList,(function(i){var n=i.get("redId"),r="CUSTOM"==e._getUnitType(n);e._isUnitEligibleToPlay(n)?t.push({redId:n,viewPercent:i.get("unitViewablePercent"),isCustomVideo:r}):r&&e._pauseUnit(n)})),t.length>0&&(t=this._sortViewableUnits(t),r.each(t,(function(t,i){0===i?e._playUnit(t.redId):t.isCustomVideo&&e._pauseUnit(t.redId)})))}},{key:"_sortViewableUnits",value:function(e){return e.sort((function(e,t){return e.isCustomVideo===t.isCustomVideo?t.viewPercent-e.viewPercent:!e.isCustomVideo&&t.isCustomVideo?-1:1}))}},{key:"_pauseUnit",value:function(e){this.unitsList[e].set("multiUnitManager.state","pause")}},{key:"_playUnit",value:function(e){this.unitsList[e].set("multiUnitManager.state","play")}},{key:"_isUnitEligibleToPlay",value:function(e){return this.unitsList[e].get("isEligibleToPlay")||this.unitsList[e].get("isUnitEligible")||this.unitsList[e].get("isUnitViewable")}},{key:"_isUnitAllowToPlay",value:function(e){return"pause"!=this.unitsList[e].get("multiUnitManager.state")&&this._isUnitEligibleToPlay(e)}},{key:"_isUnitPlaying",value:function(e){return this.unitsList[e].get("generalPlayingUnitState")}},{key:"_getUnitType",value:function(e){return this.unitsList[e].get("unitType")}}])&&n(t.prototype,i),o&&n(t,o),e}();cmTag.multiUnitManager=cmTag.multiUnitManager||new o,e.exports=cmTag.multiUnitManager},9831:function(e){e.exports={readyState:"ready",adManagerState:{empty:"empty",hasAds:"hasAds",stopped:"stopped",paused:"paused"},adState:{failed:"failed",playing:"playing",paused:"paused",continueAd:"continueAd",completed:"completed",autoKill:"autoKill",repeating:"repeating",skipped:"skipped"},adQState:{impression:"impression",q0:"q0",q1:"q1",q2:"q2",q3:"q3",completed:"completed",repeating:"repeating"},getAdState:{notCalled:"notCalled",gettingAd:"gettingAd",gotAd:"gotAd",waiting:"waiting",failed:"failed",stopped:"stopped",finished:"finished"},playerState:{error:"error",stopped:"stopped",closed:"closed",restarted:"restarted"},containerViewState:{rendered:"rendered",eligible:"eligible",playing:"playing",collapsed:"collapsed",attached:"attached",detached:"detached"},videoViewState:{rendered:"rendered",attached:"attached",detached:"detached"},repeatState:{hiding:"hiding",showing:"showing",spinning:"spinning",clicked:"clicked"},loadingViewState:{hiding:"hiding",showing:"showing",clicked:"clicked"},clickThruState:{clicked:"clicked",waiting:"waiting"},timerState:{working:"started",paused:"paused",stopped:"stopped",done:"done"},closeState:{terminate:"terminate",containerViewClosed:"containerViewClosed",videoViewClosed:"videoViewClosed",adManagerStop:"adManagerStop",playerClosed:"playerClosed"},tabState:{focus:"focus",blur:"blur",tabOut:"tabOut"},rvHandlerState:{working:"working",idle:"idle"},floatingView:{detach:"detach",attach:"attach",postAttach:"postAttach",permanentClosed:"permanentClosed"},externalUnit:{playing:"playing",stopped:"stopped"},brandingDisplayState:{show:"show",hide:"hide"},storiesUnitState:{videoImpression:"videoImpression",videoPause:"videoPause",videoResume:"videoResume",videoEnd:"videoEnd",videoViewable:"videoViewable"},storiesRboxState:{onVideoCardDisplayed:"onVideoCardDisplayed",categoriesHidden:"categoriesHidden",categoriesDisplay:"categoriesDisplay",videoSkipped:"videoSkipped"}}},9861:function(e,t,i){"use strict";i.r(t);var n=i(2130),r=i.n(n),o=i(9057);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var a=i(1999),l=a.flatten;a.mixin({parseBool:function(e){return"true"===e||!0===e||1===e||"1"===e},hasFlash:function(){return void 0===navigator.plugins||0==navigator.plugins.length?function(){try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return!1}}():!!navigator.plugins["Shockwave Flash"]},el:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(e);for(var n in t)null!=t[n]&&(i[n]=t[n]);return i},loadJs:function(e,t){return document.head.appendChild(a.el("script",{src:e,onload:t}))},loadCss:function(e,t){return document.head.appendChild(a.el("link",{href:e,onload:t,rel:"stylesheet",type:"text/css"}))},loadJsArr:function(e,t){var i;t&&(i=e.length);for(var n=0;n<e.length;n++)e[n].indexOf(".css")>-1?a.loadCss(e[n],r):a.loadJs(e[n],r);function r(){0===--i&&t()}},getUrlVars:function(e){for(var t,i=[],n=(e=e||window).location.href.slice(e.location.href.indexOf("?")+1).split("&"),r=0;r<n.length;r++)t=n[r].split("="),i.push(t[0]),i[t[0]]=t[1];return i},firePixelConditional:function(e,t,i,n){e&&a.firePixel(t,i,n)},firePixel:function(e,t,i){e&&(i&&(e=a.addParametersToUrl(e,i,-1===e.indexOf("?"))),cmTag.logger.pixel("firing pixel: "+t+" url: "+e),document.createElement("IMG").src=e)},fireIframePixel:function(e,t){if(e){cmTag.logger.pixel("firing pixel: "+t+" url: "+e);var i=document.createElement("iframe");i.src=e,i.style.display="none";var n=document.getElementsByTagName("body")[0];n||(n=document.getElementsByTagName("html")[0]),n||(n=document.getElementsByTagName("div")[0]),n?n.appendChild(i):cmTag.logger.debug("fireIframePixel","Failed to fire iframe pixel.")}else cmTag.logger.pixel("fireIframePixel","Url empty.")},getViewabilityPercent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.offsetWidth,n=e.getBoundingClientRect(),r={top:Math.max(0,n.top),bottom:Math.min(a.viewport().height,n.bottom),left:Math.max(0,n.left),right:Math.min(a.viewport().width,n.right)};return 100*(r.bottom-r.top)*(r.right-r.left)/(t*i)},isVisible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.offsetWidth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return a.getViewabilityPercent(e,t,i)>=n},viewport:function(){return{get height(){return a.viewport().object.document.documentElement.clientHeight},get width(){return a.viewport().object.document.documentElement.clientWidth},get object(){return top}}},getVideoHeight:function(e){var t=parseInt(9/16*e);return isNaN(t)?0:t},getVideoWidth:function(e){var t=parseInt(16/9*e);return isNaN(t)?0:t},getVideoBestSize:function(e,t){var i=this.getVideoHeight(e);return t>=i?t=i:e=this.getVideoWidth(t),{width:e,height:t}},getVideoHeightByRatio:function(e,t){var i=parseInt(1/t*e);return isNaN(i)?0:i},getVideoWidthByRatio:function(e,t){var i=parseInt(t*e);return isNaN(i)?0:i},isElementInHead:function(e){if(!e)return!1;for(;e!==document.body&&e!==document.head;)e=e.parentNode;return e===document.head},getViewPercent:function(e,t,i,n){var r,s=a.isEmpty(n)?(0,o.default)(this.getTopWindow()):(0,o.default)(n);r=window.taboolaBridge&&window.taboolaBridge.active?this.calcViewportPositionInApp(n):{top:0,left:0,right:s.width(),bottom:s.height()};var l=Number(i)||0,c=Number(t)||0,d=e.getBoundingClientRect(),u={top:d.top,left:d.left};if(u.right=u.left+c,u.bottom=u.top+l,r.right<u.left||r.left>u.right||r.bottom<u.top||r.top>u.bottom)return 0;var h=Math.min(1,(u.bottom-r.top)/l),p=Math.min(1,(r.bottom-u.top)/l);return Math.min(1,(u.right-r.left)/c)*Math.min(1,(r.right-u.left)/c)*h*p*100},isViewable:function(e,t,i,n){var r=a.getViewPercent(e,t,i);return!(r<=0)&&r>=(n=n||100)},getViewPercentageDeltas:function(e,t,i){var n=(0,o.default)(window),r={top:n.scrollTop(),left:n.scrollLeft()};r.right=r.left+n.width(),r.bottom=r.top+n.height();var s=Number(i)||0,a=Number(t)||0,l=(0,o.default)(e).offset();return l.right=l.left+a,l.bottom=l.top+s,{top:Math.min(1,(l.bottom-r.top)/s),bottom:Math.min(1,(r.bottom-l.top)/s),left:Math.min(1,(l.right-r.left)/a),right:Math.min(1,(r.right-l.left)/a)}},getValidSelectorElements:function(e,t,i){var n=[];return t=t||100,i=i||0,e&&a.isArray(e)&&(n=a.filter(e,(function(e){var n=e.getBoundingClientRect();return n.width>=t&&n.height>=i&&!a.has(r().INVALID_SELECTOR_TAG_NAMES,e.tagName)}))),n},filterObject:function(e,t){if(e){for(var i={},n=0;n<t.length;n++){var r=e[t[n]];void 0!==r&&(i[t[n]]=r)}return i}},assignWithoutUndefinedValues:function(e,t){for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e},stripObject:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;if(e){var s={};for(var l in e)if(!(l in t)){var c=e[l];n&&a.isElement(c)||i&&a.isFunction(c)||(r&&!a.isFunction(c)&&a.isObject(c)&&(c=o>0?this.stripObject(c,[],i,n,r,o--):"{stripElements} - value is Object, but max depth reached."),s[l]=c)}return s}},arrayToObj:function(e){if(e){for(var t={},i=0;i<e.length;i++)void 0!==e[i]&&(t[i]=e[i]);return t}},getTopOfEl:function(e){if(e){var t=e,i=0;if(document.getElementById||document.all)do{for(e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent,t=a.getParentNode(t);t!=e;)t.scrollLeft,i-=t.scrollTop,t=a.getParentNode(t)}while(e&&e.offsetParent);else document.layers&&(i+=e.y,e.x);return i}},getParentNode:function(e){return e.parentNode&&e.parentNode.host?e.parentNode.host:e.parentNode},getLeftOfEl:function(e){return window.pageXOffset+e.getBoundingClientRect().left},PrefixedEvent:function(e,t,i,n){i=i.toLowerCase(),a.each(["webkit","moz","MS","o",""],(function(r){e[t](r+i,n)}))},oneAnimationEnd:function(e,t){var i=a.debounce(t,200);this.PrefixedEvent(e,"one","transitionend",i),this.PrefixedEvent(e,"one","animationend",i)},addParametersToUrl:function(e,t,i){var n=e;return n+=i?"?":"&",o.default.each(t,(function(e,t){void 0!==t&&""!==t&&(n+=e+"="+t+"&")})),n},skipTransitionCss:function(e,t){e.addClass("none-transition"),e.css(t),this.flushCss(e[0]),e.removeClass("none-transition")},flushCss:function(e){e.offsetHeight},getTopWindow:function(){var e=window;try{for(;e.document!==e.top.document;)e=e.top;return e}catch(e){return window}},isInIframe:function(e){return!!e&&(e.inIframe||e.inDFP)},isInFriendlyIframe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cmTag.config.iframeData;return!!e&&(this.isInIframe(e)&&e.isFriendlyIframe)},hideDFPIframe:function(e){if(this.isInFriendlyIframe(e)){e.iframe.style.display="none";for(var t=e.iframe.parentNode;a.some(r().DFP_KEYWORDS,(function(e){return-1!==t.id.indexOf(e)}));)t.style.display="none",t=t.parentNode}},onceDocReady:function(e){return/complete|loaded|interactive/.test(document.readyState)&&document.body?e():(0,o.default)("document").one("DOMContentLoaded",e),this},crc32:function(e){if(!e||"string"!=typeof e)return 0;var t;void 0===t&&(t=0);var i=0;t^=-1;for(var n=0,r=(e=this.utf8Encode(e)).length;n<r;n++)i=255&(t^e.charCodeAt(n)),t=t>>>8^"0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*i,8);return-1^t},utf8Encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},isMouseOver:function(e){return 0!==e.filter(":hover").length},rollNumbers:function(e){return!!e&&100*Math.random()<e},isFactor:function(e){return a.isNumber(e)&&e===a.random(1,e)},sendMail:function(e,t,i){function n(){emailjs.init("user_kHlYxxusLRTxC6yr3PjQl"),emailjs.send("gmail","units_support",e).then(t,i)}t=t||function(){},i=i||function(){},window.emailjs?n():a.loadJs("//cdn.emailjs.com/dist/email.min.js",n)},isValidEmail:function(e){return!0},toCssObj:function(e){return"string"==typeof e?JSON.parse(e):e},isLayerVisible:function(e){function t(e,t){return window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle?e.currentStyle[t]:void 0}return function e(i,n,r,o,s,a,l){var c=i.parentNode;return!!function(e){for(;e=e.parentNode;)if(e===document)return!0;return!1}(i)&&(9===c.nodeType||"0"!==t(i,"opacity")&&"none"!==t(i,"display")&&"hidden"!==t(i,"visibility")&&(void 0!==n&&void 0!==r&&void 0!==o&&void 0!==s&&void 0!==a&&void 0!==l||(n=i.offsetTop,s=i.offsetLeft,o=n+i.offsetHeight,r=s+i.offsetWidth,a=i.offsetWidth,l=i.offsetHeight),!c||("hidden"!==t(c,"overflow")&&"scroll"!==t(c,"overflow")||!(s+2>c.offsetWidth+c.scrollLeft||s+a-2<c.scrollLeft||n+2>c.offsetHeight+c.scrollTop||n+l-2<c.scrollTop))&&(i.offsetParent===c&&(s+=c.offsetLeft,n+=c.offsetTop),e(c,n,r,o,s,a,l))))}(e)},getOffset:function(e,t){if(e&&Array.isArray(e)&&e[0]&&(e=e[0]),e){if(1===t)return(0,o.default)(e).offset();var i=e,n=e,r=0,s=0;if(document.getElementById||document.all)do{for(s+=e.offsetLeft-e.scrollLeft,r+=e.offsetTop-e.scrollTop,e=e.offsetParent,n=a.getParentNode(n);n&&n!=e;)s-=n.scrollLeft,r-=n.scrollTop,n=a.getParentNode(n)}while(e&&e.offsetParent);else document.layers&&(r+=e.y,s+=e.x);return{top:r,left:(0,o.default)(i).offset().left||s}}},flatten:function(e){var t={};for(var i in e)t[i]=e[i];return t},cssObjToString:function(e){var t=!!document.documentMode,i=!t&&!!window.StyleMedia,n=window.navigator.userAgent.indexOf("Firefox")>-1;return(t||i||n)&&(e=this.flatten(e)),JSON.stringify(e)},isModel:function(e,t,i){return i?i.model.get(e)===t:this.model.get(e)===t},generateGuid:function(e,t){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=[],r=0;for(t=t||i.length,e=e||22,r=0;r<e;r++)n[r]=i[0|Math.random()*t];return n.join("")},isObserverSupported:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=window[e],n=void 0!==i,r=!1;n&&(r=-1!==i.toString().indexOf("[native code]"));var o=r||t&&n;return o},isHeightValid:function(e){var t=!0;return e||(t=!1),t},isWidthValid:function(e){var t=!0;return e||(t=!1),t},setTrcObserver:function(e){s(TRC.intersections)&&TRC.intersections.observe&&TRC.intersections.observe(e)},dispatchTRC:function(e){window.TRC&&window.TRC.dispatch&&(window.TRC.dispatch(e),cmTag.logger&&cmTag.logger.info&&cmTag.logger.info("dispatched TRC event: ".concat(e)))},dispatchTRCWithPayload:function(e,t){window.TRC&&window.TRC.dispatch&&(window.TRC.dispatch(e,t),cmTag.logger&&cmTag.logger.info&&cmTag.logger.info("dispatched TRC event: ".concat(e)))},getOffsetWithContainer:function(e,t,i){if(!i)return this.getOffset(e,t);var n=this.getOffset(e,t),r=this.getOffset((0,o.default)(i));return{top:n.top-r.top,left:n.left-r.left}},getIframeDocument:function(e){try{if(e.tagName&&"iframe"==e.tagName.toLowerCase())return e.contentWindow.console.error&&(e.contentWindow.console.error=function(){}),e.contentDocument}catch(e){return null}},DOMIterator:function(e,t,i,n){var r=this;try{var o=this.getIframeDocument(e)||e;if(!o)return;o.querySelectorAll(t).forEach((function(e){r.DOMIterator(e,t,i,n)})),i(o.querySelectorAll(n))}catch(e){}},isBrowserIE11:function(e){return-1!==e.name.indexOf("ie")&&11===e.version},forceElementRedrawWithBorderChange:function(e,t,i){if(this.isBrowserIE11(e)&&!i){var n=(0,o.default)(t);n&&n.css&&(n.css("border","1px solid transparent"),setTimeout(function(){n&&n.css&&n.css("border","none")}.bind(n)))}},hasPassedPixelFromSelector:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;if(e){var r=e.toString(),s=(0,o.default)(r),a=s;n&&(a=this.getValidSelectorElements(s));var l=a[0];if(t=(0,o.default)(t)[0],window.taboolaBridge){var c=taboolaBridge.data,d=c.boundingClientRect.top-c.rootBounds.bottom,u=d<i;return cmTag.logger.info("###hasPassedPixelsFromSelector"+u+" - "+d+"/"+i),u}var h=void 0!==t,p=h?t.clientHeight:window.innerHeight,f=h?p+t.scrollTop:p+window.pageYOffset,m=i,g=this.getTopOfEl(l),y=g-m;return y<=f}},getViewportHeight:function(e){return void 0!==(e=(0,o.default)(e)[0])?e.clientHeight:window.innerHeight},calcViewportPositionInApp:function(e){var t=window.taboolaBridge.data,i=t.boundingClientRect;return{top:i.y<0?0-i.y:0,left:0,right:i.width,bottom:i.y>t.rootBounds.height?0:Math.abs(i.y-t.rootBounds.height)}},getOrganicCard:function(){var e=TRCImpl.boxes||{};for(var t in e){var i=e[t]||{},n=i.isFeedCard,r=!1;if(i.itemsTypes&&i.itemsTypes["is-organic"]&&(r=i.itemsTypes["is-organic"]),r&&n&&i.boxes.length)return i.mode}},getRootElementFontSize:function(){return parseFloat(getComputedStyle(document.documentElement).fontSize)},convertRem:function(e){return e*this.getRootElementFontSize()},flattenArray:function(e,t){return l(e,t,!1)},offsetFromBottomOfViewPort:function(e){return e.getBoundingClientRect().top-(window.innerHeight||document.documentElement.clientHeight)},sendingEventToTaboolaBridge:function(e,t){window.taboolaBridge&&window.taboolaBridge.emit("videoEvent",{type:e,value:t})},recoReelPlayStateAnimation:function(e,t,i){var n=(0,o.default)('[data-progress-bar-index="'.concat(t,'"] .tbl-progress-runner'),e)[0],r=(0,o.default)(".videoCube_".concat(t+1,"_child .thumbBlock"),e)[0];n&&(n.style.webkitAnimationPlayState=i,n.style.animationPlayState=i),r&&(r.style.webkitAnimationPlayState=i,r.style.animationPlayState=i)},getRandomFromList:function(e){return!(e.length<1)&&e[Math.floor(Math.random()*e.length)]},isSendBeaconSupported:function(){return!(!navigator||!a.isFunction(navigator.sendBeacon))},getSubUnitType:function(e){var t=e.isSticky,i=e.isDetachBelow,n=e.isDetachAbove,o=e.isStartFromSlider,s=e.isDetachToSlider;return t||!o||s?t||o||!s?!t&&o&&s?r().SUB_UNIT_TYPE.SUPER_SLIDER:t&&i&&!n?r().SUB_UNIT_TYPE.STICKY_BELOW:t&&!i&&n?r().SUB_UNIT_TYPE.STICKY_ABOVE:t&&i&&n?r().SUB_UNIT_TYPE.STICKY_BELOW_ABOVE:void 0:r().SUB_UNIT_TYPE.DETACH_TO_SLIDER:r().SUB_UNIT_TYPE.START_FROM_SLIDER},isReadMoreOnPage:function(){return window.TRC&&void 0!==window.TRC.readMoreVisible},isMidArticleOnReadMorePage:function(e){return this.isReadMoreOnPage()&&e},isReadMoreObserverNeededOnPage:function(e,t){return e&&t&&window.TRC&&window.TRC.readMoreVisible&&a.isObserverSupported("IntersectionObserver")},trcPerformanceMeasurement:function(e,t,i){try{if(e&&a.isTRCPerformanceEnabled()){var n="".concat(t).concat(i);window.TRC.performance.mark(n,null,"","",t,window.TRC.PerfEvenType[i.toUpperCase()])}}catch(e){}},isTRCPerformanceEnabled:function(){return window.TRC&&window.TRC.performance&&window.TRC.performance.mark},copyCSSFromPlaceholder:function(e,t,i){if(e&&t&&i&&0!==i.length){var n=window.getComputedStyle(t),r={};a.forEach(i,(function(e){r[e]=n[e]})),e.css(r)}},getDeltaBetweenRects:function(e,t){if(!e)return t||{};if(!t)return e||{};var i={};for(var n in e)if(void 0!==t[n]){var r=e[n]-t[n];r&&(i[n]=r)}return i},buildObserverThresholdList:function(){for(var e=[],t=1;t<=20;t++){var i=t/20;e.push(i)}return e.push(0),e}})},9288:function(e,t,i){"use strict";var n,r,o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}(o=this)||(o={}),o.Backbone||(o.Backbone={}),n=[i(1999),i(9057),t],r=function(e,t,i){o.Backbone=function(e,t,i,n){var r=e.Backbone,o=[],a=(o.push,o.slice);o.splice,t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=t.Events={on:function(e,t,i){return d(this,"on",e,[t,i])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this}),this):this},once:function(e,t,n){if(!d(this,"once",e,[t,n])||!t)return this;var r=this,o=i.once((function(){r.off(e,o),t.apply(this,arguments)}));return o._callback=t,this.on(e,o,n)},off:function(e,t,n){var r,o,s,a,l,c,u,h;if(!this._events||!d(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(l=0,c=(a=e?[e]:i.keys(this._events)).length;l<c;l++)if(e=a[l],s=this._events[e]){if(this._events[e]=r=[],t||n)for(u=0,h=s.length;u<h;u++)o=s[u],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!d(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&u(i,t),n&&u(n,arguments),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var o=!t&&!n;for(var a in n||"object"!==s(t)||(n=this),e&&((r={})[e._listenId]=e),r)(e=r[a]).off(t,n,this),(o||i.isEmpty(e._events))&&delete this._listeningTo[a];return this}},c=/\s+/,d=function(e,t,i,n){if(!i)return!0;if("object"===s(i)){for(var r in i)e[t].apply(e,[r,i[r]].concat(n));return!1}if(c.test(i)){for(var o=i.split(c),a=0,l=o.length;a<l;a++)e[t].apply(e,[o[a]].concat(n));return!1}return!0},u=function(e,t){var i,n=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<r;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=e[n]).callback.apply(i.ctx,t);return}},h={listenTo:"on",listenToOnce:"once"};i.each(h,(function(e,t){l[t]=function(t,n,r){return(this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=i.uniqueId("l"))]=t,r||"object"!==s(n)||(r=this),t[e](n,r,this),this}})),l.bind=l.on,l.unbind=l.off,i.extend(t,l);var p=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,o,a,l,c,d,u,h;if(null==e)return this;if("object"===s(e)?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;for(r in a=n.unset,c=n.silent,l=[],d=this._changing,this._changing=!0,d||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)t=o[r],i.isEqual(h[r],t)||l.push(r),i.isEqual(u[r],t)?delete this.changed[r]:this.changed[r]=t,a?delete h[r]:h[r]=t;if(!c){l.length&&(this._pending=n);for(var p=0,f=l.length;p<f;p++)this.trigger("change:"+l[p],this,h[l[p]],n)}if(d)return this;if(!c)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in e)i.isEqual(r[o],t=e[o])||((n||(n={}))[o]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?i.clone(e):{}).parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){if(!t.set(t.parse(i,e),e))return!1;n&&n(t,i,e),t.trigger("sync",t,i,e)},N(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,o,a,l=this.attributes;if(null==e||"object"===s(e)?(r=e,n=t):(r={})[e]=t,n=i.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=i.extend({},l,r)),void 0===n.parse&&(n.parse=!0);var c=this,d=n.success;return n.success=function(e){c.attributes=l;var t=c.parse(e,n);if(n.wait&&(t=i.extend(r||{},t)),i.isObject(t)&&!c.set(t,n))return!1;d&&d(c,e,n),c.trigger("sync",c,e,n)},N(this,n),"patch"==(o=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=r),a=this.sync(o,this,n),r&&n.wait&&(this.attributes=l),a},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;N(this,e);var o=this.sync("delete",this,e);return e.wait||r(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||M();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}});var f=["keys","values","pairs","invert","pick","omit"];i.each(f,(function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}}));var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};i.extend(m.prototype,l,{model:p,initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,y))},remove:function(e,t){var n,r,o,s,a=!i.isArray(e);for(t||(t={}),n=0,r=(e=a?[e]:i.clone(e)).length;n<r;n++)(s=e[n]=this.get(e[n]))&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,t.silent||(t.index=o,s.trigger("remove",s,this,t)),this._removeReference(s,t));return a?e[0]:e},set:function(e,t){(t=i.defaults({},t,g)).parse&&(e=this.parse(e,t));var n,r,o,s,a,l,c,d=!i.isArray(e);e=d?e?[e]:[]:i.clone(e);var u=t.at,h=this.model,f=this.comparator&&null==u&&!1!==t.sort,m=i.isString(this.comparator)?this.comparator:null,y=[],v=[],b={},_=t.add,w=t.merge,T=t.remove,P=!(f||!_||!T)&&[];for(n=0,r=e.length;n<r;n++){if(o=(a=e[n]||{})instanceof p?s=a:a[h.prototype.idAttribute||"id"],l=this.get(o))T&&(b[l.cid]=!0),w&&(a=a===s?s.attributes:a,t.parse&&(a=l.parse(a,t)),l.set(a,t),f&&!c&&l.hasChanged(m)&&(c=!0)),e[n]=l;else if(_){if(!(s=e[n]=this._prepareModel(a,t)))continue;y.push(s),this._addReference(s,t)}s=l||s,!P||!s.isNew()&&b[s.id]||P.push(s),b[s.id]=!0}if(T){for(n=0,r=this.length;n<r;++n)b[(s=this.models[n]).cid]||v.push(s);v.length&&this.remove(v,t)}if(y.length||P&&P.length)if(f&&(c=!0),this.length+=y.length,null!=u)for(n=0,r=y.length;n<r;n++)this.models.splice(u+n,0,y[n]);else{P&&(this.models.length=0);var S=P||y;for(n=0,r=S.length;n<r;n++)this.models.push(S[n])}if(c&&this.sort({silent:!0}),!t.silent){for(n=0,r=y.length;n<r;n++)(s=y[n]).trigger("add",s,this,t);(c||P&&P.length)&&this.trigger("sort",this,t)}return d?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return a.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"]((function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0}))},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){void 0===(e=e?i.clone(e):{}).parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var r=e.reset?"reset":"set";n[r](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e;(t=t?i.clone(t):{}).collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(v,(function(e){m.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}}));var b=["groupBy","countBy","sortBy","indexBy"];i.each(b,(function(e){m.prototype[e]=function(t,n){var r=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,r,n)}}));var _=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,T)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;for(var t in this.undelegateEvents(),e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var r=t.match(w),o=r[1],s=r[2];n=i.bind(n,this),o+=".delegateEvents"+this.cid,""===s?this.$el.on(o,n):this.$el.on(o,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,r){var o=S[e];i.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=i.result(n,"url")||M()),null!=r.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"===s.type&&P&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=t.ajax(i.extend(s,r));return n.trigger("request",n,l,r),l};var P=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),S={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var A=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,k=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(A.prototype,l,{initialize:function(){},route:function(e,n,r){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return t.history.route(e,(function(i){var s=o._extractParameters(e,i);o.execute(r,s),o.trigger.apply(o,["route:"+n].concat(s)),o.trigger("route",n,s),t.history.trigger("route",o,n,s)})),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(E,"(?:$1)?").replace(C,(function(e,t){return t?e:"([^/?]+)"})).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,(function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))}});var D=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,R=/^\/+|\/+$/g,x=/msie [\w.]+/,B=/\/$/,V=/#.*$/;D.started=!1,i.extend(D.prototype,l,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(B,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(I,"")},start:function(e){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,o=x.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);if(this.root=("/"+this.root+"/").replace(R,"/"),o&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(I,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),D.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!D.started)return!1;t&&!0!==t||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(V,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new D;var F=function(e,t){var n,r=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,t);var o=function(){this.constructor=n};return o.prototype=r.prototype,n.prototype=new o,e&&i.extend(n.prototype,e),n.__super__=r.prototype,n};p.extend=m.extend=A.extend=_.extend=D.extend=F;var M=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}(o,i,e,t)}.apply(t,n),void 0===r||(e.exports=r)},2782:function(e,t,i){var n,r,o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var a=i(1999),l=i(9288);(function(){var e,t,i,n,r,o,s,c=[].slice;i=function(e){var t,n;return!a.isObject(e)||a.isFunction(e)||e instanceof l.Collection||e instanceof l.Model?e:a.isDate(e)?new Date(e.getTime()):a.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):e instanceof HTMLElement||e.nodeType&&1===e.nodeType?e:e instanceof CSSStyleDeclaration?JSON.stringify(s(e)):(n=a.isArray(e||a.isArguments(e)),t=function(e,t,r){return n?e.push(i(t)):e[r]=i(t),e},a.reduce(e,t,n?[]:{}))},s=function(e){var t=!!document.documentMode,i=!t&&!!window.StyleMedia;if(!t&&!i)return e;var n={};for(var r in e)n[r]=e[r];return n},o=function(e){return null!=e&&((e.prototype==={}.prototype||e.prototype===Object.prototype)&&a.isObject(e)&&!a.isArray(e)&&!a.isFunction(e)&&!a.isDate(e)&&!a.isRegExp(e)&&!a.isArguments(e))},t=function(e){return a.filter(a.keys(e),(function(t){return o(e[t])}))},e=function(e){return a.filter(a.keys(e),(function(t){return a.isArray(e[t])}))},r=function(i,n,o){var s,l,c,d,u,h,p,f;if(null==o&&(o=20),o<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),a.extend(i,n);for(l=function(e){return n[e]=r(i[e],n[e],o-1)},u=0,p=(d=a.intersection(t(i),t(n))).length;u<p;u++)l(d[u]);for(s=function(e){return n[e]=a.union(i[e],n[e])},h=0,f=(c=a.intersection(e(i),e(n))).length;h<f;h++)s(c[h]);return a.extend(i,n)},n=function(){var e,t,n,o;if(n=2<=arguments.length?c.call(arguments,0,o=arguments.length-1):(o=0,[]),t=arguments[o++],a.isNumber(t)||(n.push(t),t=20),n.length<=1)return n[0];if(t<=0)return a.extend.apply(this,n);for(e=n.shift();n.length>0;)e=r(e,i(n.shift()),t);return e},a.mixin({deepClone:i,isBasicObject:o,basicObjects:t,arrays:e,deepExtend:n})}).call(this),r=[i(1999),i(9288)],n=function(t,i){function n(e){var i={},r=d.keyPathSeparator;for(var o in e){var s=e[o];if(s&&s.constructor===Object&&!t.isEmpty(s)){var a=n(s);for(var l in a){var c=a[l];i[o+r+l]=c}}else i[o]=s}return i}function r(e,i,n){for(var r=d.keyPathSeparator,o=i.split(r),s=e,a=0,l=o.length;a<l;a++){if(n&&!t.has(s,o[a]))return!1;if(null==(s=s[o[a]])&&a<l-1&&(s={}),void 0===s)return!!n||s}return!!n||s}function o(e,i,n,r){r=r||{};for(var o=d.keyPathSeparator,s=i.split(o),a=e,l=0,c=s.length;l<c&&void 0!==a;l++){var u=s[l];l===c-1?r.unset?delete a[u]:a[u]=n:(void 0!==a[u]&&t.isObject(a[u])||(a[u]={}),a=a[u])}}function a(e){var i={};return"object"!==s(e)?e:(t.each(e,(function(e,t,n){i[t]=l(e)})),i)}function l(e){if(e&&"["===e[0]&&"]"===e[e.length-1]){var i;try{i=JSON.parse(e)}catch(t){i=e}e=i}if(t.isArray(e)){var n=[];return t.each(e,(function(e){n.push(l(e))})),n}return"object"!==s(e)||t.isElement(e)?"true"===e||!0===e||"false"!==e&&!1!==e&&(""===e||isNaN(e)?e:Number(e)):a(e)}function c(e,t){o(e,t,null,{unset:!0})}var d=i.Model.extend({constructor:function(e,i){var n,r=e||{};this.cid=t.uniqueId("c"),this.attributes={},i&&i.collection&&(this.collection=i.collection),i&&i.parse&&(r=this.parse(r,i)||{}),(n=t.result(this,"defaults"))&&(r=t.deepExtend({},n,r)),this.set(r,i),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(e){return t.deepClone(this.attributes)},get:function(e){return r(this.attributes,e)},set:function(e,i,l){var u,h,p,f,m,g,y,v;if(null==e)return this;if("object"===s(e)?(h=e,l=i||{}):(h={})[e]=i,h=a(h),l||(l={}),!this._validate(h,l))return!1;for(u in p=l.unset,m=l.silent,f=[],g=this._changing,this._changing=!0,g||(this._previousAttributes=t.deepClone(this.attributes),this.changed={}),v=this.attributes,y=this._previousAttributes,this.idAttribute in h&&(this.id=h[this.idAttribute]),h=n(h))i=h[u],t.isEqual(r(v,u),i)||f.push(u),t.isEqual(r(y,u),i)?c(this.changed,u):o(this.changed,u,i),p?c(v,u):o(v,u,i);if(!m){f.length&&(this._pending=!0);for(var b=d.keyPathSeparator,_=0,w=f.length;_<w;_++){e=f[_],this.trigger("change:"+e,this,r(v,e),l);for(var T=e.split(b),P=T.length-1;P>0;P--){var S=t.first(T,P).join(b),A=S+b+"*";this.trigger("change:"+A,this,r(v,S),l),this.trigger("change:"+S,this,r(v,e),l)}}}if(g)return this;if(!m)for(;this._pending;)this._pending=!1,this.trigger("change",this,l);return this._pending=!1,this._changing=!1,this},clear:function(e){var i={},r=n(this.attributes);for(var o in r)i[o]=void 0;return this.set(i,t.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!t.isEmpty(this.changed):void 0!==r(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n(this.changed);var i=this._changing?this._previousAttributes:this.attributes;e=n(e),i=n(i);var r,o=!1;for(var s in e)t.isEqual(i[s],r=e[s])||((o||(o={}))[s]=r);return o},previous:function(e){return null!=e&&this._previousAttributes?r(this._previousAttributes,e):null},previousAttributes:function(){return t.deepClone(this._previousAttributes)}});return d.keyPathSeparator=".",i.DeepModel=d,e.exports=d,i},void 0===(o="function"==typeof n?n.apply(t,r):n)||(e.exports=o)},2447:function(e,t,i){"use strict";i.d(t,{O:function(){return o},s:function(){return m}});var n=i(1231);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i(1999);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,o;return t=e,(i=[{key:"createStateHandlers",value:function(e){(0,n.L)(this,e)}}])&&r(t.prototype,i),o&&r(t,o),e}(),s=i(9288),a=i.n(s);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=p(e);if(t){var r=p(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var f=i(1999),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(s,e);var t,i,r,o=u(s);function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,e)}return t=s,(i=[{key:"renderTemplate",value:function(){if(this.template&&this.model&&(this.template=f.template(this.template),this.$el.append(this.template(this.model.attributes)),this.ui)){var e={};for(var t in this.ui)e[t]=this.$el.find(this.ui[t]);this.ui=e}}},{key:"createStateHandlers",value:function(e){(0,n.L)(this,e)}}])&&c(t.prototype,i),r&&c(t,r),s}(a().View)},1231:function(e,t,i){"use strict";function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i.d(t,{L:function(){return s}});var o=i(1999),s=function(e,t){if(e.model&&o.isArray(t)){var i=function(e){var t,i=e.self,r=e.funcName,s=e.withBind,a=e.args;o.isString(r)&&o.isFunction(i[r])&&(s?(t=i[r]).bind.apply(t,[i].concat(n(a)))():i[r].apply(i,n(a)))};o.each(t,function(t){var n=t.event,r=t.funcName,s=t.isListenOnce,a=void 0!==s&&s,l=t.withBind,c=void 0===l||l;if(o.isArray(n)&&function(t){var n=t.event,r=t.funcName,s=t.isListenOnce,a=t.withBind,l=s?"listenToOnce":"listenTo",c=!0,d=!1,u=[];o.forEach(n,function(e){var t=e.split(":")[0],i=e.split(":")[1];u.push({eventName:t,stateName:i})}.bind(e));var h=function(t){if(!s||!d){var n=!0;o.forEach(u,(function(t){(void 0!==e.model.get(t.eventName)?e.model.get(t.eventName).toString():void 0)!==t.stateName&&(n=!1)})),n&&c?(c=!1,d=!0,i({self:e,funcName:r,withBind:a,args:arguments})):n||t()}};o.forEach(n,function(t){!function(e){var t=e.self,i=e.event,n=e.func,r=e.listen,o=e.isListenOnce,s=e.onEventNotEqual,a=i.split(":")[0],l=i.split(":")[1],c=function(){var e=function(){};o&&(e=function(){t.model.listenToOnce(t.model,"change:".concat(a),c)}),t.model.get(a).toString()===l?n.call(t,e):o?(s(),e()):s()}.bind(t);t.model[r](t.model,"change:".concat(a),c)}({self:e,func:h,event:t,withBind:a,listen:l,isListenOnce:s,onEventNotEqual:function(){c=!0}.bind(e)})}.bind(e))}({event:n,funcName:r,isListenOnce:a,withBind:c}),o.isString(n)&&o.isString(r)){var d=a?"listenToOnce":"listenTo";n.match(":")?function(e){var t=e.self,n=e.funcName,r=e.event,o=e.withBind,s=e.listen,a=e.isListenOnce,l=r.split(":")[0],c=r.split(":")[1],d=function(){t.model.get(l).toString()==c?i({self:t,funcName:n,withBind:o,args:arguments}):a&&t.model.listenToOnce(t.model,"change:".concat(l),d)}.bind(t);t.model[s](t.model,"change:".concat(l),d)}({self:e,funcName:r,event:n,withBind:c,listen:d,isListenOnce:a}):e.model[d](e.model,"change:".concat(n),function(){i({self:e,funcName:r,withBind:c,args:arguments})}.bind(e))}}.bind(e))}}},9057:function(e,t,i){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}i.r(t);var r=function(){Array.prototype.forEach=function(e){for(var t=0;t<this.length;t++)e(this[t],t,this)};var e=function(){var e,t,i,r,o,s,a=[],l=a.slice,c=a.filter,d=window.document,u={},h={},p={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},f=/^\s*<(\w+|!)[^>]*>/,m=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,g=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,y=/^(?:body|html)$/i,v=/([A-Z])/g,b=["val","css","html","text","data","width","height","offset"],_=d.createElement("table"),w=d.createElement("tr"),T={tr:d.createElement("tbody"),tbody:_,thead:_,tfoot:_,td:w,th:w,"*":d.createElement("div")},P=/complete|loaded|interactive/,S=/^[\w-]*$/,A={},E=A.toString,C={},k=d.createElement("div"),O={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},D=Array.isArray||function(e){return e instanceof Array};function I(e){return null==e?String(e):A[E.call(e)]||"object"}function R(e){return"function"==I(e)}function x(e){return null!=e&&e==e.window}function B(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function V(e){return"object"==I(e)}function F(e){return V(e)&&!x(e)&&Object.getPrototypeOf(e)==Object.prototype}function M(e){return"number"==typeof e.length}function N(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function L(e){return e in h?h[e]:h[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function j(e,t){return"number"!=typeof t||p[N(e)]?t:t+"px"}function U(e){return"children"in e?l.call(e.children):i.map(e.childNodes,(function(e){if(1==e.nodeType)return e}))}function W(i,n,r){for(t in n)r&&(F(n[t])||D(n[t]))?(F(n[t])&&!F(i[t])&&(i[t]={}),D(n[t])&&!D(i[t])&&(i[t]=[]),W(i[t],n[t],r)):n[t]!==e&&(i[t]=n[t])}function H(e,t){return null==t?i(e):i(e).filter(t)}function q(e,t,i,n){return R(t)?t.call(e,i,n):t}function G(e,t,i){try{null==i?e.removeAttribute(t):e.setAttribute(t,i)}catch(e){}}function $(t,i){var n=t.className||"",r=n&&n.baseVal!==e;if(i===e)return r?n.baseVal:n;r?n.baseVal=i:t.className=i}function z(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?i.parseJSON(e):e):e}catch(t){return e}}function K(e,t){t(e);for(var i=0,n=e.childNodes.length;i<n;i++)K(e.childNodes[i],t)}return C.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var i=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var n,r=e.parentNode,o=!r;return o&&(r=k).appendChild(e),n=~C.qsa(r,t).indexOf(e),o&&k.removeChild(e),n},o=function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},s=function(e){return c.call(e,(function(t,i){return e.indexOf(t)==i}))},C.fragment=function(t,n,r){var o,s,a;return m.test(t)&&(o=i(d.createElement(RegExp.$1))),o||(t.replace&&(t=t.replace(g,"<$1></$2>")),n===e&&(n=f.test(t)&&RegExp.$1),n in T||(n="*"),(a=T[n]).innerHTML=""+t,o=i.each(l.call(a.childNodes),(function(){a.removeChild(this)}))),F(r)&&(s=i(o),i.each(r,(function(e,t){b.indexOf(e)>-1?s[e](t):s.attr(e,t)}))),o},C.Z=function(e,t){return(e=e||[]).__proto__=i.fn,e.selector=t||"",e},C.isZ=function(e){return e instanceof C.Z},C.init=function(t,n){var r,o;if(!t)return C.Z();if("string"==typeof t)if("<"==(t=t.trim())[0]&&f.test(t))r=C.fragment(t,RegExp.$1,n),t=null;else{if(n!==e)return i(n).find(t);r=C.qsa(d,t)}else{if(R(t))return i(d).ready(t);if(C.isZ(t))return t;if(D(t))o=t,r=c.call(o,(function(e){return null!=e}));else if(V(t))r=[t],t=null;else if(f.test(t))r=C.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==e)return i(n).find(t);r=C.qsa(d,t)}}return C.Z(r,t)},(i=function(e,t){return C.init(e,t)}).extend=function(e){try{window.TRC&&window.TRC.performance&&window.TRC.performance.mark&&window.TRC.PerfEvenType&&window.TRC.performance.mark("videoExtendFuncStart",null,"","","videoExtendFunc",window.TRC.PerfEvenType.START)}catch(e){}var t,i=l.call(arguments,1);"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach((function(i){W(e,i,t)}));try{window.TRC&&window.TRC.performance&&window.TRC.performance.mark&&window.TRC.PerfEvenType&&window.TRC.performance.mark("videoExtendFuncStop",null,"","","videoExtendFunc",window.TRC.PerfEvenType.STOP)}catch(e){}return e},C.qsa=function(e,t){var i,n="#"==t[0],r=!n&&"."==t[0],o=n||r?t.slice(1):t,s=S.test(o);return B(e)&&s&&n?(i=e.getElementById(o))?[i]:[]:1!==e.nodeType&&9!==e.nodeType?[]:l.call(s&&!n?r?e.getElementsByClassName(o):e.getElementsByTagName(t):e.querySelectorAll(t))},i.contains=d.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},i.type=I,i.isFunction=R,i.isWindow=x,i.isArray=D,i.isPlainObject=F,i.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},i.inArray=function(e,t,i){return a.indexOf.call(t,e,i)},i.camelCase=o,i.trim=function(e){return null==e?"":String.prototype.trim.call(e)},i.uuid=0,i.support={},i.expr={},i.map=function(e,t){var n,r,o,s,a=[];if(M(e))for(r=0;r<e.length;r++)null!=(n=t(e[r],r))&&a.push(n);else for(o in e)null!=(n=t(e[o],o))&&a.push(n);return(s=a).length>0?i.fn.concat.apply([],s):s},i.each=function(e,t){var i,n;if(M(e)){for(i=0;i<e.length;i++)if(!1===t.call(e[i],i,e[i]))return e}else for(n in e)if(!1===t.call(e[n],n,e[n]))return e;return e},i.grep=function(e,t){return c.call(e,t)},window.JSON&&(i.parseJSON=JSON.parse),i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(e,t){A["[object "+t+"]"]=t.toLowerCase()})),i.fn={forEach:a.forEach,reduce:a.reduce,push:a.push,sort:a.sort,indexOf:a.indexOf,concat:a.concat,map:function(e){return i(i.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return i(l.apply(this,arguments))},ready:function(e){return P.test(d.readyState)&&d.body?e(i):d.addEventListener("DOMContentLoaded",(function(){e(i)}),!1),this},get:function(t){return t===e?l.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each((function(){null!=this.parentNode&&this.parentNode.removeChild(this)}))},each:function(e){return a.every.call(this,(function(t,i){return!1!==e.call(t,i,t)})),this},filter:function(e){return R(e)?this.not(this.not(e)):i(c.call(this,(function(t){return C.matches(t,e)})))},add:function(e,t){return i(s(this.concat(i(e,t))))},is:function(e){return this.length>0&&C.matches(this[0],e)},not:function(t){var n=[];if(R(t)&&t.call!==e)this.each((function(e){t.call(this,e)||n.push(this)}));else{var r="string"==typeof t?this.filter(t):M(t)&&R(t.item)?l.call(t):i(t);this.forEach((function(e){r.indexOf(e)<0&&n.push(e)}))}return i(n)},has:function(e){return this.filter((function(){return V(e)?i.contains(this,e):i(this).find(e).size()}))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!V(e)?e:i(e)},last:function(){var e=this[this.length-1];return e&&!V(e)?e:i(e)},find:function(e){var t=this;return e?"object"==n(e)?i(e).filter((function(){var e=this;return a.some.call(t,(function(t){return i.contains(t,e)}))})):1==this.length?i(C.qsa(this[0],e)):this.map((function(){return C.qsa(this,e)})):i()},closest:function(e,t){var r=this[0],o=!1;for("object"==n(e)&&(o=i(e));r&&!(o?o.indexOf(r)>=0:C.matches(r,e));)r=r!==t&&!B(r)&&r.parentNode;return i(r)},parents:function(e){for(var t=[],n=this;n.length>0;)n=i.map(n,(function(e){if((e=e.parentNode)&&!B(e)&&t.indexOf(e)<0)return t.push(e),e}));return H(t,e)},parent:function(e){return H(s(this.pluck("parentNode")),e)},children:function(e){return H(this.map((function(){return U(this)})),e)},contents:function(){return this.map((function(){return l.call(this.childNodes)}))},siblings:function(e){return H(this.map((function(e,t){return c.call(U(t.parentNode),(function(e){return e!==t}))})),e)},empty:function(){return this.each((function(){this.innerHTML=""}))},pluck:function(e){return i.map(this,(function(t){return t[e]}))},show:function(){return this.each((function(){var e,t,i;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,u[e]||(t=d.createElement(e),d.body.appendChild(t),i=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),u[e]=i),u[e]))}))},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=R(e);if(this[0]&&!t)var n=i(e).get(0),r=n.parentNode||this.length>1;return this.each((function(o){i(this).wrapAll(t?e.call(this,o):r?n.cloneNode(!0):n)}))},wrapAll:function(e){if(this[0]){var t;for(i(this[0]).before(e=i(e));(t=e.children()).length;)e=t.first();i(e).append(this)}return this},wrapInner:function(e){var t=R(e);return this.each((function(n){var r=i(this),o=r.contents(),s=t?e.call(this,n):e;o.length?o.wrapAll(s):r.append(s)}))},unwrap:function(){return this.parent().each((function(){i(this).replaceWith(i(this).children())})),this},clone:function(){return this.map((function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(t){return this.each((function(){var n=i(this);(t===e?"none"==n.css("display"):t)?n.show():n.hide()}))},prev:function(e){return i(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return i(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each((function(t){var n=this.innerHTML;i(this).empty().append(q(this,e,t,n))})):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each((function(t){var i=q(this,e,t,this.textContent);this.textContent=null==i?"":""+i})):0 in this?this[0].textContent:null},attr:function(i,n){var r;return"string"!=typeof i||1 in arguments?this.each((function(e){if(1===this.nodeType)if(V(i))for(t in i)G(this,t,i[t]);else G(this,i,q(this,n,e,this.getAttribute(i)))})):this.length&&1===this[0].nodeType?!(r=this[0].getAttribute(i))&&i in this[0]?this[0][i]:r:e},removeAttr:function(e){return this.each((function(){1===this.nodeType&&e.split(" ").forEach((function(e){G(this,e)}),this)}))},prop:function(e,t){return e=O[e]||e,1 in arguments?this.each((function(i){this[e]=q(this,t,i,this[e])})):this[0]&&this[0][e]},data:function(t,i){var n="data-"+t.replace(v,"-$1").toLowerCase(),r=1 in arguments?this.attr(n,i):this.attr(n);return null!==r?z(r):e},val:function(e){return 0 in arguments?this.each((function(t){this.value=q(this,e,t,this.value)})):this[0]&&(this[0].multiple?i(this[0]).find("option").filter((function(){return this.selected})).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each((function(t){var n=i(this),r=q(this,e,t,n.offset()),o=n.offsetParent().offset(),s={top:r.top-o.top,left:r.left-o.left};"static"==n.css("position")&&(s.position="relative"),n.css(s)}));if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(e,n){if(arguments.length<2){var r,s=this[0];if(!s)return;if(r=getComputedStyle(s,""),"string"==typeof e)return s.style[o(e)]||r.getPropertyValue(e);if(D(e)){var a={};return i.each(e,(function(e,t){a[t]=s.style[o(t)]||r.getPropertyValue(t)})),a}}var l="";if("string"==I(e))n||0===n?l=N(e)+":"+j(e,n):this.each((function(){this.style.removeProperty(N(e))}));else for(t in e)e[t]||0===e[t]?l+=N(t)+":"+j(t,e[t])+";":this.each((function(){this.style.removeProperty(N(t))}));return this.each((function(){this.style.cssText+=";"+l}))},index:function(e){return e?this.indexOf(i(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&a.some.call(this,(function(e){return this.test($(e))}),L(e))},addClass:function(e){return e?this.each((function(t){if("className"in this){r=[];var n=$(this);q(this,e,t,n).split(/\s+/g).forEach((function(e){i(this).hasClass(e)||r.push(e)}),this),r.length&&$(this,n+(n?" ":"")+r.join(" "))}})):this},removeClass:function(t){return this.each((function(i){if("className"in this){if(t===e)return $(this,"");r=$(this),q(this,t,i,r).split(/\s+/g).forEach((function(e){r=r.replace(L(e)," ")})),$(this,r.trim())}}))},toggleClass:function(t,n){return t?this.each((function(r){var o=i(this);q(this,t,r,$(this)).split(/\s+/g).forEach((function(t){(n===e?!o.hasClass(t):n)?o.addClass(t):o.removeClass(t)}))})):this},scrollTop:function(t){if(this.length){var i="scrollTop"in this[0];return t===e?i?this[0].scrollTop:this[0].pageYOffset:this.each(i?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var i="scrollLeft"in this[0];return t===e?i?this[0].scrollLeft:this[0].pageXOffset:this.each(i?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),r=y.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(i(e).css("margin-top"))||0,n.left-=parseFloat(i(e).css("margin-left"))||0,r.top+=parseFloat(i(t[0]).css("border-top-width"))||0,r.left+=parseFloat(i(t[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent||d.body;e&&!y.test(e.nodeName)&&"static"==i(e).css("position");)e=e.offsetParent;return e}))}},i.fn.detach=i.fn.remove,["width","height"].forEach((function(t){var n=t.replace(/./,(function(e){return e[0].toUpperCase()}));i.fn[t]=function(r){var o,s=this[0];return r===e?x(s)?s["inner"+n]:B(s)?s.documentElement["scroll"+n]:(o=this.offset())&&o[t]:this.each((function(e){(s=i(this)).css(t,q(this,r,e,s[t]()))}))}})),["after","prepend","before","append"].forEach((function(e,t){var n=t%2;i.fn[e]=function(){var e,r,o=i.map(arguments,(function(t){return"object"==(e=I(t))||"array"==e||null==t?t:C.fragment(t)})),s=this.length>1;return o.length<1?this:this.each((function(e,a){r=n?a:a.parentNode,a=0==t?a.nextSibling:1==t?a.firstChild:2==t?a:null;var l=i.contains(d.documentElement,r);o.forEach((function(e){if(s)e=e.cloneNode(!0);else if(!r)return i(e).remove();r.insertBefore(e,a),l&&K(e,(function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)}))}))}))},i.fn[n?e+"To":"insert"+(t?"Before":"After")]=function(t){return i(t)[e](this),this}})),C.Z.prototype=i.fn,C.uniq=s,C.deserializeValue=z,i.zepto=C,i}(),t=e;return function(e){var t,i=1,n=Array.prototype.slice,r=e.isFunction,o=function(e){return"string"==typeof e},s={},a={},l="onfocusin"in window,c={focus:"focusin",blur:"focusout"},d={mouseenter:"mouseover",mouseleave:"mouseout"};function u(e){return e._zid||(e._zid=i++)}function h(e,t,i,n){if((t=p(t)).ns)var r=(o=t.ns,new RegExp("(?:^| )"+o.replace(" "," .* ?")+"(?: |$)"));var o;return(s[u(e)]||[]).filter((function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||r.test(e.ns))&&(!i||u(e.fn)===u(i))&&(!n||e.sel==n)}))}function p(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function f(e,t){return e.del&&!l&&e.e in c||!!t}function m(e){return d[e]||l&&c[e]||e}function g(i,n,r,o,a,l,c){var h=u(i),g=s[h]||(s[h]=[]);n.split(/\s/).forEach((function(n){if("ready"==n)return e(document).ready(r);var s=p(n);s.fn=r,s.sel=a,s.e in d&&(r=function(t){var i=t.relatedTarget;if(!i||i!==this&&!e.contains(this,i))return s.fn.apply(this,arguments)}),s.del=l;var u=l||r;s.proxy=function(e){if(!(e=T(e)).isImmediatePropagationStopped()){e.data=o;var n=u.apply(i,e._args==t?[e]:[e].concat(e._args));return!1===n&&(e.preventDefault(),e.stopPropagation()),n}},s.i=g.length,g.push(s),"addEventListener"in i&&i.addEventListener(m(s.e),s.proxy,f(s,c))}))}function y(e,t,i,n,r){var o=u(e);(t||"").split(/\s/).forEach((function(t){h(e,t,i,n).forEach((function(t){delete s[o][t.i],"removeEventListener"in e&&e.removeEventListener(m(t.e),t.proxy,f(t,r))}))}))}a.click=a.mousedown=a.mouseup=a.mousemove="MouseEvents",e.event={add:g,remove:y},e.proxy=function(t,i){var s=2 in arguments&&n.call(arguments,2);if(r(t)){var a=function(){return t.apply(i,s?s.concat(n.call(arguments)):arguments)};return a._zid=u(t),a}if(o(i))return s?(s.unshift(t[i],t),e.proxy.apply(null,s)):e.proxy(t[i],t);throw new TypeError("expected function")},e.fn.bind=function(e,t,i){return this.on(e,t,i)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,i,n){return this.on(e,t,i,n,1)};var v=function(){return!0},b=function(){return!1},_=/^([A-Z]|returnValue$|layer[XY]$)/,w={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function T(i,n){return!n&&i.isDefaultPrevented||(n||(n=i),e.each(w,(function(e,t){var r=n[e];i[e]=function(){return this[t]=v,r&&r.apply(n,arguments)},i[t]=b})),(n.defaultPrevented!==t?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(i.isDefaultPrevented=v)),i}function P(e){var i,n={originalEvent:e};for(i in e)_.test(i)||e[i]===t||(n[i]=e[i]);return T(n,e)}e.fn.delegate=function(e,t,i){return this.on(t,e,i)},e.fn.undelegate=function(e,t,i){return this.off(t,e,i)},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.on=function(i,s,a,l,c){var d,u,h=this;return i&&!o(i)?(e.each(i,(function(e,t){h.on(e,s,a,t,c)})),h):(o(s)||r(l)||!1===l||(l=a,a=s,s=t),(r(a)||!1===a)&&(l=a,a=t),!1===l&&(l=b),h.each((function(t,r){c&&(d=function(e){return y(r,e.type,l),l.apply(this,arguments)}),s&&(u=function(t){var i,o=e(t.target).closest(s,r).get(0);if(o&&o!==r)return i=e.extend(P(t),{currentTarget:o,liveFired:r}),(d||l).apply(o,[i].concat(n.call(arguments,1)))}),g(r,i,l,a,s,u||d)})))},e.fn.off=function(i,n,s){var a=this;return i&&!o(i)?(e.each(i,(function(e,t){a.off(e,n,t)})),a):(o(n)||r(s)||!1===s||(s=n,n=t),!1===s&&(s=b),a.each((function(){y(this,i,s,n)})))},e.fn.trigger=function(t,i){return(t=o(t)||e.isPlainObject(t)?e.Event(t):T(t))._args=i,this.each((function(){t.type in c&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,i)}))},e.fn.triggerHandler=function(t,i){var n,r;return this.each((function(s,a){(n=P(o(t)?e.Event(t):t))._args=i,n.target=a,e.each(h(a,t.type||t),(function(e,t){if(r=t.proxy(n),n.isImmediatePropagationStopped())return!1}))})),r},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach((function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}})),e.Event=function(e,t){o(e)||(e=(t=e).type);var i=document.createEvent(a[e]||"Events"),n=!0;if(t)for(var r in t)"bubbles"==r?n=!!t[r]:i[r]=t[r];return i.initEvent(e,n,!0),T(i)}}(e),function(e){var t,i,n=0,r=window.document,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=/^(?:text|application)\/javascript/i,a=/^(?:text|application)\/xml/i,l="application/json",c="text/html",d=/^\s*$/,u=r.createElement("a");function h(t,i,n,o){if(t.global)return function(t,i,n){var r=e.Event(i);return e(t).trigger(r,n),!r.isDefaultPrevented()}(i||r,n,o)}function p(e,t){var i=t.context;if(!1===t.beforeSend.call(i,e,t)||!1===h(t,i,"ajaxBeforeSend",[e,t]))return!1;h(t,i,"ajaxSend",[e,t])}function f(e,t,i,n){var r=i.context,o="success";i.success.call(r,e,o,t),n&&n.resolveWith(r,[e,o,t]),h(i,r,"ajaxSuccess",[t,i,e]),g(o,t,i)}function m(e,t,i,n,r){var o=n.context;n.error.call(o,i,t,e),r&&r.rejectWith(o,[i,t,e]),h(n,o,"ajaxError",[i,n,e||t]),g(t,i,n)}function g(t,i,n){var r=n.context;n.complete.call(r,i,t),h(n,r,"ajaxComplete",[i,n]),function(t){t.global&&!--e.active&&h(t,null,"ajaxStop")}(n)}function y(){}function v(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function b(t,i,n,r){return e.isFunction(i)&&(r=n,n=i,i=void 0),e.isFunction(n)||(r=n,n=void 0),{url:t,data:i,success:n,dataType:r}}u.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,i){if(!("type"in t))return e.ajax(t);var o,s,a=t.jsonpCallback,l=(e.isFunction(a)?a():a)||"jsonp"+ ++n,c=r.createElement("script"),d=window[l],u=function(t){e(c).triggerHandler("error",t||"abort")},h={abort:u};return i&&i.promise(h),e(c).on("load error",(function(n,r){clearTimeout(s),e(c).off().remove(),"error"!=n.type&&o?f(o[0],h,t,i):m(null,r||"error",h,t,i),window[l]=d,o&&e.isFunction(d)&&d(o[0]),d=o=void 0})),!1===p(h,t)?(u("abort"),h):(window[l]=function(){o=arguments},c.src=t.url.replace(/\?(.+)=\?/,"?$1="+l),r.head.appendChild(c),t.timeout>0&&(s=setTimeout((function(){u("timeout")}),t.timeout)),h)},e.ajaxSettings={type:"GET",beforeSend:y,success:y,error:y,complete:y,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:l,xml:"application/xml, text/xml",html:c,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(n){var o,g=e.extend({},n||{}),b=e.Deferred&&e.Deferred();for(t in e.ajaxSettings)void 0===g[t]&&(g[t]=e.ajaxSettings[t]);!function(t){t.global&&0==e.active++&&h(t,null,"ajaxStart")}(g),g.crossDomain||((o=r.createElement("a")).href=g.url,o.href=o.href,g.crossDomain=u.protocol+"//"+u.host!=o.protocol+"//"+o.host),g.url||(g.url=window.location.toString()),function(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=v(t.url,t.data),t.data=void 0)}(g);var _=g.dataType,w=/\?.+=\?/.test(g.url);if(w&&(_="jsonp"),!1!==g.cache&&(n&&!0===n.cache||"script"!=_&&"jsonp"!=_)||(g.url=v(g.url,"_="+Date.now())),"jsonp"==_)return w||(g.url=v(g.url,g.jsonp?g.jsonp+"=?":!1===g.jsonp?"":"callback=?")),e.ajaxJSONP(g,b);var T,P=g.accepts[_],S={},A=function(e,t){S[e.toLowerCase()]=[e,t]},E=/^([\w-]+:)\/\//.test(g.url)?RegExp.$1:window.location.protocol,C=g.xhr(),k=C.setRequestHeader;if(b&&b.promise(C),g.crossDomain||A("X-Requested-With","XMLHttpRequest"),A("Accept",P||"*/*"),(P=g.mimeType||P)&&(P.indexOf(",")>-1&&(P=P.split(",",2)[0]),C.overrideMimeType&&C.overrideMimeType(P)),(g.contentType||!1!==g.contentType&&g.data&&"GET"!=g.type.toUpperCase())&&A("Content-Type",g.contentType||"application/x-www-form-urlencoded"),g.headers)for(i in g.headers)A(i,g.headers[i]);if(C.setRequestHeader=A,C.onreadystatechange=function(){if(4==C.readyState){C.onreadystatechange=y,clearTimeout(T);var t,i=!1;if(C.status>=200&&C.status<300||304==C.status||0==C.status&&"file:"==E){_=_||function(e){return e&&(e=e.split(";",2)[0]),e&&(e==c?"html":e==l?"json":s.test(e)?"script":a.test(e)&&"xml")||"text"}(g.mimeType||C.getResponseHeader("content-type")),t=C.responseText;try{"script"==_?(0,eval)(t):"xml"==_?t=C.responseXML:"json"==_&&(t=d.test(t)?null:e.parseJSON(t))}catch(e){i=e}i?m(i,"parsererror",C,g,b):f(t,C,g,b)}else m(C.statusText||null,C.status?"error":"abort",C,g,b)}},!1===p(C,g))return C.abort(),m(null,"abort",C,g,b),C;if(g.xhrFields)for(i in g.xhrFields)C[i]=g.xhrFields[i];var O=!("async"in g)||g.async;for(i in C.open(g.type,g.url,O,g.username,g.password),S)k.apply(C,S[i]);return g.timeout>0&&(T=setTimeout((function(){C.onreadystatechange=y,C.abort(),m(null,"timeout",C,g,b)}),g.timeout)),C.send(g.data?g.data:null),C},e.get=function(){return e.ajax(b.apply(null,arguments))},e.post=function(){var t=b.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=b.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,i,n){if(!this.length)return this;var r,s=this,a=t.split(/\s/),l=b(t,i,n),c=l.success;return a.length>1&&(l.url=a[0],r=a[1]),l.success=function(t){s.html(r?e("<div>").html(t.replace(o,"")).find(r):t),c&&c.apply(s,arguments)},e.ajax(l),this};var _=encodeURIComponent;function w(t,i,n,r){var o,s=e.isArray(i),a=e.isPlainObject(i);e.each(i,(function(i,l){o=e.type(l),r&&(i=n?r:r+"["+(a||"object"==o||"array"==o?i:"")+"]"),!r&&s?t.add(l.name,l.value):"array"==o||!n&&"object"==o?w(t,l,n,i):t.add(i,l)}))}e.param=function(t,i){var n=[];return n.add=function(t,i){e.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(_(t)+"="+_(i))},w(n,t,i),n.join("&").replace(/%20/g,"+")}}(e),function(e){e.fn.serializeArray=function(){var t,i,n=[],r=function e(i){if(i.forEach)return i.forEach(e);n.push({name:t,value:i})};return this[0]&&e.each(this[0].elements,(function(n,o){i=o.type,(t=o.name)&&"fieldset"!=o.nodeName.toLowerCase()&&!o.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||o.checked)&&r(e(o).val())})),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach((function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))})),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(e){"__proto__"in{}||e.extend(e.zepto,{Z:function(t,i){return t=t||[],e.extend(t,e.fn),t.selector=i||"",t.__Z=!0,t},isZ:function(t){return"array"===e.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e,i){try{return t(e,i)}catch(e){return null}}}}(e),t}();t.default=r},1740:function(e,t,i){var n=i(3389),r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},o=function(e,t,i,n){t=t||{},this.host=i,this.progressive=!1!==t.progressive,this.benchmark=!!t.benchmark,this.canvas=t.canvas||document.createElement("canvas"),this.autoplay=!!t.autoplay,this.wantsToPlay=this.autoplay,this.loop=!!t.loop,this.seekable=!!t.seekable,this.externalLoadCallback=t.onload||null,this.externalDecodeCallback=t.ondecodeframe||null,this.externalFinishedCallback=t.onfinished||null,this.centerVertically=t.centerVertically||null,this.canvasCss=t.canvasCss||{},this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.zeroBlockData=new Int32Array(64),this.fillArray(this.zeroBlockData,0),this.receiveStarted=!1,this.loadeReadyRate=t.loadeReadyRate,this.url=e,this.pcx=t.pcx,this.pcy=t.pcy,this.errHndlr=t.errHndlr||null,n&&!t.forceCanvas2D&&this.initWebGL()?this.renderFrame=this.renderFrameGL:(this.canvasContext=this.canvas.getContext("2d"),this.renderFrame=this.renderFrame2D),e instanceof WebSocket?(this.client=e,this.client.onopen=this.initSocketClient.bind(this)):this.load(e)};o.prototype.waitForIntraFrame=!0,o.prototype.socketBufferSize=524288,o.prototype.initSocketClient=function(){this.buffer=new V(new ArrayBuffer(this.socketBufferSize)),this.nextPictureBuffer=new V(new ArrayBuffer(this.socketBufferSize)),this.nextPictureBuffer.writePos=0,this.nextPictureBuffer.chunkBegin=0,this.nextPictureBuffer.lastWriteBeforeWrap=0,this.client.binaryType="arraybuffer",this.client.onmessage=this.receiveSocketMessage.bind(this)},o.prototype.decodeSocketHeader=function(e){e[0]===s.charCodeAt(0)&&e[1]===s.charCodeAt(1)&&e[2]===s.charCodeAt(2)&&e[3]===s.charCodeAt(3)&&(this.width=256*e[4]+e[5],this.height=256*e[6]+e[7],this.initBuffers())},o.prototype.receiveSocketMessage=function(e){var t=new Uint8Array(e.data);this.sequenceStarted||this.decodeSocketHeader(t);var i=this.buffer,n=this.nextPictureBuffer;n.writePos+t.length>n.length&&(n.lastWriteBeforeWrap=n.writePos,n.writePos=0,n.index=0),n.bytes.set(t,n.writePos),n.writePos+=t.length;for(var o=0;;){if((o=n.findNextMPEGStartCode())===V.NOT_FOUND||n.index>>3>n.writePos)return void(n.index=Math.max(n.writePos-3,0)<<3);if(o===k)break}if(this.waitForIntraFrame)return n.advance(10),void(n.getBits(3)===T&&(this.waitForIntraFrame=!1,n.chunkBegin=n.index-13>>3));this.currentPictureDecoded||this.decodePicture(a);var s=n.index>>3;if(s>n.chunkBegin)i.bytes.set(n.bytes.subarray(n.chunkBegin,s)),i.writePos=s-n.chunkBegin;else{i.bytes.set(n.bytes.subarray(n.chunkBegin,n.lastWriteBeforeWrap));var l=n.lastWriteBeforeWrap-n.chunkBegin;i.bytes.set(n.bytes.subarray(0,s),l),i.writePos=s+l}i.index=0,n.chunkBegin=s,this.currentPictureDecoded=!1,r(this.scheduleDecoding.bind(this),this.canvas)},o.prototype.scheduleDecoding=function(){this.decodePicture(),this.currentPictureDecoded=!0},o.prototype.isRecording=!1,o.prototype.recorderWaitForIntraFrame=!1,o.prototype.recordedFrames=0,o.prototype.recordedSize=0,o.prototype.didStartRecordingCallback=null,o.prototype.recordBuffers=[],o.prototype.canRecord=function(){return this.client&&this.client.readyState===this.client.OPEN},o.prototype.startRecording=function(e){if(this.canRecord()){this.discardRecordBuffers(),this.isRecording=!0,this.recorderWaitForIntraFrame=!0,this.didStartRecordingCallback=e||null,this.recordedFrames=0,this.recordedSize=0;var t=this.width>>4,i=(15&this.width)<<4|this.height>>8,n=255&this.height;this.recordBuffers.push(new Uint8Array([0,0,1,179,t,i,n,19,255,255,225,88,0,0,1,184,0,8,0,0,0,0,1,0]))}},o.prototype.recordFrameFromCurrentBuffer=function(){if(this.isRecording){if(this.recorderWaitForIntraFrame){if(this.pictureCodingType!==T)return;this.recorderWaitForIntraFrame=!1,this.didStartRecordingCallback&&this.didStartRecordingCallback(this)}this.recordedFrames++,this.recordedSize+=this.buffer.writePos,this.recordBuffers.push(new Uint8Array(this.buffer.bytes.subarray(0,this.buffer.writePos)))}},o.prototype.discardRecordBuffers=function(){this.recordBuffers=[],this.recordedFrames=0},o.prototype.stopRecording=function(){var e=new Blob(this.recordBuffers,{type:"video/mpeg"});return this.discardRecordBuffers(),this.isRecording=!1,e},o.prototype.intraFrames=[],o.prototype.currentFrame=-1,o.prototype.currentTime=0,o.prototype.frameCount=0,o.prototype.duration=0,o.prototype.progressiveMinSize=131072,o.prototype.fetchReaderPump2=function(e){var t=this;e.read((function(i){t.receiveStarted=!0,t.fetchReaderReceive(e,i)}))},o.prototype.fetchReaderReceive=function(e,t){if(t.done){if(this.seekable){var i=this.buffer.index;this.collectIntraFrames(),this.buffer.index=i}return this.duration=this.frameCount/this.pictureRate,void(this.lastFrameIndex=this.buffer.writePos<<3)}if(this.buffer.bytes.set(t.value,this.buffer.writePos),this.buffer.writePos+=t.value.byteLength,this.lastFrameIndex=this.findLastPictureStartCode(),!this.sequenceStarted&&this.buffer.writePos>=this.progressiveMinSize){if(this.findStartCode(A),this.firstSequenceHeader=this.buffer.index,!this.decodeSequenceHeader())return void(this.errHndlr&&this.errHndlr({type:"decodeFailed",width:this.width,height:this.height,url:this.url}));this.nextFrame(),this.autoplay&&this.play()}this.externalLoadCallback&&(this.loadeReadyRate?this.buffer.writePos>this.buffer.length/this.loadeReadyRate&&(this.externalLoadCallback(this),this.externalLoadCallback=void 0):(this.externalLoadCallback(this),this.externalLoadCallback=void 0)),this.fetchReaderPump2(e)},o.prototype.findLastPictureStartCode=function(){for(var e=this.buffer.bytes,t=this.buffer.writePos;t>3;t--)if(e[t]==k&&1==e[t-1]&&0==e[t-2]&&0==e[t-3])return t-3<<3;return 0},o.prototype.load=function(e){this.url=e;var t=this;this.progressive&&n.streamFetch&&(this.progXhr=n.streamFetch(e,(function(e,i){-1!==e?(t.buffer=new V(new ArrayBuffer(e)),t.buffer.writePos=0,t.fetchReaderPump2(i)):t.errHndlr&&t.errHndlr({xhrStatus:i})})))},o.prototype.loadCallback=function(e){this.buffer=new V(e),this.seekable&&(this.collectIntraFrames(),this.buffer.index=0),this.findStartCode(A),this.firstSequenceHeader=this.buffer.index,this.decodeSequenceHeader(),this.duration=this.frameCount/this.pictureRate,this.nextFrame(),this.autoplay&&this.play()},o.prototype.collectIntraFrames=function(){var e;for(e=0;this.findStartCode(k)!==V.NOT_FOUND;e++)this.buffer.advance(10),this.buffer.getBits(3)===T&&this.intraFrames.push({frame:e,index:this.buffer.index-13});this.frameCount=e},o.prototype.seekToFrame=function(e,t){if(e<0||e>=this.frameCount||!this.intraFrames.length)return!1;for(var i=null,n=0;n<this.intraFrames.length&&this.intraFrames[n].frame<=e;n++)i=this.intraFrames[n];if(this.buffer.index=i.index,this.currentFrame=i.frame-1,t){for(var r=i.frame;r<e;r++)this.decodePicture(a),this.findStartCode(k);this.currentFrame=e-1}return this.decodePicture(),!0},o.prototype.seekToTime=function(e,t){this.seekToFrame(e*this.pictureRate|0,t)},o.prototype.play=function(){this.playing||(this.targetTime=this.now(),this.playing=!0,this.wantsToPlay=!0,this.scheduleNextFrame())},o.prototype.pause=function(){this.playing=!1,this.wantsToPlay=!1},o.prototype.stop=function(){this.currentFrame=-1,this.buffer&&(this.buffer.index=this.firstSequenceHeader),this.playing=!1,this.client&&(this.client.close(),this.client=null),this.wantsToPlay=!1,this.progXhr&&this.progXhr.abort()},o.prototype.readCode=function(e){var t=0;do{t=e[t+this.buffer.getBits(1)]}while(t>=0&&0!==e[t]);return e[t+2]},o.prototype.findStartCode=function(e){for(var t=0;;)if((t=this.buffer.findNextMPEGStartCode())===e||t===V.NOT_FOUND)return t;return V.NOT_FOUND},o.prototype.fillArray=function(e,t){for(var i=0,n=e.length;i<n;i++)e[i]=t},o.prototype.pictureRate=30,o.prototype.lateTime=0,o.prototype.firstSequenceHeader=0,o.prototype.targetTime=0,o.prototype.benchmark=!1,o.prototype.benchFrame=0,o.prototype.benchDecodeTimes=0,o.prototype.benchAvgFrameTime=0,o.prototype.now=function(){return window.performance?window.performance.now():Date.now()},o.prototype.nextFrame=function(){if(this.buffer&&this.receiveStarted)for(var e=this.now();;){var t=this.buffer.findNextMPEGStartCode();if(t===A)this.decodeSequenceHeader();else{if(t===k)return this.progressive&&this.buffer.index>=this.lastFrameIndex?(this.playing=!1,void this.errHndlr({reason:"starved",currentTime:this.currentTime})):(this.playing&&this.scheduleNextFrame(),this.decodePicture(),this.benchDecodeTimes+=this.now()-e,this.canvas);if(t===V.NOT_FOUND)return this.stop(),this.externalFinishedCallback&&this.externalFinishedCallback(this),this.loop&&this.sequenceStarted&&this.play(),null}}},o.prototype.scheduleNextFrame=function(){this.lateTime=this.now()-this.targetTime;var e=Math.max(0,1e3/this.pictureRate-this.lateTime);this.targetTime=this.now()+e,this.benchmark?(this.benchFrame++,this.benchFrame>=120&&(this.benchAvgFrameTime=this.benchDecodeTimes/this.benchFrame,this.benchFrame=0,this.benchDecodeTimes=0,window.console&&console.log("Average time per frame:",this.benchAvgFrameTime,"ms")),setTimeout(this.nextFrame.bind(this),0)):e<18?this.scheduleAnimation():setTimeout(this.scheduleAnimation.bind(this),e)},o.prototype.scheduleAnimation=function(){r(this.nextFrame.bind(this),this.canvas)},o.prototype.decodeSequenceHeader=function(){if(this.width=this.buffer.getBits(12),this.height=this.buffer.getBits(12),this.width<1||this.height<1)return!1;var e;if(this.buffer.advance(4),this.pictureRate=l[this.buffer.getBits(4)],this.buffer.advance(30),this.initBuffers(),this.buffer.getBits(1)){for(e=0;e<64;e++)this.customIntraQuantMatrix[c[e]]=this.buffer.getBits(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.buffer.getBits(1)){for(e=0;e<64;e++)this.customNonIntraQuantMatrix[c[e]]=this.buffer.getBits(8);this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}return!0},o.prototype.fitInParent=function(e){e.style.position="relative";var t=e.parentElement,i=t.clientWidth||this.pcx,n=t.clientHeight||this.pcy,r=Math.min(i/e.clientWidth,n/e.clientHeight),o=e.clientWidth*r,s=e.clientHeight*r;e.style.width=o+"px",e.style.height=s+"px",e.style.left=0,e.style.top=0,i>o?e.style.left=(i-o)/2+"px":n>s&&(e.style.top=(n-s)/2+"px")},o.prototype.initBuffers=function(){if(this.intraQuantMatrix=d,this.nonIntraQuantMatrix=u,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.quarterSize=this.codedSize>>2,!this.sequenceStarted){this.sequenceStarted=!0;var e=window.Uint8ClampedArray||window.Uint8Array;if(window.Uint8ClampedArray||(this.copyBlockToDestination=this.copyBlockToDestinationClamp,this.addBlockToDestination=this.addBlockToDestinationClamp),this.currentY=new e(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new e(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new e(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new e(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new e(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new e(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer),this.aspect=this.height/this.width,this.canvas.width=this.width,this.canvas.height=this.height,this.centerVertically&&this.fitInParent(this.canvas),this.canvasCss)for(var t in this.canvasCss)this.canvas.style[t]=this.canvasCss[t];this.gl?(this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)):(this.currentRGBA=this.canvasContext.getImageData(0,0,this.width,this.height),this.fillArray(this.currentRGBA.data,255))}},o.prototype.currentY=null,o.prototype.currentCr=null,o.prototype.currentCb=null,o.prototype.currentRGBA=null,o.prototype.pictureCodingType=0,o.prototype.forwardY=null,o.prototype.forwardCr=null,o.prototype.forwardCb=null,o.prototype.fullPelForward=!1,o.prototype.forwardFCode=0,o.prototype.forwardRSize=0,o.prototype.forwardF=0,o.prototype.decodePicture=function(e){if(this.currentFrame++,this.currentTime=this.currentFrame/this.pictureRate,this.buffer.advance(10),this.pictureCodingType=this.buffer.getBits(3),this.buffer.advance(16),!(this.pictureCodingType<=0||this.pictureCodingType>=S)){if(this.pictureCodingType===P){if(this.fullPelForward=this.buffer.getBits(1),this.forwardFCode=this.buffer.getBits(3),0===this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}var t=0;do{t=this.buffer.findNextMPEGStartCode()}while(t===O||t===D);for(;t>=E&&t<=C;)this.decodeSlice(255&t),t=this.buffer.findNextMPEGStartCode();if(this.buffer.rewind(32),this.recordFrameFromCurrentBuffer(),e!==a&&(this.renderFrame(),this.externalDecodeCallback&&this.externalDecodeCallback(this,this.canvas)),this.pictureCodingType===T||this.pictureCodingType===P){var i=this.forwardY,n=this.forwardY32,r=this.forwardCr,o=this.forwardCr32,s=this.forwardCb,l=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=i,this.currentY32=n,this.currentCr=r,this.currentCr32=o,this.currentCb=s,this.currentCb32=l}}},o.prototype.YCbCrToRGBA=function(){for(var e,t,i,n,r,o=this.currentY,s=this.currentCb,a=this.currentCr,l=this.currentRGBA.data,c=0,d=this.codedWidth,u=this.codedWidth+(this.codedWidth-this.width),h=0,p=this.halfWidth-(this.width>>1),f=0,m=4*this.width,g=4*this.width,y=this.width>>1,v=this.height>>1,b=0;b<v;b++){for(var _=0;_<y;_++){e=s[h],t=a[h],h++,i=t+(103*t>>8)-179,n=(88*e>>8)-44+(183*t>>8)-91,r=e+(198*e>>8)-227;var w=o[c++],T=o[c++];l[f]=w+i,l[f+1]=w-n,l[f+2]=w+r,l[f+4]=T+i,l[f+5]=T-n,l[f+6]=T+r,f+=8;var P=o[d++],S=o[d++];l[m]=P+i,l[m+1]=P-n,l[m+2]=P+r,l[m+4]=S+i,l[m+5]=S-n,l[m+6]=S+r,m+=8}c+=u,d+=u,f+=g,m+=g,h+=p}},o.prototype.renderFrame2D=function(){this.YCbCrToRGBA(),this.canvasContext.putImageData(this.currentRGBA,0,0)},o.prototype.gl=null,o.prototype.program=null,o.prototype.YTexture=null,o.prototype.CBTexture=null,o.prototype.CRTexture=null,o.prototype.createTexture=function(e,t){var i=this.gl,n=i.createTexture();return i.bindTexture(i.TEXTURE_2D,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.uniform1i(i.getUniformLocation(this.program,t),e),n},o.prototype.compileShader=function(e,t){var i=this.gl,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw this.errHndlr({glGetShaderParameter:"error"}),new Error(i.getShaderInfoLog(n));return n},o.prototype.initWebGL=function(){var e;try{e=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")}catch(e){return!1}if(!e)return!1;if(this.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),e.STATIC_DRAW),this.program=e.createProgram(),e.attachShader(this.program,this.compileShader(e.VERTEX_SHADER,x)),e.attachShader(this.program,this.compileShader(e.FRAGMENT_SHADER,I)),e.linkProgram(this.program),!e.getProgramParameter(this.program,e.LINK_STATUS))throw this.errHndlr({glGetProgramInfoLog:"error"}),new Error(e.getProgramInfoLog(this.program));e.useProgram(this.program),this.YTexture=this.createTexture(0,"YTexture"),this.CBTexture=this.createTexture(1,"CBTexture"),this.CRTexture=this.createTexture(2,"CRTexture");var t=e.getAttribLocation(this.program,"vertex");return e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),this.loadingProgram=e.createProgram(),e.attachShader(this.loadingProgram,this.compileShader(e.VERTEX_SHADER,x)),e.attachShader(this.loadingProgram,this.compileShader(e.FRAGMENT_SHADER,R)),e.linkProgram(this.loadingProgram),e.useProgram(this.loadingProgram),t=e.getAttribLocation(this.loadingProgram,"vertex"),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),!0},o.prototype.renderFrameGL=function(){var e=this.gl,t=new Uint8Array(this.currentY.buffer),i=new Uint8Array(this.currentCr.buffer),n=new Uint8Array(this.currentCb.buffer);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.YTexture),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,this.codedWidth,this.height,0,e.LUMINANCE,e.UNSIGNED_BYTE,t),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.CBTexture),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,this.halfWidth,this.height/2,0,e.LUMINANCE,e.UNSIGNED_BYTE,i),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this.CRTexture),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,this.halfWidth,this.height/2,0,e.LUMINANCE,e.UNSIGNED_BYTE,n),e.drawArrays(e.TRIANGLE_STRIP,0,4)},o.prototype.quantizerScale=0,o.prototype.sliceBegin=!1,o.prototype.decodeSlice=function(e){for(this.sliceBegin=!0,this.macroblockAddress=(e-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.buffer.getBits(5);this.buffer.getBits(1);)this.buffer.advance(8);do{this.decodeMacroblock()}while(!this.buffer.nextBytesAreStartCode())},o.prototype.macroblockAddress=0,o.prototype.mbRow=0,o.prototype.mbCol=0,o.prototype.macroblockType=0,o.prototype.macroblockIntra=!1,o.prototype.macroblockMotFw=!1,o.prototype.motionFwH=0,o.prototype.motionFwV=0,o.prototype.motionFwHPrev=0,o.prototype.motionFwVPrev=0,o.prototype.decodeMacroblock=function(){for(var e=0,t=this.readCode(p);34===t;)t=this.readCode(p);for(;35===t;)e+=33,t=this.readCode(p);if(e+=t,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=e;else{if(this.macroblockAddress+e>=this.mbSize)return;for(e>1&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureCodingType===P&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));e>1;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),e--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.macroblockType=this.readCode(B[this.pictureCodingType]),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.buffer.getBits(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var i=0!=(2&this.macroblockType)?this.readCode(y):this.macroblockIntra?63:0,n=0,r=32;n<6;n++)0!=(i&r)&&this.decodeBlock(n),r>>=1},o.prototype.decodeMotionVectors=function(){var e,t,i=0;this.macroblockMotFw?(0!==(e=this.readCode(v))&&1!==this.forwardF?(i=this.buffer.getBits(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwHPrev+=t,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),0!==(e=this.readCode(v))&&1!==this.forwardF?(i=this.buffer.getBits(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwVPrev+=t,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureCodingType===P&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},o.prototype.copyMacroblock=function(e,t,i,n,r){var o,s,a,l,c,d,u,h,p,f,m,g,y,v,b,_,w,T,P,S=this.currentY32,A=this.currentCb32,E=this.currentCr32;if(s=(o=this.codedWidth)-16,a=e>>1,l=t>>1,c=1==(1&e),d=1==(1&t),u=((this.mbRow<<4)+l)*o+(this.mbCol<<4)+a,p=(h=this.mbRow*o+this.mbCol<<2)+(o<<2),c)if(d)for(;h<p;){for(m=i[u]+i[u+o],u++,f=0;f<4;f++)y=m+(g=i[u]+i[u+o])+2>>2&255,y|=(m=i[++u]+i[u+o])+g+2<<6&65280,y|=m+(g=i[++u]+i[u+o])+2<<14&16711680,m=i[++u]+i[u+o],u++,y|=m+g+2<<22&4278190080,S[h++]=y;h+=s>>2,u+=s-1}else for(;h<p;){for(m=i[u++],f=0;f<4;f++)y=m+(g=i[u++])+1>>1&255,y|=(m=i[u++])+g+1<<7&65280,y|=m+(g=i[u++])+1<<15&16711680,y|=(m=i[u++])+g+1<<23&4278190080,S[h++]=y;h+=s>>2,u+=s-1}else if(d)for(;h<p;){for(f=0;f<4;f++)y=i[u]+i[u+o]+1>>1&255,y|=i[++u]+i[u+o]+1<<7&65280,y|=i[++u]+i[u+o]+1<<15&16711680,y|=i[++u]+i[u+o]+1<<23&4278190080,u++,S[h++]=y;h+=s>>2,u+=s}else for(;h<p;){for(f=0;f<4;f++)y=i[u],y|=i[++u]<<8,y|=i[++u]<<16,y|=i[++u]<<24,u++,S[h++]=y;h+=s>>2,u+=s}if(s=(o=this.halfWidth)-8,a=e/2>>1,l=t/2>>1,c=1==(e/2&1),d=1==(t/2&1),u=((this.mbRow<<3)+l)*o+(this.mbCol<<3)+a,p=(h=this.mbRow*o+this.mbCol<<1)+(o<<1),c)if(d)for(;h<p;){for(v=n[u]+n[u+o],w=r[u]+r[u+o],u++,f=0;f<2;f++)_=v+(b=n[u]+n[u+o])+2>>2&255,P=w+(T=r[u]+r[u+o])+2>>2&255,_|=(v=n[++u]+n[u+o])+b+2<<6&65280,P|=(w=r[u]+r[u+o])+T+2<<6&65280,_|=v+(b=n[++u]+n[u+o])+2<<14&16711680,P|=w+(T=r[u]+r[u+o])+2<<14&16711680,v=n[++u]+n[u+o],w=r[u]+r[u+o],u++,_|=v+b+2<<22&4278190080,P|=w+T+2<<22&4278190080,E[h]=_,A[h]=P,h++;h+=s>>2,u+=s-1}else for(;h<p;){for(v=n[u],w=r[u],u++,f=0;f<2;f++)_=v+(b=n[u])+1>>1&255,P=w+(T=r[u++])+1>>1&255,_|=(v=n[u])+b+1<<7&65280,P|=(w=r[u++])+T+1<<7&65280,_|=v+(b=n[u])+1<<15&16711680,P|=w+(T=r[u++])+1<<15&16711680,_|=(v=n[u])+b+1<<23&4278190080,P|=(w=r[u++])+T+1<<23&4278190080,E[h]=_,A[h]=P,h++;h+=s>>2,u+=s-1}else if(d)for(;h<p;){for(f=0;f<2;f++)_=n[u]+n[u+o]+1>>1&255,P=r[u]+r[u+o]+1>>1&255,_|=n[++u]+n[u+o]+1<<7&65280,P|=r[u]+r[u+o]+1<<7&65280,_|=n[++u]+n[u+o]+1<<15&16711680,P|=r[u]+r[u+o]+1<<15&16711680,_|=n[++u]+n[u+o]+1<<23&4278190080,P|=r[u]+r[u+o]+1<<23&4278190080,u++,E[h]=_,A[h]=P,h++;h+=s>>2,u+=s}else for(;h<p;){for(f=0;f<2;f++)_=n[u],P=r[u],_|=n[++u]<<8,P|=r[u]<<8,_|=n[++u]<<16,P|=r[u]<<16,_|=n[++u]<<24,P|=r[u]<<24,u++,E[h]=_,A[h]=P,h++;h+=s>>2,u+=s}},o.prototype.blockData=null,o.prototype.decodeBlock=function(e){var t,i=0;if(this.macroblockIntra){var n,r;if(e<4?(n=this.dcPredictorY,r=this.readCode(b)):(n=4===e?this.dcPredictorCr:this.dcPredictorCb,r=this.readCode(_)),r>0){var o=this.buffer.getBits(r);this.blockData[0]=0!=(o&1<<r-1)?n+o:n+(-1<<r|o+1)}else this.blockData[0]=n;e<4?this.dcPredictorY=this.blockData[0]:4===e?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,t=this.intraQuantMatrix,i=1}else t=this.nonIntraQuantMatrix;for(var s,a,l,d=0;;){var u=0,p=this.readCode(w);if(1===p&&i>0&&0===this.buffer.getBits(1))break;65535===p?(u=this.buffer.getBits(6),0===(d=this.buffer.getBits(8))?d=this.buffer.getBits(8):128===d?d=this.buffer.getBits(8)-256:d>128&&(d-=256)):(u=p>>8,d=255&p,this.buffer.getBits(1)&&(d=-d));var f=c[i+=u];i++,d<<=1,this.macroblockIntra||(d+=d<0?-1:1),0==(1&(d=d*this.quantizerScale*t[f]>>4))&&(d-=d>0?1:-1),d>2047?d=2047:d<-2048&&(d=-2048),this.blockData[f]=d*h[f]}e<4?(s=this.currentY,l=this.codedWidth-8,a=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&e)&&(a+=8),0!=(2&e)&&(a+=this.codedWidth<<3)):(s=4===e?this.currentCb:this.currentCr,l=(this.codedWidth>>1)-8,a=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1===i?(this.copyValueToDestination(this.blockData[0]+128>>8,s,a,l),this.blockData[0]=0):(this.IDCT(),this.copyBlockToDestination(this.blockData,s,a,l),this.blockData.set(this.zeroBlockData)):1===i?(this.addValueToDestination(this.blockData[0]+128>>8,s,a,l),this.blockData[0]=0):(this.IDCT(),this.addBlockToDestination(this.blockData,s,a,l),this.blockData.set(this.zeroBlockData)),i=0},o.prototype.copyBlockToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]=e[r+0],t[i+1]=e[r+1],t[i+2]=e[r+2],t[i+3]=e[r+3],t[i+4]=e[r+4],t[i+5]=e[r+5],t[i+6]=e[r+6],t[i+7]=e[r+7]},o.prototype.addBlockToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]+=e[r+0],t[i+1]+=e[r+1],t[i+2]+=e[r+2],t[i+3]+=e[r+3],t[i+4]+=e[r+4],t[i+5]+=e[r+5],t[i+6]+=e[r+6],t[i+7]+=e[r+7]},o.prototype.copyValueToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]=e,t[i+1]=e,t[i+2]=e,t[i+3]=e,t[i+4]=e,t[i+5]=e,t[i+6]=e,t[i+7]=e},o.prototype.addValueToDestination=function(e,t,i,n){for(var r=0;r<64;r+=8,i+=n+8)t[i+0]+=e,t[i+1]+=e,t[i+2]+=e,t[i+3]+=e,t[i+4]+=e,t[i+5]+=e,t[i+6]+=e,t[i+7]+=e},o.prototype.copyBlockToDestinationClamp=function(e,t,i,n){for(var r=0,o=0;o<8;o++){for(var s=0;s<8;s++){var a=e[r++];t[i++]=a>255?255:a<0?0:a}i+=n}},o.prototype.addBlockToDestinationClamp=function(e,t,i,n){for(var r=0,o=0;o<8;o++){for(var s=0;s<8;s++){var a=e[r++]+t[i];t[i++]=a>255?255:a<0?0:a}i+=n}},o.prototype.IDCT=function(){var e,t,i,n,r,o,s,a,l,c,d,u,h,p,f,m,g,y,v,b=this.blockData;for(v=0;v<8;++v)e=b[32+v],t=b[16+v]+b[48+v],i=b[40+v]-b[24+v],o=b[8+v]+b[56+v],s=b[24+v]+b[40+v],l=(h=(473*(n=b[8+v]-b[56+v])-196*i+128>>8)-(r=o+s))-(362*(o-s)+128>>8),p=(c=(a=b[0+v])-e)+(d=(362*(b[16+v]-b[48+v])+128>>8)-t),f=(u=a+e)+t,m=c-d,g=u-t,y=-l-(473*i+196*n+128>>8),b[0+v]=r+f,b[8+v]=h+p,b[16+v]=m-l,b[24+v]=g-y,b[32+v]=g+y,b[40+v]=l+m,b[48+v]=p-h,b[56+v]=f-r;for(v=0;v<64;v+=8)e=b[4+v],t=b[2+v]+b[6+v],i=b[5+v]-b[3+v],o=b[1+v]+b[7+v],s=b[3+v]+b[5+v],l=(h=(473*(n=b[1+v]-b[7+v])-196*i+128>>8)-(r=o+s))-(362*(o-s)+128>>8),p=(c=(a=b[0+v])-e)+(d=(362*(b[2+v]-b[6+v])+128>>8)-t),f=(u=a+e)+t,m=c-d,g=u-t,y=-l-(473*i+196*n+128>>8),b[0+v]=r+f+128>>8,b[1+v]=h+p+128>>8,b[2+v]=m-l+128>>8,b[3+v]=g-y+128>>8,b[4+v]=g+y+128>>8,b[5+v]=l+m+128>>8,b[6+v]=p-h+128>>8,b[7+v]=f-r+128>>8};var s="jsmp",a=1,l=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],c=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),d=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),u=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),h=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),p=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),f=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),m=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),g=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),y=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),v=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),b=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),_=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),w=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),T=1,P=2,S=3,A=179,E=1,C=175,k=0,O=181,D=178,I=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),R=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),x=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n"),B=[null,f,m,g],V=function(e){this.bytes=new Uint8Array(e),this.length=this.bytes.length,this.writePos=this.bytes.length,this.index=0};V.NOT_FOUND=-1,V.prototype.findNextMPEGStartCode=function(){for(var e=this.index+7>>3;e<this.writePos;e++)if(0===this.bytes[e]&&0===this.bytes[e+1]&&1===this.bytes[e+2])return this.index=e+4<<3,this.bytes[e+3];return this.index=this.writePos<<3,V.NOT_FOUND},V.prototype.nextBytesAreStartCode=function(){var e=this.index+7>>3;return e>=this.writePos||0===this.bytes[e]&&0===this.bytes[e+1]&&1===this.bytes[e+2]},V.prototype.nextBits=function(e){var t=this.index>>3,i=8-this.index%8;if(i>=e)return this.bytes[t]>>i-e&255>>8-e;var n=(this.index+e)%8,r=this.index+e-1>>3,o=this.bytes[t]&255>>8-i;for(t++;t<r;t++)o<<=8,o|=this.bytes[t];return n>0?(o<<=n,o|=this.bytes[t]>>8-n):(o<<=8,o|=this.bytes[t]),o},V.prototype.getBits=function(e){var t=this.nextBits(e);return this.index+=e,t},V.prototype.advance=function(e){return this.index+=e},V.prototype.rewind=function(e){return this.index-=e},e.exports=o},3389:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,{streamFetch:function(){return o}});var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.req=t,this.result={value:null,done:!1},this.clbk=null,this.index=0}var t,i,r;return t=e,(i=[{key:"convertRes2",value:function(e){for(var t=this.req.responseText,i=new Uint8Array(e),n=0;n<e;++n)i[n]=255&t.charCodeAt(this.index+n);return i}},{key:"progress",value:function(){var e=this.req.responseText.length,t=e-this.index;t&&(this.result.value=this.convertRes2(t),this.index=e,this.clbk&&this.clbk(this.result))}},{key:"close",value:function(e){this.result.done=!0,this.clbk&&this.clbk(this.result),this.result=void 0,this.clbk=void 0}},{key:"read",value:function(e){this.clbk=e}}])&&n(t.prototype,i),r&&n(t,r),e}();function o(e,t){var i=new XMLHttpRequest,n=null;return i.overrideMimeType("text/plain; charset=x-user-defined"),i.addEventListener("progress",(function(e){if(!n){n=new r(i);var o=i.getResponseHeader("Content-Length");t(o,n)}n.progress()})),i.onreadystatechange=function(e){4===this.readyState&&(200===this.status?n&&n.close():t(-1,this.status))},i.onerror=function(e){t(-1,this.status)},i.open("GET",e),i.send(),i}},701:function(e){var t;function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var n={singleAd:{name:"singleAd",playerType:"singleAd",priority:1,defaultConfigFile:"./SingleAd/DefaultSingleAdConfig",unitsConfigFiles:(t={FEED_MANAGER:"./SingleAd/units/SingleAdFeedManagerConfig",FEED_MANAGER_MOBILE:"./SingleAd/units/SingleAdFeedManagerConfig",WIDGET_ITEM:"./SingleAd/units/SingleAdWidgetItemConfig",WIDGET_ITEM_MOBILE:"./SingleAd/units/SingleAdWidgetItemConfig",INLINE_INSTREAM:"./SingleAd/units/SingleAdInlineConfig",INLINE_MOBILE:"./SingleAd/units/SingleAdInlineConfig"},i(t,"WIDGET_ITEM_MOBILE","./SingleAd/units/SingleAdWidgetItemConfig"),i(t,"SLIDER_INSTREAM","./SingleAd/units/SingleAdSliderConfig"),i(t,"SLIDER_MOBILE","./SingleAd/units/SingleAdSliderConfig"),t)},rv:{name:"rv",priority:3},adjacency:{name:"adjacency",playerType:"adjacencyAd",priority:2,defaultConfigFile:"./Adjacency/DefaultAdjacencyConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Adjacency/units/AdjacFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Adjacency/units/AdjacFeedManagerConfig.js",WIDGET_ITEM:"./Adjacency/units/AdjacencyWidgetItemConfig",WIDGET_ITEM_MOBILE:"./Adjacency/units/AdjacencyWidgetItemConfig",RECO_REEL_WIDGET:"./Adjacency/units/AdjacencyRecoReelWidgetConfig.js"}},replayable:{name:"replayable",defaultConfigFile:"./Replayable/DefaultReplayableConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Replayable/units/ReplayableAdFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Replayable/units/ReplayableAdFeedManagerConfig.js",INLINE_INSTREAM:"./Replayable/units/ReplayableAdInlineConfig.js",INLINE_MOBILE:"./Replayable/units/ReplayableAdInlineConfig.js",WIDGET_ITEM:"./Replayable/units/ReplayableAdWidgetItemConfig.js",WIDGET_ITEM_MOBILE:"./Replayable/units/ReplayableAdWidgetItemConfig.js"},priority:4}};e.exports=n},914:function(e,t,i){"use strict";i.r(t);var n=i(5545),r=i(2447),o=i(701),s=i.n(o);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h(e);if(t){var r=h(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var p,f=i(1999),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(u,e);var t,r,o,a=d(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this)).model=e.model||{},t.log=new n.Z({unitType:t.model.get("unitType"),className:constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.configHierarchy=t._getConfigHierarchy(),t}return t=u,(r=[{key:"_getConfigHierarchy",value:function(){return f.sortBy(s(),(function(e){return e.priority})).reverse()}},{key:"getConfig",value:function(e){var t={};for(var i in this.configHierarchy){var n=this.configHierarchy[i].name,r=e[n],o=s()[n];r&&o&&(this.log.info("creating config for",n),f.extend(t,this._getDefaultConfig(n)),f.extend(t,this._getUnitConfig(n)))}return t}},{key:"getConfigForKey",value:function(e){var t={},i=s()[e]&&s()[e].name;return i&&(this.log.info("creating config for",i),f.extend(t,this._getDefaultConfig(i)),f.extend(t,this._getUnitConfig(i))),t}},{key:"_getDefaultConfig",value:function(e){var t=s()[e].defaultConfigFile;return this.loadFile(t)}},{key:"_getUnitConfig",value:function(e){var t=this.model.get("unitType"),i=s()[e]&&s()[e].unitsConfigFiles,n=i&&i[t];return this.loadFile(n)}},{key:"loadFile",value:function(e){if(e)return i(7418)("./".concat(e.replace("./","").replace(".js",""))).default}}])&&l(t.prototype,r),o&&l(t,o),u}(r.O),g=function(e){return p||(p=new m(e)),p};t.default=g},5449:function(e,t,i){"use strict";i.r(t);t.default={"stickyCard.isActive":!1,"stickyCard.restrictions.adTypeNotAllowed":!0,disableDetachForSession:!0}},8699:function(e,t,i){"use strict";i.r(t);t.default={setAdConfigAfter:"onAdSetToUnits",revertAfter:"_adVideoEnd",isNeedAdjacCard:!0,adjacCardPlacement:1}},256:function(e,t,i){"use strict";i.r(t);t.default={isReplayAd:!0,isMultiAd:!1}},1152:function(e,t,i){"use strict";i.r(t);t.default={setAdConfigAfter:"onAdSetToUnits",isTakeoverWidget:!0,isForceDontDie:!0,"detachToSlider.isDetachToSlider":!1,isMultiAd:!1,isReplayAd:!0,isKeepViewOnMidroll:!0}},7613:function(e,t,i){"use strict";i.r(t);t.default={}},7723:function(e,t,i){"use strict";i.r(t);t.default={setAdConfigAfter:"setSubModel",isReplayable:!0}},3353:function(e,t,i){"use strict";i.r(t);t.default={isReplayable:!0}},6333:function(e,t,i){"use strict";i.r(t);t.default={isReplayable:!0}},7507:function(e,t,i){"use strict";i.r(t);t.default={isMultiAd:!1}},9579:function(e,t,i){"use strict";i.r(t);t.default={setAdConfigAfter:"setSubModel",isPlacementSingleAd:!0,"continueToPlayInNexCard.isActive":!1}},3205:function(e,t,i){"use strict";i.r(t);t.default={isMultiAd:!1,isReplayAd:!0}},7642:function(e,t,i){"use strict";i.r(t);t.default={isReplayAd:!0}},6505:function(e,t,i){"use strict";i.r(t);t.default={setAdConfigAfter:"onAdSetToUnits",stopPredicts:!0,isKeepViewOnMidroll:!0,isKeepUnitOnMidroll:!0,isPlacementSingleAd:!0,isReplayAd:!0,isPreventNextAd:!0}},9836:function(e,t,i){var n=i(9288),r=(i(1999),i(9652));e.exports=n.View.extend({className:"_cm-detach",events:{"click ":"_onClick"},initialize:function(e){this.log=new r({unitType:e.unitType,className:"detachButtonView"}),this.container=e.container,this._rendered=!1},render:function(){if(!this._rendered){var e=this.model.get("components.DetachButtonView.imageLocation");this.$el.css("background-image",'url("'+e+'") !important'),this.container.appendChild(this.el)}},_onClick:function(){this.$el.trigger("cm:detach:click")},hide:function(){this.$el.hide()}})},6042:function(e,t,i){"use strict";var n=i(9288),r=i(9306);e.exports=n.Collection.extend({model:r})},9306:function(e,t,i){"use strict";var n=i(9288);e.exports=n.DeepModel.extend({defaults:{id:0,filename:"",image:"",title:"",vidlength:"",active:!1,clicked:!1}})},6940:function(e,t,i){"use strict";i.d(t,{Z:function(){return v}});var n=i(9288),r=i.n(n),o=i(9057),s=(i(2782),i(9652)),a=i.n(s),l=i(5264),c=i.n(l),d=i(2130),u=i.n(d),h=i(9831),p=i.n(h),f=(i(9861),i(1999)),m=r().DeepModel.extend({STATE:{READY:0,GOT_AD:1,PLAYING:2,PAUSED:3,PAUSED_BY_USER:4,STOPPED_BY_USER:5,DETACHED:6,ATTACHED:7,DONE:8,PLAYER_READY:9,PLAYER_CLOSE:10,PLAYER_STOP:11,AD_STOPPED:12,OPT_OUT:13,OPEN_WITH_PAUSE:14,WAITING_FOR_EXPAND:15,REPEAT_STAND_BY:16,REPEAT_SPINNING:17,SKIPPED_BY_USER:18},defaults:{abTest:"",adMaxPlaySeconds:181,adTitle:"Video",adVolume:"auto",aspectRatio:"16:9",aspectRatioNum:"{{defaultAspectRatioNum}}",defaultAspectRatioNum:16/9,autoPlay:!0,baseReportD:"basebanner.com",oppsDataCenter:"la",cfr:0,country:"",clickTestSeconds:.5,defaultAdParameters:"",defaultTagTimeout:20,gaFactor:1e4,gaFrameSrc:"{{urls.base}}/release-r1/assets/ga.html#page={{gaVertical}}&category={{gaVertical}}",gaVertical:"source",height:0,interruptLoading:!0,ip:"",isAllowDuplicateKey:!0,isDebug:!1,isFirePixel:!0,isHideIframe:!1,isMobile:!1,isMobileMacros:!1,isPlayerViewable:!1,isProtectedInIframe:!0,isRepeat:!0,isResponsive:!0,isCallIDLE:!1,isShowOnAd:!1,isShowOnAdLocation:"begin",isSoundOnHover:!1,isUnitEligible:!1,isUnitViewable:!1,isUseObserver:!1,isUseNonNativeObserver:!1,kbnul:"//vidanalytics.taboola.com",lineItemId:"",loaderImage:"",logViewabilityCalc:!1,mfp:4,mobilePlayer:"DP",mobileSpriteTimeoutSeconds:20,mute:!0,noaop:2,noDebugReport:!1,openingEffect:0,originId:15,placement:"",playerContainer:"body",playerEndSeconds:0,playerVolume:0,printCurrentViewPercent:!1,predefinedSettings:{level:1},repeat:!0,retriesLWF:5,reportTimerSeconds:10,ronPercent:5,secondsBW:10,secondsInView:2,secondsLWF:.1,secondsToClose:0,secondsToCloseGlobal:0,sortOrderType:0,state:null,timeBetweenAds:1,totalTimeout:60,traceViewabilitySeconds:2,traceViewability100Seconds:2,ulog:[""],vastRetry:2,version:"158_allow_sec",vertical:"source",viewabilityPercent:50,volumeMuted:!0,wfManual:!1,volume:"onHover",width:0,maxVimpsInQueue:2,autoplayDetectorTimeoutSec:1,billableEvents:[1,21,22,23,24,25,30,32],firstCardForAdjac:1,useSwfVideoJs:!0,isPWOV:!1,frameType:u().FRAME_TYPE.plainPage,"100viewPercent":100,mpgclrslv:["gcdn.2mdn.net"],cnvsldrt:5,gtvid:"//cnv.tcsrv.com/getvid?url",playerTextAlign:!0,cookieMatchActive:!1,fmNoAboveSelector:"no-vabove",fmNoBelowSelector:"no-vbelow",vForce:{isActive:!1,getAdTimeoutSeconds:10},detach:{width:320,position:{horizontal:"right",vertical:"bottom"}},customization:{unitContainer:{},adTitle:{},placeHolder:{},playerView:{}},midrollCollapse:{isActive:!1,time:5},pixels:{D2DFallback:{id:31468623,type:5,isFire:!0},conversion:{id:31425418,type:2,isFire:!0},close:{id:31579687,type:5,isFire:!0},timeout:{id:31574457,type:5,isFire:!0},optOut:{id:31530958,type:5,isFire:!0},optOutNever:{id:31419288,type:5,isFire:!0},addImpresion:{id:31579657,type:5,isFire:!0},eligible:{id:31579697,type:16,isFire:!0},networkError:{type:42},lostEligibility:{type:43,isFire:!0},fraudDetection:{type:32},clickthrough:{type:44},error:{id:31608187,type:5,isFire:!0},quarterly1:{id:31608197,type:5,isFire:!0},quarterly2:{id:31608207,type:5,isFire:!0},quarterly3:{id:31608217,type:5,isFire:!0},complete:{id:31608237,type:5,isFire:!0},render:{id:31608177,type:5,isFire:!0},startWithABT:{id:31589837,type:45,isFire:!1},repeatClick:{type:46},renderOnDemand:{type:51},stopUnit:{type:52},getAdAny:{type:53,isFire:!1},getAdNoRV:{type:54,isFire:!1},getAd:{type:55,isFire:!1},secondsToCloseTimer:{type:56,isFire:!1},secondsToCloseGlobalTimer:{type:57,isFire:!1},midrollCollapseTimer:{type:58,isFire:!1},attach:{type:61},detach:{type:62},D2DClick:{type:63},D2DClickSuspicious:{type:68},TRCResetCloseUnit:{type:64},sliderFeedStartWithABT:{type:65},onParentSelectorLost:{type:66},adChoice:{type:67},noCMPonPage:{type:72},hasCMPonPage:{type:73,isFire:!0},rvHandlerTimerExpired:{type:74},onPlayerHasRVinQ:{type:75},skippedDistancePredict:{type:76},publisherVideoDetected:{type:78},publisherIframeVideoDetected:{type:79},compDetectedOnPage:{type:80},feedxToggle:{type:82},testPixels:{type:100},fullEligibilityPredict:{type:77,isFire:!1},progressLoaderInit:{type:83},progressLoaderMove:{type:84},progressLoaderClose:{type:85},organicCardInjected:{type:86},organicCardInjectionFail:{type:87},terminateOnResize:{type:89},unitDelayed:{type:93},unitLoadAfterDelay:{type:94},autoplaySoundOn:{type:95},generalError:{type:96},exploreMore:{type:98},passbackFunctionCalled:{type:99,isFire:!0},onUnitDimensionsFound:{type:116},onVideoResetCloseUnit:{type:117},forcedDetach:{type:118},unitLoaded:{type:120},unitLoadedWithFill:{type:121},feedHasNoCardsToOpen:{type:122},recoReelNotFound:{type:127,name:"recoReelNotFound",isFire:!0},misplacedVideoDetected:{type:132,isFire:!0},reportingObserver:{type:134,name:"reportingObserver",isFire:!1},overlayDetectedAfterImpression:{type:135,name:"overlayDetectedAfterImpression",isFire:!1,factor:0},validEligibility:{type:136,name:"validEligibility",isFire:!1},noAdjacInFirstWFs:{type:140,name:"noAdjacInFirstWFs",isFire:!0},hasImpBeforeReadMoreViewable:{type:141,name:"hasImpBeforeReadMoreViewable",isFire:!1},readMoreIsInitiallyInViewport:{type:142,name:"readMoreIsInitiallyInViewport",isFire:!1},readMoreClick:{type:145,name:"readMoreClick",isFire:!1},delayRvPredict:{type:147,name:"delayRvPredict",isFire:!0},executeDelayedRvPredict:{type:148,name:"executeDelayedRvPredict",isFire:!0},minutelyStartedPlaying:{type:149,name:"minutelyStartedPlaying",isFire:!1},minutelyPauseForAdPlay:{type:150,name:"minutelyPauseForAdPlay",isFire:!1},minutelyResumeOnAdClose:{type:151,name:"minutelyResumeOnAdClose",isFire:!1},cancelGetAdOnEligibilityLost:{type:152,name:"cancelGetAdOnEligibilityLost",isFire:!1},dataSaverMode:{type:153,name:"dataSaverMode",isFire:!1},placementPushedOutOfViewport:{type:154,name:"placementPushedOutOfViewport",isFire:!1},recoReelTextTermination:{type:155,name:"recoReelTextTermination",isFire:!1},url:"//conv{{dataCenter}}mp.{{baseReportD}}/st"},closeButton:{hasCloseButton:!0,secondsToCloseButton:5},urls:{base:"//vidstat.taboola.com",staticImage:""},player:{versions:{vplayer:"v13.0.4",content:"26_1_18m"},urls:{vplayerLocation:"{{urls.base}}/vpaid/vPlayer",vpaidLocation:"{{player.urls.vplayerLocation}}/vpaidjs/{{player.versions.vplayer}}/main-vpaid.js",playerLocation:"{{player.urls.vplayerLocation}}/player/{{player.versions.vplayer}}",contentVideosLocation:"//vidstat.taboola.com/vid",oppsBasePath:"//opps.{{baseReportD}}",nonBllbOppsBasePath:"//{{oppsDataCenter}}-vid-events.taboola.com",oppsRequest:"{{player.urls.oppsBasePath}}/OpportunityServlet",nonBllboppsRequest:"{{player.urls.nonBllbOppsBasePath}}/OpportunityServlet",wfBasePath:"//wf.{{baseReportD}}",domainWfBasePath:"//{{oppsDataCenter}}-wf.{{baseReportD}}",wfRequest:"{{player.urls.wfBasePath}}/VideoBidRequestHandlerServlet"},settings:{dlgverr:!0},b2b:1,bfFactor:15,hasAdControls:!0,hasBFeature:!0,hasControls:!0,isBypassFlash:!0,isFire99:!0,isFlashPlayer:!0,minVpaidRunTime:4},components:{D2DFallbackView:{pubId:127968,pubTagId:756668,height:"{{height}}",width:"{{width}}",location:"//15.{{baseReportD}}/WhiteLabelBidRequestHandlerServlet"},OptOut:{hasOptOut:!0,pubId:0,pubTagId:0,imageLocation:"{{urls.base}}/fp/img/closeVideo.png"},CloseButtonView:{hasCloseButton:!1,delay:1500,imageLocation:"{{urls.base}}/assets/x-close-24.png"},TimerView:{hasTimer:!1,time:3,countdownAction:"closeButton"},DetachButtonView:{hasDetuchView:!1,time:1,imageLocation:"{{urls.base}}/assets/ContractButton32.png"},Repeat:{isActive:!1,repalyIcon:"{{urls.base}}/assets/replay-button.svg",replayHoverIcon:"{{urls.base}}/assets/replay-button-hover.svg",learnMoreIcon:"{{urls.base}}/assets/learn-more-button.svg",learnMoreHoverIcon:"{{urls.base}}/assets/learn-more-button-hover.svg",backgroundImage:"{{urls.base}}/assets/blurry-image.png"},PosterView:{isActive:!1,imageLocation:"{{urls.base}}/img/play_image_4.jpg",defaultLocation:"{{urls.base}}/img/play_image_3.jpg"},Loading:{type:"img",imgUrl:"{{urls.base}}/assets/loading2.png",staticUrl:"{{urls.base}}/assets/repeat1.PNG"},contentVideo:{loadingImgae:"{{components.Loading.imgUrl}}",muteImgUrl:"{{urls.base}}/assets/video_controls/desk_muted2.svg",unmuteImgUrl:"{{urls.base}}/assets/video_controls/desk_playing2.svg",pauseImgUrl:"{{urls.base}}/assets/video_controls/pause2.svg"},contentCarousel:{backgroundImage:"{{urls.base}}/img/play_image_3.jpg"}},content:{playClicked:!0},noSoundBrowsers:{chrome:{minVersion:66},safari:{minVersion:11},firefox:{minVersion:66}},microServices:{base_url:"//vidstat.taboola.com/",async:!0,oppsula:{version:"1.4.3"},videoElement:{version:"2.2.17"},autoplayDetector:{version:"1.0.0"}},ms_data:{opps_base_path:"//{{oppsDataCenter}}-vid-events.taboola.com"},style:{videoBackgroundColor:"black"},isUseCrossUnitCommunication:!0,isObserveCrossUnitCommunication:!0,isUpdateCrossUnitCommunication:!0,blockedByExternalUnit:!1,playingNowString:"NOW <br/> PLAYING",isGetRv1OnlyForEligible:{isActive:!1,delayPrediction:!1},isCancelGetAdOnEligibilityLost:!1,isChangePredictPointsWithAny:!0,disableAttachWhenStartFromSlider:!0},storage:{},initialize:function(){this.log=new(a())({unitType:this.get("unitType"),className:"BaseUnitModel"}),this._parseFrameType();var e=this.get("demo");e&&this.set("preset.demo",e),this.get("isDebug")&&this.set("preset.isDebug",1);var t=this.get("isFireAllPixels");t&&this.set("preset.isFireAllPixels",t);var i=this.get("predictorsPresets");i&&this.set("preset.predictorsPresets",i);var n=this._getSettingsByConditions();this.set(n.preset);var r=this._getPresets(c().pms);for(var o in this.log.info("Presets Settings: ",[r.weakerThenSetByCon,r.strongerThenSetByCon]),r.weakerThenSetByCon)this.set(r.weakerThenSetByCon[o].presetData);for(var s in this.set(n.settings),r.strongerThenSetByCon)this.set(r.strongerThenSetByCon[s].presetData);this._setUrlParameters(),this._processPushArray(),this.get("baseReport")&&this.get("oppsBasePath)")&&this.set("oppsBasePath",this.get("baseReport")),this.set("isUseObserverChanged",!1),this.get("isUseObserver")&&!f.isObserverSupported("IntersectionObserver",this.get("isUseNonNativeObserver"))&&(this.set("isUseObserver",!1),this.set("isUseObserverChanged",!0)),this.get("isUseObserverForCardLocator")&&!f.isObserverSupported("IntersectionObserver",this.get("isUseNonNativeObserver"))&&this.set("isUseObserverForCardLocator",!1),this.volume=this.get("volume"),this.set("volume","off"),this._bindEvents(),this.log.info("unit model created:",this.attributes),this._handleABTest(),this._handleLiteUnitPixels(),(this.get("isApiPassbackExist")||this.get("onPassback"))&&(this.set("dlywf",!1),this.set("player.settings.rvfrquesttsemttr","any")),"body"===String(this.get("videoContainerSelector")).toLowerCase()&&this.set("videoContainerSelector",!1),this._setQueriesFunctions(),this._setCrossUnitCommunication(),this.get("isChangePredictPointsWithAny")&&this._changeAnyToZeroInPredictors(),this.get("disableAttachWhenStartFromSlider")&&this._decideSuperSlider(),!0===this.get("isGetRv1OnlyForEligible")&&(this.set("isGetRv1OnlyForEligible.isActive",!0),this.set("isGetRv1OnlyForEligible.delayPrediction",!0))},get:function(e){var t=r().DeepModel.prototype.get.call(this,e);if(!t||"string"!=typeof t)return t;for(var i=t.match(/\{\{(.*?)\}\}/g);i;){for(var n=0;n<i.length;n++){var o=i[n].substr(2,i[n].length-4),s=r().DeepModel.prototype.get.call(this,o);s||(s=""),t=t.replace(i[n],s)}i=t.match(/\{\{(.*?)\}\}/g)}return t},_setQueriesFunctions:function(){var e=this;f.forEach(u().UNIT_QUERY_LANGUAGE.SUPPORTED_CONFIG_FLAGS,(function(t){var i=e.get("".concat(t,".restrictions"));f.forEach(i,(function(i,n,r){var o="".concat(t,".restrictions.").concat(n),s=e.get("".concat(o,".queries"));if(s){var a=e.get("".concat(o,".default"));a=f.isBoolean(a)?a:'"'.concat(a,'"');var l=e._getQueryFunction(s,a);e.set("".concat(o,".decisionFunction"),l)}}))}))},_getQueryFunction:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";f.forEach(e,(function(e){n+=t._getQueryIfStatment(e)})),i=void 0!==i?"return ".concat(i,";"):"";var r="".concat(n,"\n").concat(i);return new Function("model","activeAd",r)},_getQueryIfStatment:function(e){var t=e.rule,i=e.valueIfTrue;return i=f.isBoolean(i)?i:'"'.concat(i,'"'),f.forEach(u().UNIT_QUERY_LANGUAGE.MAPPING,(function(e){t=t.split(e.search).join(e.replaceWith)}),this),"if(".concat(t,"){return ").concat(i,"};\n")},getPixel:function(e){!this.pixel&&this._createPixel();var t=this.get(e);if("pixels.conversion"===e&&r().trigger("global:creativeEvent",{type:"conversion"}),t.isFire)return this.pixel({type:t.type||"",pixelId:t.id,timestamp:Date.now(),subUnit:this.get("subUnitType")})},_createPixel:function(){var e=this.get("pixels.url")+"?cijs=convusmp&ttype={{type}}&cisd=convusmp&cipid="+this.get("cipid")+"&crid="+this.get("creativeId")+"&dast="+this.get("dast")+"&cmcv=&pix={{pixelId}}&cb={{timestamp}}&uv="+this.get("unitVersion")+"&tms={{timestamp}}&su={{subUnit}}";this.get("abTest")&&(e+="&abt="+this.get("abTest")),this.get("referrerUrl")&&(e+="&ru="+this.get("referrerUrl")),e+="&ft="+this.get("frameType"),e=this._addPixelParameter("tagCpmFloor","cft",e),e=this._addPixelParameter("unitId","blid",e),e=this._addPixelParameter("unitName","unm",e),e=this._addPixelParameter("debugKey1","dk1",e),e=this._addPixelParameter("debugKey2","dk2",e),e=this._addPixelParameter("order","order",e),this.pixel=f.template(e)},_addPixelParameter:function(e,t,i){return(this.get(e)||0===this.get(e)||!1===this.get(e))&&(i+="&"+t+"="+this.get(e)),i},getImpressionPixel:function(){this.get("player.isFire99")},_getSchedule:function(e,t,i){return{roll_type:e,url:this.get("player.urls.vpaidLocation"),volume:"on"===this.get("volume")?100:0,mute:"on"!==this.get("volume"),oid:this.get("originId"),mfp:this.get("mfp"),sortOrderType:this.get("sortOrderType"),ad_parameters:JSON.stringify(this.get("demandConfig")),pubid:t,tagid:i,defaultTagTimeout:this.get("defaultTagTimeout"),totaltimeout:this.get("totalTimeout"),noaop:this.get("noaop"),skip_vast:!0}},_handleABTest:function(){if(this.get("abTest")&&this.get("pixels.startWithABT.isFire")){window.cmTag.customDataForTest.startWithABT=!0;var e={debug:"pn:!sqg:!torgn:"+(window.performance.timeOrigin?window.performance.timeOrigin:"")+"!ts:"+Date.now()};f.firePixel(this.getPixel("pixels.startWithABT"),"AB Test started",e)}},_handleLiteUnitPixels:function(){f.firePixel(this.getPixel("pixels.unitLoaded"),"Unit loaded from lite unit",{mntl:this.get("preset.level")}),f.firePixel(this.getPixel("pixels.unitLoadedWithFill"),"Unit loaded from lite unit with fill")},_processPushArray:function(){var e=this.get("pushedArr")||[];"FEED_MANAGER"!==this.get("unitType")&&"INLINE_FEED"!==this.get("unitType")&&"MSN_WIDGET"!==this.get("unitType")&&"WIDGET_ITEM"!==this.get("unitType")||this._setFeedManagerSubType(e);var t={};if(e)for(var i in e.forEach((function(e){var i=Object.keys(e)[0];t[i]||(t[i]=[]),t[i].push(e[i])})),t){var n=t[i],r=this.get(i);r&&n.push(r);var o=n.sort().join("!");this.set(i,o)}},_setFeedManagerSubType:function(e){var t=this.get("stickyCard.isActive"),i=this.get("detachToSlider.isDetachBelow"),n=this.get("detachToSlider.isDetachAbove"),r=this.get("detachToSlider.isStartFromSlider"),o=this.get("detachToSlider.isDetachToSlider"),s="ufm";t||r||o?t||!r||o?t||r||!o?!t&&r&&o?s+="_vD":t&&i&&!n?s+="_vE":t&&!i&&n?s+="_vF":t&&i&&n&&(s+="_vG"):s+="_vC":s+="_vB":s+="_vA",e.push({abTest:s})},_removeSoundOnHover:function(){var e,t=this.get("wurfl.browser.name").toLowerCase(),i=this.get("wurfl.browser.version"),n=this.get("noSoundBrowsers");n&&n[t]&&(e=n[t].minVersion),i>=e&&this.set("volume","off")},setStorage:function(e,t){this.storage[e]=t},getStorage:function(e){return this.storage[e]},setNextAd:function(e){this.setStorage("nextAd",e)},getNextAd:function(){var e=this.getStorage("nextAd");return e&&(this.log.info("NEXT AD TYPE = "+parseInt(e.adData.requiredViewability?"1":"0"),e),e.isUsed=!0),this.setStorage("nextAd",void 0),setTimeout(this.set.bind(this,"hasReadyAd",!1),0),e},getNextAdRv:function(){var e=this.getStorage("nextAd");if(e)return e.adData.requiredViewability},peekNextAd:function(){return this.getStorage("nextAd")},_bindEvents:function(){this.on("change:getAdState",this._onAdImpression)},_onAdImpression:function(){"gotAd"!==this.get("getAdState")||this._gotAd||(this.log.info("Triggering filledImpression event."),r().trigger("filledImpression",{lineItemId:this.get("lineItemId"),placement:this.get("placement"),redId:this.get("redId")}),this._gotAd=!0)},_setUrlParameters:function(){for(var e,t,i,n=this._getWindow(),r=n.location.href.slice(n.location.href.indexOf("?")+1).split("&"),o=0;o<r.length;o++)0===(t=(e=r[o].split("="))[0]).indexOf("cm_")&&(t=t.slice(3),i=decodeURIComponent(e[1]),this.set(t,i))},_getWindow:function(){var e=this.get("isStayInIframe"),t=this.get("iframeData");return!0===e&&f.isInFriendlyIframe(t)||!f.getTopWindow?window:f.getTopWindow()},_getPresets:function(e){var t={strongerThenSetByCon:[],weakerThenSetByCon:[]},i=this.get("isMobile")?"Mobile":"Desktop";for(var n in this.get("preset")){var r=e.getPreset({key:n,value:this.get("preset.".concat(n)),unitType:this.get("unitName"),platform:i});r&&(r.strength>100?t.strongerThenSetByCon.push(r):t.weakerThenSetByCon.push(r))}return t.strongerThenSetByCon=f.sortBy(t.strongerThenSetByCon,"strength"),t.weakerThenSetByCon=f.sortBy(t.weakerThenSetByCon,"strength"),t},increaseCounter:function(e){var t=this.get(e);t?t++:t=1,this.set(e,t)},decreaseCounter:function(e){var t=this.get(e);!t||t<=0||(t--,this.set(e,t))},_parseFrameType:function(){var e=u().FRAME_TYPE.plainPage;void 0!==window.taboolaMobile?e=u().FRAME_TYPE.inApp:window.TRC&&window.TRC.isAMP?e=u().FRAME_TYPE.amp:f.isInIframe(this.get("iframeData"))&&(e=f.isInFriendlyIframe(this.get("iframeData"))?u().FRAME_TYPE.friendlyIframe:u().FRAME_TYPE.nonFriendlyIframe),this.set("frameType",e),this.set("player.settings.frameType",e)},_getSettingsByConditions:function(){var e={preset:{},settings:{}},t=this.get("settingsByConditions");if(t&&t.length>0)for(var i=0;i<t.length;i++){var n=t[i].conditions,r=t[i].settings;if(this._checkConditions(n))for(var o in r)-1!==o.indexOf("preset")?e.preset[o]=r[o]:e.settings[o]=r[o]}return e},_checkConditions:function(e){for(var t=!0,i=0;i<e.length;i++)if(e[i].val&&"function"==typeof e[i].val){var n=e[i].val(this);this.get(e[i].key)!==n&&(t=!1)}else this.get(e[i].key)!==e[i].val&&(t=!1);return t},fireUnitDelayedPixel:function(){f.firePixel(this.getPixel("pixels.unitDelayed"),"unit delayed")},fireUnitLoadAfterDelayPixel:function(){f.firePixel(this.getPixel("pixels.unitLoadAfterDelay"),"unit delayed")},isLoadcomponent:function(e,t){return this.get("displayFiller."+t)===e},appendArray:function(e,t,i){var n=this.get(e);f.isArray(n)||(n=[]),i&&n.includes(t)||(n.push(t),this.set(e,n))},handleAutoPlayData:function(e){this.log.info("autoplayDetector returned",e),this.set("AutoPlayDetectorData",e),e&&e.unmuted&&e.unmuted.supported?(this.set("volume",this.volume),this.set("autoplaySoundOn",!0)):(this.set("volume","off"),this.set("autoplaySoundOn",!1)),this.log.info("Unit set volume to: ",this.get("volume"))},_setStickyCardParams:function(){this.set("detachToSlider.isDetachAbove",!1),this.set("detachToSlider.isDetachBelow",!0),this.set("detachToSlider.isDetachToSlider",!0),this.set("detachToSlider.isStartFromSlider",!1),this.set("animation.detach",this.get("stickyCard.detachAnimationTime"))},_setCrossUnitCommunication:function(){if(this.get("isUseCrossUnitCommunication")){if(0===document.querySelectorAll("._cm-communication-input").length){var e=document.createElement("div");e.className="_cm-communication-input",e.setAttribute("data-unit-info",""),document.querySelector("body").appendChild(e)}this._observeCrossUnitCommunication()}},_observeCrossUnitCommunication:function(){if(this.get("isObserveCrossUnitCommunication")){var e=document.querySelector("._cm-communication-input");this.crossUnitCommunicatioObserver=new MutationObserver(this._updateCrossUnitData.bind(this)),this.crossUnitCommunicatioObserver.observe(e,{attributes:!0,childList:!1,subtree:!1}),this.on("closeState:".concat(p().closeState.terminate),this._stopCrossUnitCommunicationObserver),this._updateCrossUnitData()}},_updateCrossUnitCommunication:function(e){this.get("isUseCrossUnitCommunication")&&this.get("isUpdateCrossUnitCommunication")&&document.querySelector("._cm-communication-input").setAttribute("data-cross-unit-info",JSON.stringify(e))},_updateCrossUnitData:function(e,t){var i=document.querySelector("._cm-communication-input").dataset.crossUnitInfo;i&&i.unit!==this.get("unitType")&&this.set("crossUnitInfo",JSON.parse(i))},_stopCrossUnitCommunicationObserver:function(){this.crossUnitCommunicatioObserver.disconnect()},fireCancelGetAdOnEligibilityLost:function(){f.firePixel(this.getPixel("pixels.cancelGetAdOnEligibilityLost"),"cancel GetAd on EligibilityLost")},_changeAnyToZeroInPredictors:function(){var e=this,t=this.get("predictors");t&&(Object.keys(t).forEach((function(i){var n=t[i].predictPoints,r=t[i].predictPoint,o=t[i].allowedPredictPoints;n&&(t[i].predictPoints=e._validateAndChangePredictPointsIfAny(n)),o&&(t[i].allowedPredictPoints=e._validateAndChangePredictPointsIfAny(o)),r&&(t[i].predictPoint=e._validateAndChangePredictPointsIfAny(r))})),this.set("predictors",{}),this.set("predictors",t))},_validateAndChangePredictPointsIfAny:function(e){return"string"==typeof e&&"any"===e.toLowerCase()?0:e},_decideSuperSlider:function(){this.get("detachToSlider.isStartFromSlider")&&this.set("detachToSlider.isDetachToSlider",!0)}}),g=i(1999),y=m.extend({defaults:o.default.extend(!0,{},m.prototype.defaults,{contentLoadType:"content",category:"travel",isPlaylist:!1,secondsBW:17,isMultiAd:!0,contentCallback:function(){},pixels:{D2DFallback:{id:31468623,type:5,isFire:!0}},player:{urls:{contentLocation:"{{urls.base}}/content{{player.versions.content}}.js",contentImagesLocation:"{{player.urls.contentVideosLocation}}/img"},settings:{queue_size:6,max_ready_vpaid:3,mprdct:.025},playlist:[]},components:{D2DFallbackView:{location:"//15.{{baseReportD}}/WhiteLabelBidRequestHandlerServlet",width:0,height:0},ClickTrough:{isActive:!1}}}),initialize:function(){m.prototype.initialize.call(this),"mrss"===this.get("contentLoadType")?o.default.ajax({url:this.get("player.urls.contentLocation"),dataType:"xml",success:this._onMrssLoad.bind(this)}):"direct"===this.get("contentLoadType")?this.set("player.playlist",[{id:0,title:"",link:"",url:this.get("player.urls.contentLocation")||this.get("pVideoUrl"),type:"video/mp4",image:""}]):(window.category=this.get("category"),g.loadJs(this.get("player.urls.contentLocation"),this._onContentLoad.bind(this))),this.set("pubId",this.get("preroll.pubId")),this.set("pubTagId",this.get("preroll.pubTagId"))},_onMrssLoad:function(e){var t=[];(0,o.default)(e).find("item").each((function(e,i){i=(0,o.default)(i);var n={};n.id=e,n.title=i.find("title").text(),n.link=i.find("link").text(),n.url=i.find("media\\:content,content").attr("url"),n.type=i.find("media\\:content,content").attr("type"),n.image=i.find("media\\:thumbnail,thumbnail").attr("url"),t.push(n)})),this.set("player.playlist",t)},_onContentLoad:function(){window.playlist.forEach((function(e,t,i){i[t].image=this.get("player.urls.contentImagesLocation")+"/"+e.image,i[t].title=e.title.replace(/([A-Z])/g,"$1").replace(/^./,(function(e){return e.toUpperCase()})),i[t].url=this.get("player.urls.contentVideosLocation")+"/"+i[t].filename,i[t].name=i[t].filename,i[t].type="video/mp4"}),this),this.set("player.playlist",window.playlist)},getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("preroll.pubId"),this.get("preroll.pubTagId"))),e.push(this._getSchedule("mid-roll",this.get("midroll.pubId"),this.get("midroll.pubTagId"))),e.push(this._getSchedule("post-roll",this.get("postroll.pubId"),this.get("postroll.pubTagId"))),e}}),v=(i(1999),y.extend({initialize:function(){this.setSecuredPVideoUrl(),y.prototype.initialize.call(this)},setSecuredPVideoUrl:function(){var e=this.get("pVideoUrl");e&&(e=e.replace("http://","//"),this.set("pVideoUrl",e))}}))},8542:function(e,t,i){"use strict";i(9288);var n=i(9057),r=i(6940);i(1999);t.Z=r.Z.extend({defaults:n.default.extend(!0,{},r.Z.prototype.defaults,{adsPerClip:5,appendType:"beforeend",aucDast:"0",contentLoaded:!1,contentPlaylist:null,isPlayOnHover:!1,isSkipExpand:!1,isViewable:!1,parentSelector:"",playerType:"direct",secondsToAd:"3",tags:"",viewPercent:20,withAdvertisementText:!1,adTitle:"",defaultTagTimeout:40,mfp:2,timeBetweenAds:0,volume:"off",detach:{onBackToView:"return"},multiUnitManager:{isActive:!0},components:{D2DFallbackView:{pubId:127968,pubTagId:756668,height:"{{dimensions.minHeight}}",width:"{{dimensions.width}}"},CloseButtonView:{hasCloseButton:!1,delay:1500},OptOut:{hasOptOut:!0,pubId:89238,pubTagId:830927},BrandLogo:{hasBrandLogo:!1,logoLander:"//infinitevid.com",fallBackClickUrl:"//clickus.{{baseReportD}}/st",imageSrc:"{{urls.base}}/infinitevid_80x25_2.png",style:{width:80,height:25,"border-color":"red"}},PosterView:{isActive:!0},ClickBlocker:{isActive:!1,blockPercent:{vertical:.1,horizontal:.02}}},player:{hasAdControls:!1,urls:{contentLocation:0}}})})},1875:function(e,t,i){"use strict";i(9288);var n=i(9057),r=i(6940);i(1999);t.Z=r.Z.extend({defaults:n.default.extend(!0,{},r.Z.prototype.defaults,{adsPerClip:5,appendType:"beforeend",aucDast:"0",contentLoaded:!1,contentPlaylist:null,isPlayOnHover:!1,isSkipExpand:!1,isViewable:!1,parentSelector:"",playerType:"direct",secondsToAd:"3",tags:"",viewPercent:20,withAdvertisementText:!1,adTitle:"",defaultTagTimeout:60,mfp:2,timeBetweenAds:10,volume:"off",detach:{onBackToView:"return"},multiUnitManager:{isActive:!0},components:{D2DFallbackView:{pubId:127968,pubTagId:756668,height:"{{dimensions.minHeight}}",width:"{{dimensions.width}}"},CloseButtonView:{hasCloseButton:!1,delay:1500},OptOut:{hasOptOut:!0,pubId:89238,pubTagId:830927},BrandLogo:{hasBrandLogo:!1,logoLander:"//infinitevid.com",fallBackClickUrl:"//clickus.{{baseReportD}}/st",imageSrc:"{{urls.base}}/infinitevid_80x25_2.png",style:{width:80,height:25,"border-color":"red"}},PosterView:{isActive:!0},ClickBlocker:{isActive:!1,blockPercent:{vertical:.1,horizontal:.02}}},player:{hasAdControls:!1,urls:{contentLocation:0}}})})},2023:function(e,t,i){"use strict";i.r(t);t.default='<div class="_cm-timer-circle"> <div class="_cm-timer-mask _cm-timer-full"> <div class="_cm-timer-fill"></div> </div> <div class="_cm-timer-mask _cm-timer-half"> <div class="_cm-timer-fill"></div> <div class="_cm-timer-fill _cm-timer-fix"></div> </div> </div> <div class="_cm-timer-inset"> <span></span> </div>'},9644:function(e){e.exports=function(e){function t(e){delete installedChunks[e]}function i(e){var t=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.src=p.p+"hot_updater/hot-update.js",t.appendChild(i)}function n(){return new Promise((function(e,t){if("undefined"==typeof XMLHttpRequest)return t(new Error("No browser support"));try{var i=new XMLHttpRequest,n=p.p+"hot_updater/hot-update.json";i.open("GET",n,!0),i.timeout=1e4,i.send(null)}catch(e){return t(e)}i.onreadystatechange=function(){if(4===i.readyState)if(0===i.status)t(new Error("Manifest request to "+n+" timed out."));else if(404===i.status)e();else if(200!==i.status&&304!==i.status)t(new Error("Manifest request to "+n+" failed."));else{try{var r=JSON.parse(i.responseText)}catch(e){return void t(e)}e(r)}}}))}function r(e){var t=I[e];if(!t)return p;var i=function(i){return t.hot.active?(I[i]?I[i].parents.indexOf(e)<0&&I[i].parents.push(e):(T=[e],m=i),t.children.indexOf(i)<0&&t.children.push(i)):(console.warn("[HMR] unexpected require("+i+") from disposed module "+e),T=[]),p(i)};for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&"e"!==n&&Object.defineProperty(i,n,function(e){return{configurable:!0,enumerable:!0,get:function(){return p[e]},set:function(t){p[e]=t}}}(n));return i.e=function(e){function t(){C--,"prepare"===A&&(k[e]||d(e),0===C&&0===E&&u())}return"ready"===A&&s("prepare"),C++,p.e(e).then(t,(function(e){throw t(),e}))},i}function o(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:m!==e,active:!0,accept:function(e,i){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._acceptedDependencies[e[n]]=i||function(){};else t._acceptedDependencies[e]=i||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._declinedDependencies[e[i]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var i=t._disposeHandlers.indexOf(e);i>=0&&t._disposeHandlers.splice(i,1)},check:l,apply:h,status:function(e){if(!e)return A;S.push(e)},addStatusHandler:function(e){S.push(e)},removeStatusHandler:function(e){var t=S.indexOf(e);t>=0&&S.splice(t,1)},data:w[e]};return m=void 0,t}function s(e){A=e;for(var t=0;t<S.length;t++)S[t].call(null,e)}function a(e){return+e+""===e?+e:e}function l(e){if("idle"!==A)throw new Error("check() is only allowed in idle status");return b=e,s("check"),n().then((function(e){if(!e)return s("idle"),null;O={},k={},D=e.c,v=e.h,s("prepare");var t=new Promise((function(e,t){g={resolve:e,reject:t}}));return y={},d(0),"prepare"===A&&0===C&&0===E&&u(),t}))}function c(e,t){if(D[e]&&O[e]){for(var i in O[e]=!1,t)Object.prototype.hasOwnProperty.call(t,i)&&(y[i]=t[i]);0==--E&&0===C&&u()}}function d(e){D[e]?(O[e]=!0,E++,i(e)):k[e]=!0}function u(){s("ready");var e=g;if(g=null,e)if(b)h(b).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var i in y)Object.prototype.hasOwnProperty.call(y,i)&&t.push(a(i));e.resolve(t)}}function h(i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.indexOf(n)<0&&e.push(n)}}if("ready"!==A)throw new Error("apply() is only allowed in ready status");i=i||{};var r,o,l,c,d,u={},h=[],f={},m=function(){console.warn("[HMR] unexpected require("+b.moduleId+") to disposed module")};for(var g in y)if(Object.prototype.hasOwnProperty.call(y,g)){var b;d=a(g),b=y[g]?function(e){for(var t=[e],i={},r=t.slice().map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),s=o.id,a=o.chain;if((c=I[s])&&!c.hot._selfAccepted){if(c.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:s};if(c.hot._main)return{type:"unaccepted",chain:a,moduleId:s};for(var l=0;l<c.parents.length;l++){var d=c.parents[l],u=I[d];if(u){if(u.hot._declinedDependencies[s])return{type:"declined",chain:a.concat([d]),moduleId:s,parentId:d};t.indexOf(d)>=0||(u.hot._acceptedDependencies[s]?(i[d]||(i[d]=[]),n(i[d],[s])):(delete i[d],t.push(d),r.push({chain:a.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}(d):{type:"disposed",moduleId:g};var P=!1,S=!1,E=!1,C="";switch(b.chain&&(C="\nUpdate propagation: "+b.chain.join(" -> ")),b.type){case"self-declined":i.onDeclined&&i.onDeclined(b),i.ignoreDeclined||(P=new Error("Aborted because of self decline: "+b.moduleId+C));break;case"declined":i.onDeclined&&i.onDeclined(b),i.ignoreDeclined||(P=new Error("Aborted because of declined dependency: "+b.moduleId+" in "+b.parentId+C));break;case"unaccepted":i.onUnaccepted&&i.onUnaccepted(b),i.ignoreUnaccepted||(P=new Error("Aborted because "+d+" is not accepted"+C));break;case"accepted":i.onAccepted&&i.onAccepted(b),S=!0;break;case"disposed":i.onDisposed&&i.onDisposed(b),E=!0;break;default:throw new Error("Unexception type "+b.type)}if(P)return s("abort"),Promise.reject(P);if(S)for(d in f[d]=y[d],n(h,b.outdatedModules),b.outdatedDependencies)Object.prototype.hasOwnProperty.call(b.outdatedDependencies,d)&&(u[d]||(u[d]=[]),n(u[d],b.outdatedDependencies[d]));E&&(n(h,[b.moduleId]),f[d]=m)}var k,O,R=[];for(o=0;o<h.length;o++)d=h[o],I[d]&&I[d].hot._selfAccepted&&R.push({module:d,errorHandler:I[d].hot._selfAccepted});s("dispose"),Object.keys(D).forEach((function(e){!1===D[e]&&t(e)}));for(var x,B=h.slice();B.length>0;)if(d=B.pop(),c=I[d]){var V={},F=c.hot._disposeHandlers;for(l=0;l<F.length;l++)(r=F[l])(V);for(w[d]=V,c.hot.active=!1,delete I[d],l=0;l<c.children.length;l++){var M=I[c.children[l]];M&&(x=M.parents.indexOf(d))>=0&&M.parents.splice(x,1)}}for(d in u)if(Object.prototype.hasOwnProperty.call(u,d)&&(c=I[d]))for(O=u[d],l=0;l<O.length;l++)k=O[l],(x=c.children.indexOf(k))>=0&&c.children.splice(x,1);for(d in s("apply"),_=v,f)Object.prototype.hasOwnProperty.call(f,d)&&(e[d]=f[d]);var N=null;for(d in u)if(Object.prototype.hasOwnProperty.call(u,d)){c=I[d],O=u[d];var L=[];for(o=0;o<O.length;o++)k=O[o],r=c.hot._acceptedDependencies[k],L.indexOf(r)>=0||L.push(r);for(o=0;o<L.length;o++){r=L[o];try{r(O)}catch(e){i.onErrored&&i.onErrored({type:"accept-errored",moduleId:d,dependencyId:O[o],error:e}),i.ignoreErrored||N||(N=e)}}}for(o=0;o<R.length;o++){var j=R[o];d=j.module,T=[d];try{p(d)}catch(e){if("function"==typeof j.errorHandler)try{j.errorHandler(e)}catch(t){i.onErrored&&i.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:t,orginalError:e}),i.ignoreErrored||N||(N=t),N||(N=e)}else i.onErrored&&i.onErrored({type:"self-accept-errored",moduleId:d,error:e}),i.ignoreErrored||N||(N=e)}}return N?(s("fail"),Promise.reject(N)):(s("idle"),new Promise((function(e){e(h)})))}function p(t){if(I[t])return I[t].exports;var i=I[t]={i:t,l:!1,exports:{},hot:o(t),parents:(P=T,T=[],P),children:[]};return e[t].call(i.exports,i,i.exports,r(t)),i.l=!0,i.exports}var f=this.webpackHotUpdate;this.webpackHotUpdate=function(e,t){c(e,t),f&&f(e,t)};var m,g,y,v,b=!0,_="59b7cbaf38aa497b79b2",w={},T=[],P=[],S=[],A="idle",E=0,C=0,k={},O={},D={},I={};return p.m=e,p.c=I,p.i=function(e){return e},p.d=function(e,t,i){p.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="",p.h=function(){return _},r(0)(p.s=0)}({"./package.json":function(e,t){e.exports={name:"oppsula",version:"1.4.3",description:"React Webpack Babel Starter Kit",main:"dist/oppsula.js",scripts:{build:"webpack --config webpack.config.js --devtool false -p","build-oppsula":"webpack --config webpack.config.js",start:"webpack-dev-server --progress --profile --colors --hot --https",lint:"eslint --ext js --ext jsx src || exit 0",dev:"webpack-dev-server  --config webpack.config.js  --hot --https",test:"export NODE_ENV=test && jest --watchAll",uploadToCdn:"node ./buildComands/uplod-to-s3.js"},repository:{type:"git",url:"https://github.com/alicoding/react-webpack-babel"},author:"Ali Al Dallal",license:"MIT",homepage:"https://github.com/alicoding/react-webpack-babel#readme",dependencies:{"babel-preset-es2015":"^6.24.1","base-64":"^0.1.0",bulma:"^0.6.1",child_process:"^1.0.2","fs-extra":"^10.0.0","gulp-s3-upload":"^1.7.0","normalize.css":"^7.0.0","string-replace-webpack-plugin":"^0.1.3"},devDependencies:{"babel-cli":"^6.26.0","babel-core":"^6.26.0","babel-jest":"^21.2.0","babel-loader":"^7.1.2","babel-plugin-module-resolver":"^3.0.0","babel-plugin-transform-class-properties":"^6.24.1","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-preset-react":"^6.24.1","babel-runtime":"^6.26.0",eslint:"^4.11.0","eslint-plugin-jest":"^21.3.2","eslint-plugin-react":"^7.5.1","extract-text-webpack-plugin":"^3.0.2","file-loader":"^1.1.5",gulp:"^4.0.2","html-webpack-plugin":"^2.30.1",jest:"^21.2.1",jsdom:"^9.12.0",loglevel:"^1.6.0","url-loader":"^0.6.2",webpack:"^2.7.0","webpack-cleanup-plugin":"^0.5.1","webpack-dev-server":"^2.11.2"},jest:{verbose:!0,bail:!0,collectCoverage:!0,coverageDirectory:"coverage",moduleNameMapper:{"\\.(jpe?g|png|gif|eot|otf|webp|svg|ttf|woff2?|mp[34]|webm|wav|m4a|aac|oga)$":"<rootDir>/__mocks__/fileMock.js","\\.(css|less|s[ac]ss|styl)$":"<rootDir>/__mocks__/styleMock.js"},globals:{window:{}},moduleFileExtensions:["js","jsx"],moduleDirectories:["node_modules"]}}},"./src/consts.js":function(e,t,i){"use strict";e.exports={KIBANA_URL:"vidanalytics.taboola.com/putes/units-ads-analytics",SERVICES:{UNIT:"unit",PLAYER:"player"},EXTRA_PARAMS_EXCEPTIONS:["vidCurrentTime"],OPPS_PARAMETERS_MAPING:{player:{pstn:"pstn",mob:"isMobile",pv:"playerVersion",fdScore:"fdScore",abt:"ab_test",agl:"preset.level",su:"subUnitType",dtsvrRoundTripAverageDuration:"performance.dtsvrRoundTripAverageDuration",sts:"playerRepeatCount",ft:"frameType",be:"playerHasRvInQ",pt:"ab_test",width:"width",height:"height"},unit:{pstn:"pstn",mob:"isMobile",unv:"unit_version",unit_type:"unit_type",fdScore:"fdScore",abt:"abTest",agl:"preset.level",awr:"performance.dtsvrRoundTripAverageDuration",pm:"performance.performanceMeasurment",su:"subUnitType",ft:"frameType",mp:"modifiedPlacement",vstt:"isInTab",cmDast:"cmDast"}},MAX_ES_STRING_LENGTH:32766}},"./src/index.js":function(e,t,i){"use strict";var n=i("./src/oppsula.js");try{if(window.cmTag){var r=window.cmTag.config.ms||{};r.oppsula=r.oppsula||{},r.oppsula["1.4.3"]=n,window.cmTag.set("ms",r)}}catch(e){}try{window.TRC&&(window.TRC.oppsula=window.TRC.oppsula||{},window.TRC.oppsula["1.4.3"]=n)}catch(e){}e.exports={}},"./src/oppsula.js":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i("./src/requestManager.js"),s=i("./src/store.js"),a=i("./src/utils.js"),l=i("./src/consts.js"),c=i("./package.json").version,d=function(){function e(t,i){n(this,e);var r=this._getRedId(t)||"red_id";this._initGlobalInstances();var l=window.TRC.oppsulaInstances[c],d=this;if(l.hasOwnProperty(r)&&void 0!==l[r])(d=l[r]).store.setModel(i,t);else{var u=t.get("player.urls.oppsRequest")||t.get("opps_base_path")+"/OpportunityServlet",h=t.get("player.urls.nonBllboppsRequest")||t.get("non_bllb_opps_base_path")+"/OpportunityServlet",p=t.get("sendBeacon");d.redId=r,d.opps=[],d.fireOppsInterval=null,d.stopped=!1,d.unloadCallbacks=[],d.fireOppsCallbacks=[],d.store=new s,d.unloadEventName=a.isOnIOS()?"pagehide":"beforeunload",d._setFireOppsBeforeUnload(),d.store.setModel(i,t),d.oppRequest=new o(u,p,d.store.get(i,"psthdrs")),d.nonBllbOppRequest=new o(h,p,d.store.get(i,"psthdrs")),l[r]=d}return d._setFireOppsInterval(i),l[r]}return r(e,[{key:"_initGlobalInstances",value:function(){window.TRC.hasOwnProperty("oppsulaInstances")||(window.TRC.oppsulaInstances={}),window.TRC.oppsulaInstances.hasOwnProperty(c)||(window.TRC.oppsulaInstances[c]={})}},{key:"registerCallback",value:function(e,t){this[e].push(t)}},{key:"unRegisterCallback",value:function(e,t){this[e].splice(this[e].indexOf(t),1)}},{key:"_activateCallbacks",value:function(e){for(var t=0;t<this[e].length;t++){var i=this[e][t];this[e].splice(this[e].indexOf(i),1),i()}}},{key:"_getRedId",value:function(e){if(e)return e.get("redId")||e.get("red_id")}},{key:"_addAbTests",value:function(e,t){return(e.requiredViewabilityDrawn?"!ronrv":"")+(e.moatSampling?"!mtsmp":"")+(this.store.get(t,"isReadMoreOnPage")?"!rdmr":"")}},{key:"_getDebugDataStr",value:function(e,t){if(t.setDebugDataFunc)return t.setDebugDataFunc();var i=this.store.get("debugDataFunc");return i?i():t.vpaidWrapperData&&t.vpaidWrapperData.debugData?t.vpaidWrapperData.debugData:this.store.get(e,"debugStr")||void 0}},{key:"_addExtraParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];for(var i in e)l.EXTRA_PARAMS_EXCEPTIONS.indexOf(i)<0&&(t[i]=e[i])}},{key:"_addCmTagParams",value:function(e,t){var i=this.store.get(e,"oppsQS")||{};Object.assign(t,i)}},{key:"_addDelayedParams",value:function(e,t,i,n){var r=this._getDelayedParams(t,i,n)||{};Object.assign(e,r)}},{key:"_getDelayedParams",value:function(e,t,i){var n=l.OPPS_PARAMETERS_MAPING[e],r=this.store.get(e,n.width),o=this.store.get(e,n.height);return{"auc-dast":i.AUC_DAST||this.store.get(e,n.cmDast)||void 0,sts:i.STS||this.store.get(e,n.sts),wp:i.WP,vpd:t.pubId||i.VPD,vptd:t.tagId||i.VPTD,vmt:(t.isRon?1:0)||i.VMT||0,pt:a.crc32(this.store.get(e,n.pt)||999),w:r||void 0,h:o||void 0,rv:t.requiredViewability}}},{key:"buildOppsData",value:function(e,t,i){var n=l.OPPS_PARAMETERS_MAPING[e],r=i.tagItem,o=i.debugData?i.debugData:i&&i.extraData?i.extraData.debugData:this._getDebugDataStr(e,r),s=r.lineItemStats,c=i.extraData||{},d=i.playerParams||{},u=r.vpaidWrapperData||(r.vpaidWrapper&&r.vpaidWrapper.tag?r.vpaidWrapper.tag.vpaidWrapperData:void 0),h={tms:Date.now(),st:a.getStreamType(r.rollType),sts:this.store.get(e,n.sts),rs:r.sequenceId,os:1*r.waterfallTagId+1,d:(new Date).getTime()-r.created,rst:t,dast:r.vidDast||r.dast,pstn:this.store.get(e,n.pstn)||1,dp:a.crc32(r.dp),mob:a.boolToInt(this.store.get(e,n.mob)),vstt:e===l.SERVICES.UNIT?this.store.get(e,"vstt")?1:0:a.boolToInt(!document.hidden),unv:this.store.get(e,n.unv),unt:a.crc32(this.store.get(e,n.unit_type)),abt:""+this.store.get(e,n.abt)+this._addAbTests(r,e),frd:this.store.get(e,n.fdScore),agl:this.store.get(e,n.agl),rp:u&&u.vastPrice,mty:r.mty||u&&u.mediatype,fv_t:s&&s.tries,fv_c:s&&s.conversions,fv_f:s&&s.fails,fv_fr:s&&s.failsRow,awr:this.store.get(e,n.awr),pm:this.store.get(e,n.pm),dbg:o,su:this.store.get(e,n.su),pdast:i.playerDAST,extpvid:window.TRCImpl&&window.TRCImpl.external_page_view,vpd:r.pubId,vptd:r.tagId,pv:this.store.get(e,n.pv)||999,vmt:Number(r.isRon)||0,ft:this.store.get(e,n.ft),ttv:r.timeToVimp,bovpv:r.bovpv,bovpg:r.bovpg,be:this.store.get(e,n.be)?1:0,pap:void 0!==r.pap?r.pap:"",rv:r.requiredViewability,mp:this.store.get(e,n.mp),sp:i.activeData?i.activeData.sp:void 0,prdid:void 0!==i.predictorId?i.predictorId:void 0};return this._addCmTagParams(e,h),this._addExtraParams(c,h),this._addDelayedParams(h,e,r,d),h}},{key:"send",value:function(e,t,i){if(!this.stopped){var n=this.buildOppsData(e,t,i);this._isBillableEvent(e,t)||!this.store.get(e,"cmbopps")?this.oppRequest.send(a.stringify([n]),t):this.opps.push(n)}}},{key:"_setFireOppsInterval",value:function(e){this.stopped||this.fireOppsInterval||(this.fireOpps=this._fireOpps.bind(this),this.fireOppsInterval=setInterval(this.fireOpps,this.store.get(e,"timbtopps")))}},{key:"destroy",value:function(){this.stopped||(this._activateCallbacks("unloadCallbacks"),window.removeEventListener(this.unloadEventName,this._destroy),this.fireOppsInterval=clearInterval(this.fireOppsInterval),this._fireOpps(),this.stopped=!0,this.store&&this.store.destroy(),this.store=this.fireOpps=this._destroy=void 0,window.TRC.oppsulaInstances[c][this.redId]=void 0)}},{key:"_fireOpps",value:function(){this.stopped||(this._activateCallbacks("fireOppsCallbacks"),this.opps.length>0&&this.nonBllbOppRequest.send(a.stringify(this.opps)),this.opps=[])}},{key:"_setFireOppsBeforeUnload",value:function(){this._destroy=this.destroy.bind(this),window.addEventListener(this.unloadEventName,this._destroy)}},{key:"_isBillableEvent",value:function(e,t){return this.store.getBillableEvents(e).indexOf(parseInt(t))>-1}}]),e}();e.exports=d},"./src/requestManager.js":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;n(this,e),this.useSendBeacon=this._isSendBeaconSupported()&&i,this.baseUrl=t,this.useSendBeacon||(this.async=null==o||o,this.withCredentials=null==s||s,this.timeout=a||5e3,this.contentType=r||"application/x-www-form-urlencoded")}return r(e,[{key:"_isSendBeaconSupported",value:function(){return!(!navigator||"function"!=typeof navigator.sendBeacon)}},{key:"_onFail",value:function(){this.gotResponse||(this.gotResponse=!0)}},{key:"send",value:function(e,t){this.useSendBeacon?this._sendBeacon(e,t):this._sendXHR(e,t)}},{key:"_sendBeacon",value:function(e,t){var i=this.baseUrl+(void 0!==t?"?rst="+t:"");navigator.sendBeacon(i,e)}},{key:"_sendXHR",value:function(e,t){if(this.baseUrl){var i=new XMLHttpRequest;return this._setHttpParams(i,e,t),this._setHttpEvents(i),i.send(e),!0}}},{key:"_setHttpParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=this.baseUrl+(void 0!==i?"?rst="+i:"");e.open(t?"POST":"GET",n,!0),e.withCredentials=this.withCredentials,e.setRequestHeader("Content-type",this.contentType),e.async=this.async,e.timeout=this.timeout,e.gotResponse=!1}},{key:"_setHttpEvents",value:function(e){e.addEventListener("error",this._onFail),e.addEventListener("abort",this._onFail),e.addEventListener("timeout",this._onFail),e.addEventListener("readystatechange",(function(e){if(4==this.readyState){if(this.gotResponse)return;this.gotResponse=!0}}))}}]),e}();e.exports=o},"./src/store.js":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=(function(e){e&&e.__esModule}(i("./src/utils.js")),function(){function e(t,i){n(this,e),this.service=i,this.models={},this.data={psthdrs:"application/json",timbtopps:2e3}}return r(e,[{key:"setModel",value:function(e,t){this.models[e]=t}},{key:"get",value:function(e,t){if(t&&this.models.hasOwnProperty(e)){var i=this.models[e].get(t)||void 0;return void 0!==i?i:this._getFromData(t)}}},{key:"getBillableEvents",value:function(e){return(this.get(e,"billableEvents")||[]).concat((this.get(e,"bllblevt")||"").split(",").map((function(e){return parseInt(e)})))}},{key:"_getFromData",value:function(e){return-1===(e=e.toString()).indexOf(".")?this.data[e]:e.split(".").reduce((function(e,t){return e&&e[t]}),this.data)}},{key:"destroy",value:function(){this.models=this.data=void 0}}]),e}());e.exports=o},"./src/utils.js":function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e){return e&&e.__esModule?e:{default:e}}(i("./src/consts.js"));e.exports={getOppsServletBaseUrl:function(e){var t=e.get("ms_data.opps_base_path");return this.setUrlPrefix(t)+(/.*\/$/g.test(t)?"":"/")+"OpportunityServlet"},utf8Encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},crc32:function(e){if(!e||"string"!=typeof e)return 0;var t=void 0,i="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";void 0===t&&(t=0);var n=0;t^=-1;for(var r=0,o=(e=this.utf8Encode(e)).length;r<o;r++)n=255&(t^e.charCodeAt(r)),t=t>>>8^"0x"+i.substr(9*n,8);return-1^t},boolToInt:function(e){return e?1:0},assignWithoutUndefinedValues:function(e,t){for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e},setUrlPrefix:function(e){return"string"!=typeof e||0!==(e=e.replace(/^(http[s]?:|ftp:)/g,"")).indexOf("//")&&(e="//"+e),e},stringify:function(e,t){try{var i=[];return JSON.stringify(e,(function(e,t){if(null!=t&&"object"==(void 0===t?"undefined":n(t))){if(i.indexOf(t)>-1)return;i.push(t)}return t}),t)}catch(e){return""}},fireOpp:function(e){try{(new Image).src=e}catch(e){}},generateGuid:function(e,t){var i=BASE64URICHARS,n=[],r=0;for(t=t||i.length,e=e||22,r=0;r<e;r++)n[r]=i[0|Math.random()*t];return n.join("")},writeToElasticByIndex:function(e,t){var i=new XMLHttpRequest;i.open("POST","//"+r.default.KIBANA_URL,!0);var n={player_id:"123456",created:(new Date).toISOString(),event:e,timestamp:(new Date).toISOString()};Object.assign(n,t),i.send(this.stringify(this.reduceESdataSize(n)))},reduceESdataSize:function(e){return this.objectSizeCalculator(e,!0),e},objectSizeCalculator:function(e,t){var i=[];return function e(o,s,a){var l=0;if(void 0===o)l=0;else if("boolean"==typeof o)l=4;else if("string"==typeof o)t&&o.length>r.default.MAX_ES_STRING_LENGTH&&(o=s[a]="STRING TOO LONG"),l=2*o.length;else if("number"==typeof o)l=8;else if("function"==typeof o)try{l=2*o.toString().length}catch(e){}else if("object"===(void 0===o?"undefined":n(o))&&-1===i.indexOf(o))for(var a in i[i.length]=o,o)l+=8,l+=e(o[a],o,a);return l}(e,e,null)},flattenParams:function(e){var t=[];for(var i in e)t.push(i+"="+e[i]);return t.join("&")},isOnIOS:function(){return navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)},getStreamType:function(e){var t=0,i={"pre-roll":0,preroll:0,"mid-roll":-1,midroll:-1,"post-roll":-2,postroll:-2};return i.hasOwnProperty(e)&&(t=i[e]),t}}},0:function(e,t,i){e.exports=i("./src/index.js")}})},3129:function(e){window,e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}({"./index.js":function(e,t,i){"use strict";var n=i("./options.js"),r=i("./utils.js"),o=function(e,t){if("trc"===n.mcrsrvcsnmspc)try{return window.TRC[e][t]}catch(e){}if("cmTag"===n.mcrsrvcsnmspc)try{return window.cmTag.config.ms[e][t]}catch(e){}return null};e.exports={get:function(e,t,i,s){e=r.cleanServiceName(e),t=t||function(e){return n.serviceDefaultVersion[e]}(e);var a=o(e,t);if(a)i&&i(a);else{var l=document.createElement("script"),c=r.setUrlPrefix(n.base_url);l.async=n.async,l.type="text/javascript",l.src=c+(/.*\/$/g.test(c)?"":"/")+e+"/"+t+"/"+e+".js",l.onload=function(){document.head.removeChild(l);try{i&&i(o(e,t))}catch(e){s&&s()}},l.onerror=function(){document.head.removeChild(l),s&&s()},document.head.appendChild(l)}},init:function(e){for(var t in n)e.hasOwnProperty(t)&&(n[t]=e[t])}}},"./options.js":function(e,t,i){"use strict";e.exports={base_url:"//vidstat.taboola.com/",async:!0,mcrsrvcsnmspc:"trc",serviceDefaultVersion:{oppsula:"1.0.1"}}},"./utils.js":function(e,t,i){"use strict";e.exports={setUrlPrefix:function(e){return"string"!=typeof e||0!==(e=e.replace(/^(http[s]?:|ftp:)/g,"")).indexOf("//")&&(e="//"+e),e},cleanServiceName:function(e){return e.replace(/.js$/,"")}}},0:function(e,t,i){e.exports=i("./index.js")}})},7418:function(e,t,i){var n={"./AdTypeConfig":701,"./AdTypeConfig.js":701,"./AdTypeTranslator":914,"./AdTypeTranslator.js":914,"./Adjacency/DefaultAdjacencyConfig":5449,"./Adjacency/DefaultAdjacencyConfig.js":5449,"./Adjacency/units/AdjacFeedManagerConfig":8699,"./Adjacency/units/AdjacFeedManagerConfig.js":8699,"./Adjacency/units/AdjacencyRecoReelWidgetConfig":256,"./Adjacency/units/AdjacencyRecoReelWidgetConfig.js":256,"./Adjacency/units/AdjacencyWidgetItemConfig":1152,"./Adjacency/units/AdjacencyWidgetItemConfig.js":1152,"./Replayable/DefaultReplayableConfig":7613,"./Replayable/DefaultReplayableConfig.js":7613,"./Replayable/units/ReplayableAdFeedManagerConfig":7723,"./Replayable/units/ReplayableAdFeedManagerConfig.js":7723,"./Replayable/units/ReplayableAdInlineConfig":3353,"./Replayable/units/ReplayableAdInlineConfig.js":3353,"./Replayable/units/ReplayableAdWidgetItemConfig":6333,"./Replayable/units/ReplayableAdWidgetItemConfig.js":6333,"./SingleAd/DefaultSingleAdConfig":7507,"./SingleAd/DefaultSingleAdConfig.js":7507,"./SingleAd/units/SingleAdFeedManagerConfig":9579,"./SingleAd/units/SingleAdFeedManagerConfig.js":9579,"./SingleAd/units/SingleAdInlineConfig":3205,"./SingleAd/units/SingleAdInlineConfig.js":3205,"./SingleAd/units/SingleAdSliderConfig":7642,"./SingleAd/units/SingleAdSliderConfig.js":7642,"./SingleAd/units/SingleAdWidgetItemConfig":6505,"./SingleAd/units/SingleAdWidgetItemConfig.js":6505};function r(e){var t=o(e);return i(t)}function o(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=7418},1999:function(e,t,i){e.exports=function(){var e="1.13.1",t="object"==typeof self&&self.self===self&&self||"object"==typeof i.g&&i.g.global===i.g&&i.g||Function("return this")()||{},n=Array.prototype,r=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,s=n.push,a=n.slice,l=r.toString,c=r.hasOwnProperty,d="undefined"!=typeof ArrayBuffer,u="undefined"!=typeof DataView,h=Array.isArray,p=Object.keys,f=Object.create,m=d&&ArrayBuffer.isView,g=isNaN,y=isFinite,v=!{toString:null}.propertyIsEnumerable("toString"),b=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1;function w(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),n=Array(i),r=0;r<i;r++)n[r]=arguments[r+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var o=Array(t+1);for(r=0;r<t;r++)o[r]=arguments[r];return o[t]=n,e.apply(this,o)}}function T(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function P(e){return null===e}function S(e){return void 0===e}function A(e){return!0===e||!1===e||"[object Boolean]"===l.call(e)}function E(e){return!(!e||1!==e.nodeType)}function C(e){var t="[object "+e+"]";return function(e){return l.call(e)===t}}var k=C("String"),O=C("Number"),D=C("Date"),I=C("RegExp"),R=C("Error"),x=C("Symbol"),B=C("ArrayBuffer"),V=C("Function"),F=t.document&&t.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof F&&(V=function(e){return"function"==typeof e||!1});var M=V,N=C("Object"),L=u&&N(new DataView(new ArrayBuffer(8))),j="undefined"!=typeof Map&&N(new Map),U=C("DataView");function W(e){return null!=e&&M(e.getInt8)&&B(e.buffer)}var H=L?W:U,q=h||C("Array");function G(e,t){return null!=e&&c.call(e,t)}var $=C("Arguments");!function(){$(arguments)||($=function(e){return G(e,"callee")})}();var z=$;function K(e){return!x(e)&&y(e)&&!isNaN(parseFloat(e))}function Y(e){return O(e)&&g(e)}function Q(e){return function(){return e}}function Z(e){return function(t){var i=e(t);return"number"==typeof i&&i>=0&&i<=_}}function X(e){return function(t){return null==t?void 0:t[e]}}var J=X("byteLength"),ee=Z(J),te=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function ie(e){return m?m(e)&&!H(e):ee(e)&&te.test(l.call(e))}var ne=d?ie:Q(!1),re=X("length");function oe(e){for(var t={},i=e.length,n=0;n<i;++n)t[e[n]]=!0;return{contains:function(e){return t[e]},push:function(i){return t[i]=!0,e.push(i)}}}function se(e,t){t=oe(t);var i=b.length,n=e.constructor,o=M(n)&&n.prototype||r,s="constructor";for(G(e,s)&&!t.contains(s)&&t.push(s);i--;)(s=b[i])in e&&e[s]!==o[s]&&!t.contains(s)&&t.push(s)}function ae(e){if(!T(e))return[];if(p)return p(e);var t=[];for(var i in e)G(e,i)&&t.push(i);return v&&se(e,t),t}function le(e){if(null==e)return!0;var t=re(e);return"number"==typeof t&&(q(e)||k(e)||z(e))?0===t:0===re(ae(e))}function ce(e,t){var i=ae(t),n=i.length;if(null==e)return!n;for(var r=Object(e),o=0;o<n;o++){var s=i[o];if(t[s]!==r[s]||!(s in r))return!1}return!0}function de(e){return e instanceof de?e:this instanceof de?void(this._wrapped=e):new de(e)}function ue(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,J(e))}de.VERSION=e,de.prototype.value=function(){return this._wrapped},de.prototype.valueOf=de.prototype.toJSON=de.prototype.value,de.prototype.toString=function(){return String(this._wrapped)};var he="[object DataView]";function pe(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var r=typeof e;return("function"===r||"object"===r||"object"==typeof t)&&fe(e,t,i,n)}function fe(e,t,i,n){e instanceof de&&(e=e._wrapped),t instanceof de&&(t=t._wrapped);var r=l.call(e);if(r!==l.call(t))return!1;if(L&&"[object Object]"==r&&H(e)){if(!H(t))return!1;r=he}switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return o.valueOf.call(e)===o.valueOf.call(t);case"[object ArrayBuffer]":case he:return fe(ue(e),ue(t),i,n)}var s="[object Array]"===r;if(!s&&ne(e)){if(J(e)!==J(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;s=!0}if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,c=t.constructor;if(a!==c&&!(M(a)&&a instanceof a&&M(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}n=n||[];for(var d=(i=i||[]).length;d--;)if(i[d]===e)return n[d]===t;if(i.push(e),n.push(t),s){if((d=e.length)!==t.length)return!1;for(;d--;)if(!pe(e[d],t[d],i,n))return!1}else{var u,h=ae(e);if(d=h.length,ae(t).length!==d)return!1;for(;d--;)if(!G(t,u=h[d])||!pe(e[u],t[u],i,n))return!1}return i.pop(),n.pop(),!0}function me(e,t){return pe(e,t)}function ge(e){if(!T(e))return[];var t=[];for(var i in e)t.push(i);return v&&se(e,t),t}function ye(e){var t=re(e);return function(i){if(null==i)return!1;var n=ge(i);if(re(n))return!1;for(var r=0;r<t;r++)if(!M(i[e[r]]))return!1;return e!==Pe||!M(i[ve])}}var ve="forEach",be="has",_e=["clear","delete"],we=["get",be,"set"],Te=_e.concat(ve,we),Pe=_e.concat(we),Se=["add"].concat(_e,ve,be),Ae=j?ye(Te):C("Map"),Ee=j?ye(Pe):C("WeakMap"),Ce=j?ye(Se):C("Set"),ke=C("WeakSet");function Oe(e){for(var t=ae(e),i=t.length,n=Array(i),r=0;r<i;r++)n[r]=e[t[r]];return n}function De(e){for(var t=ae(e),i=t.length,n=Array(i),r=0;r<i;r++)n[r]=[t[r],e[t[r]]];return n}function Ie(e){for(var t={},i=ae(e),n=0,r=i.length;n<r;n++)t[e[i[n]]]=i[n];return t}function Re(e){var t=[];for(var i in e)M(e[i])&&t.push(i);return t.sort()}function xe(e,t){return function(i){var n=arguments.length;if(t&&(i=Object(i)),n<2||null==i)return i;for(var r=1;r<n;r++)for(var o=arguments[r],s=e(o),a=s.length,l=0;l<a;l++){var c=s[l];t&&void 0!==i[c]||(i[c]=o[c])}return i}}var Be=xe(ge),Ve=xe(ae),Fe=xe(ge,!0);function Me(){return function(){}}function Ne(e){if(!T(e))return{};if(f)return f(e);var t=Me();t.prototype=e;var i=new t;return t.prototype=null,i}function Le(e,t){var i=Ne(e);return t&&Ve(i,t),i}function je(e){return T(e)?q(e)?e.slice():Be({},e):e}function Ue(e,t){return t(e),e}function We(e){return q(e)?e:[e]}function He(e){return de.toPath(e)}function qe(e,t){for(var i=t.length,n=0;n<i;n++){if(null==e)return;e=e[t[n]]}return i?e:void 0}function Ge(e,t,i){var n=qe(e,He(t));return S(n)?i:n}function $e(e,t){for(var i=(t=He(t)).length,n=0;n<i;n++){var r=t[n];if(!G(e,r))return!1;e=e[r]}return!!i}function ze(e){return e}function Ke(e){return e=Ve({},e),function(t){return ce(t,e)}}function Ye(e){return e=He(e),function(t){return qe(t,e)}}function Qe(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 3:return function(i,n,r){return e.call(t,i,n,r)};case 4:return function(i,n,r,o){return e.call(t,i,n,r,o)}}return function(){return e.apply(t,arguments)}}function Ze(e,t,i){return null==e?ze:M(e)?Qe(e,t,i):T(e)&&!q(e)?Ke(e):Ye(e)}function Xe(e,t){return Ze(e,t,1/0)}function Je(e,t,i){return de.iteratee!==Xe?de.iteratee(e,t):Ze(e,t,i)}function et(e,t,i){t=Je(t,i);for(var n=ae(e),r=n.length,o={},s=0;s<r;s++){var a=n[s];o[a]=t(e[a],a,e)}return o}function tt(){}function it(e){return null==e?tt:function(t){return Ge(e,t)}}function nt(e,t,i){var n=Array(Math.max(0,e));t=Qe(t,i,1);for(var r=0;r<e;r++)n[r]=t(r);return n}function rt(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}de.toPath=We,de.iteratee=Xe;var ot=Date.now||function(){return(new Date).getTime()};function st(e){var t=function(t){return e[t]},i="(?:"+ae(e).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(r,t):e}}var at={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},lt=st(at),ct=st(Ie(at)),dt=de.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ut=/(.)^/,ht={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},pt=/\\|'|\r|\n|\u2028|\u2029/g;function ft(e){return"\\"+ht[e]}var mt=/^\s*(\w|\$)+\s*$/;function gt(e,t,i){!t&&i&&(t=i),t=Fe({},t,de.templateSettings);var n=RegExp([(t.escape||ut).source,(t.interpolate||ut).source,(t.evaluate||ut).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(n,(function(t,i,n,s,a){return o+=e.slice(r,a).replace(pt,ft),r=a+t.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),t})),o+="';\n";var s,a=t.variable;if(a){if(!mt.test(a))throw new Error("variable is not a bare identifier: "+a)}else o="with(obj||{}){\n"+o+"}\n",a="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{s=new Function(a,"_",o)}catch(e){throw e.source=o,e}var l=function(e){return s.call(this,e,de)};return l.source="function("+a+"){\n"+o+"}",l}function yt(e,t,i){var n=(t=He(t)).length;if(!n)return M(i)?i.call(e):i;for(var r=0;r<n;r++){var o=null==e?void 0:e[t[r]];void 0===o&&(o=i,r=n),e=M(o)?o.call(e):o}return e}var vt=0;function bt(e){var t=++vt+"";return e?e+t:t}function _t(e){var t=de(e);return t._chain=!0,t}function wt(e,t,i,n,r){if(!(n instanceof t))return e.apply(i,r);var o=Ne(e.prototype),s=e.apply(o,r);return T(s)?s:o}var Tt=w((function(e,t){var i=Tt.placeholder,n=function(){for(var r=0,o=t.length,s=Array(o),a=0;a<o;a++)s[a]=t[a]===i?arguments[r++]:t[a];for(;r<arguments.length;)s.push(arguments[r++]);return wt(e,n,this,this,s)};return n}));Tt.placeholder=de;var Pt=w((function(e,t,i){if(!M(e))throw new TypeError("Bind must be called on a function");var n=w((function(r){return wt(e,n,t,this,i.concat(r))}));return n})),St=Z(re);function At(e,t,i,n){if(n=n||[],t||0===t){if(t<=0)return n.concat(e)}else t=1/0;for(var r=n.length,o=0,s=re(e);o<s;o++){var a=e[o];if(St(a)&&(q(a)||z(a)))if(t>1)At(a,t-1,i,n),r=n.length;else for(var l=0,c=a.length;l<c;)n[r++]=a[l++];else i||(n[r++]=a)}return n}var Et=w((function(e,t){var i=(t=At(t,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=t[i];e[n]=Pt(e[n],e)}return e}));function Ct(e,t){var i=function(n){var r=i.cache,o=""+(t?t.apply(this,arguments):n);return G(r,o)||(r[o]=e.apply(this,arguments)),r[o]};return i.cache={},i}var kt=w((function(e,t,i){return setTimeout((function(){return e.apply(null,i)}),t)})),Ot=Tt(kt,de,1);function Dt(e,t,i){var n,r,o,s,a=0;i||(i={});var l=function(){a=!1===i.leading?0:ot(),n=null,s=e.apply(r,o),n||(r=o=null)},c=function(){var c=ot();a||!1!==i.leading||(a=c);var d=t-(c-a);return r=this,o=arguments,d<=0||d>t?(n&&(clearTimeout(n),n=null),a=c,s=e.apply(r,o),n||(r=o=null)):n||!1===i.trailing||(n=setTimeout(l,d)),s};return c.cancel=function(){clearTimeout(n),a=0,n=r=o=null},c}function It(e,t,i){var n,r,o,s,a,l=function(){var c=ot()-r;t>c?n=setTimeout(l,t-c):(n=null,i||(s=e.apply(a,o)),n||(o=a=null))},c=w((function(c){return a=this,o=c,r=ot(),n||(n=setTimeout(l,t),i&&(s=e.apply(a,o))),s}));return c.cancel=function(){clearTimeout(n),n=o=a=null},c}function Rt(e,t){return Tt(t,e)}function xt(e){return function(){return!e.apply(this,arguments)}}function Bt(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}}function Vt(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function Ft(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}}var Mt=Tt(Ft,2);function Nt(e,t,i){t=Je(t,i);for(var n,r=ae(e),o=0,s=r.length;o<s;o++)if(t(e[n=r[o]],n,e))return n}function Lt(e){return function(t,i,n){i=Je(i,n);for(var r=re(t),o=e>0?0:r-1;o>=0&&o<r;o+=e)if(i(t[o],o,t))return o;return-1}}var jt=Lt(1),Ut=Lt(-1);function Wt(e,t,i,n){for(var r=(i=Je(i,n,1))(t),o=0,s=re(e);o<s;){var a=Math.floor((o+s)/2);i(e[a])<r?o=a+1:s=a}return o}function Ht(e,t,i){return function(n,r,o){var s=0,l=re(n);if("number"==typeof o)e>0?s=o>=0?o:Math.max(o+l,s):l=o>=0?Math.min(o+1,l):o+l+1;else if(i&&o&&l)return n[o=i(n,r)]===r?o:-1;if(r!=r)return(o=t(a.call(n,s,l),Y))>=0?o+s:-1;for(o=e>0?s:l-1;o>=0&&o<l;o+=e)if(n[o]===r)return o;return-1}}var qt=Ht(1,jt,Wt),Gt=Ht(-1,Ut);function $t(e,t,i){var n=(St(e)?jt:Nt)(e,t,i);if(void 0!==n&&-1!==n)return e[n]}function zt(e,t){return $t(e,Ke(t))}function Kt(e,t,i){var n,r;if(t=Qe(t,i),St(e))for(n=0,r=e.length;n<r;n++)t(e[n],n,e);else{var o=ae(e);for(n=0,r=o.length;n<r;n++)t(e[o[n]],o[n],e)}return e}function Yt(e,t,i){t=Je(t,i);for(var n=!St(e)&&ae(e),r=(n||e).length,o=Array(r),s=0;s<r;s++){var a=n?n[s]:s;o[s]=t(e[a],a,e)}return o}function Qt(e){var t=function(t,i,n,r){var o=!St(t)&&ae(t),s=(o||t).length,a=e>0?0:s-1;for(r||(n=t[o?o[a]:a],a+=e);a>=0&&a<s;a+=e){var l=o?o[a]:a;n=i(n,t[l],l,t)}return n};return function(e,i,n,r){var o=arguments.length>=3;return t(e,Qe(i,r,4),n,o)}}var Zt=Qt(1),Xt=Qt(-1);function Jt(e,t,i){var n=[];return t=Je(t,i),Kt(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function ei(e,t,i){return Jt(e,xt(Je(t)),i)}function ti(e,t,i){t=Je(t,i);for(var n=!St(e)&&ae(e),r=(n||e).length,o=0;o<r;o++){var s=n?n[o]:o;if(!t(e[s],s,e))return!1}return!0}function ii(e,t,i){t=Je(t,i);for(var n=!St(e)&&ae(e),r=(n||e).length,o=0;o<r;o++){var s=n?n[o]:o;if(t(e[s],s,e))return!0}return!1}function ni(e,t,i,n){return St(e)||(e=Oe(e)),("number"!=typeof i||n)&&(i=0),qt(e,t,i)>=0}var ri=w((function(e,t,i){var n,r;return M(t)?r=t:(t=He(t),n=t.slice(0,-1),t=t[t.length-1]),Yt(e,(function(e){var o=r;if(!o){if(n&&n.length&&(e=qe(e,n)),null==e)return;o=e[t]}return null==o?o:o.apply(e,i)}))}));function oi(e,t){return Yt(e,Ye(t))}function si(e,t){return Jt(e,Ke(t))}function ai(e,t,i){var n,r,o=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=St(e)?e:Oe(e)).length;a<l;a++)null!=(n=e[a])&&n>o&&(o=n);else t=Je(t,i),Kt(e,(function(e,i,n){((r=t(e,i,n))>s||r===-1/0&&o===-1/0)&&(o=e,s=r)}));return o}function li(e,t,i){var n,r,o=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=St(e)?e:Oe(e)).length;a<l;a++)null!=(n=e[a])&&n<o&&(o=n);else t=Je(t,i),Kt(e,(function(e,i,n){((r=t(e,i,n))<s||r===1/0&&o===1/0)&&(o=e,s=r)}));return o}function ci(e,t,i){if(null==t||i)return St(e)||(e=Oe(e)),e[rt(e.length-1)];var n=St(e)?je(e):Oe(e),r=re(n);t=Math.max(Math.min(t,r),0);for(var o=r-1,s=0;s<t;s++){var a=rt(s,o),l=n[s];n[s]=n[a],n[a]=l}return n.slice(0,t)}function di(e){return ci(e,1/0)}function ui(e,t,i){var n=0;return t=Je(t,i),oi(Yt(e,(function(e,i,r){return{value:e,index:n++,criteria:t(e,i,r)}})).sort((function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index})),"value")}function hi(e,t){return function(i,n,r){var o=t?[[],[]]:{};return n=Je(n,r),Kt(i,(function(t,r){var s=n(t,r,i);e(o,t,s)})),o}}var pi=hi((function(e,t,i){G(e,i)?e[i].push(t):e[i]=[t]})),fi=hi((function(e,t,i){e[i]=t})),mi=hi((function(e,t,i){G(e,i)?e[i]++:e[i]=1})),gi=hi((function(e,t,i){e[i?0:1].push(t)}),!0),yi=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function vi(e){return e?q(e)?a.call(e):k(e)?e.match(yi):St(e)?Yt(e,ze):Oe(e):[]}function bi(e){return null==e?0:St(e)?e.length:ae(e).length}function _i(e,t,i){return t in i}var wi=w((function(e,t){var i={},n=t[0];if(null==e)return i;M(n)?(t.length>1&&(n=Qe(n,t[1])),t=ge(e)):(n=_i,t=At(t,!1,!1),e=Object(e));for(var r=0,o=t.length;r<o;r++){var s=t[r],a=e[s];n(a,s,e)&&(i[s]=a)}return i})),Ti=w((function(e,t){var i,n=t[0];return M(n)?(n=xt(n),t.length>1&&(i=t[1])):(t=Yt(At(t,!1,!1),String),n=function(e,i){return!ni(t,i)}),wi(e,n,i)}));function Pi(e,t,i){return a.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))}function Si(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[0]:Pi(e,e.length-t)}function Ai(e,t,i){return a.call(e,null==t||i?1:t)}function Ei(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[e.length-1]:Ai(e,Math.max(0,e.length-t))}function Ci(e){return Jt(e,Boolean)}function ki(e,t){return At(e,t,!1)}var Oi=w((function(e,t){return t=At(t,!0,!0),Jt(e,(function(e){return!ni(t,e)}))})),Di=w((function(e,t){return Oi(e,t)}));function Ii(e,t,i,n){A(t)||(n=i,i=t,t=!1),null!=i&&(i=Je(i,n));for(var r=[],o=[],s=0,a=re(e);s<a;s++){var l=e[s],c=i?i(l,s,e):l;t&&!i?(s&&o===c||r.push(l),o=c):i?ni(o,c)||(o.push(c),r.push(l)):ni(r,l)||r.push(l)}return r}var Ri=w((function(e){return Ii(At(e,!0,!0))}));function xi(e){for(var t=[],i=arguments.length,n=0,r=re(e);n<r;n++){var o=e[n];if(!ni(t,o)){var s;for(s=1;s<i&&ni(arguments[s],o);s++);s===i&&t.push(o)}}return t}function Bi(e){for(var t=e&&ai(e,re).length||0,i=Array(t),n=0;n<t;n++)i[n]=oi(e,n);return i}var Vi=w(Bi);function Fi(e,t){for(var i={},n=0,r=re(e);n<r;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i}function Mi(e,t,i){null==t&&(t=e||0,e=0),i||(i=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/i),0),r=Array(n),o=0;o<n;o++,e+=i)r[o]=e;return r}function Ni(e,t){if(null==t||t<1)return[];for(var i=[],n=0,r=e.length;n<r;)i.push(a.call(e,n,n+=t));return i}function Li(e,t){return e._chain?de(t).chain():t}function ji(e){return Kt(Re(e),(function(t){var i=de[t]=e[t];de.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),Li(this,i.apply(de,e))}})),de}Kt(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=n[e];de.prototype[e]=function(){var i=this._wrapped;return null!=i&&(t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0]),Li(this,i)}})),Kt(["concat","join","slice"],(function(e){var t=n[e];de.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Li(this,e)}}));var Ui=ji({__proto__:null,VERSION:e,restArguments:w,isObject:T,isNull:P,isUndefined:S,isBoolean:A,isElement:E,isString:k,isNumber:O,isDate:D,isRegExp:I,isError:R,isSymbol:x,isArrayBuffer:B,isDataView:H,isArray:q,isFunction:M,isArguments:z,isFinite:K,isNaN:Y,isTypedArray:ne,isEmpty:le,isMatch:ce,isEqual:me,isMap:Ae,isWeakMap:Ee,isSet:Ce,isWeakSet:ke,keys:ae,allKeys:ge,values:Oe,pairs:De,invert:Ie,functions:Re,methods:Re,extend:Be,extendOwn:Ve,assign:Ve,defaults:Fe,create:Le,clone:je,tap:Ue,get:Ge,has:$e,mapObject:et,identity:ze,constant:Q,noop:tt,toPath:We,property:Ye,propertyOf:it,matcher:Ke,matches:Ke,times:nt,random:rt,now:ot,escape:lt,unescape:ct,templateSettings:dt,template:gt,result:yt,uniqueId:bt,chain:_t,iteratee:Xe,partial:Tt,bind:Pt,bindAll:Et,memoize:Ct,delay:kt,defer:Ot,throttle:Dt,debounce:It,wrap:Rt,negate:xt,compose:Bt,after:Vt,before:Ft,once:Mt,findKey:Nt,findIndex:jt,findLastIndex:Ut,sortedIndex:Wt,indexOf:qt,lastIndexOf:Gt,find:$t,detect:$t,findWhere:zt,each:Kt,forEach:Kt,map:Yt,collect:Yt,reduce:Zt,foldl:Zt,inject:Zt,reduceRight:Xt,foldr:Xt,filter:Jt,select:Jt,reject:ei,every:ti,all:ti,some:ii,any:ii,contains:ni,includes:ni,include:ni,invoke:ri,pluck:oi,where:si,max:ai,min:li,shuffle:di,sample:ci,sortBy:ui,groupBy:pi,indexBy:fi,countBy:mi,partition:gi,toArray:vi,size:bi,pick:wi,omit:Ti,first:Si,head:Si,take:Si,initial:Pi,last:Ei,rest:Ai,tail:Ai,drop:Ai,compact:Ci,flatten:ki,without:Di,uniq:Ii,unique:Ii,union:Ri,intersection:xi,difference:Oi,unzip:Bi,transpose:Bi,zip:Vi,object:Fi,range:Mi,chunk:Ni,mixin:ji,default:de});return Ui._=Ui,Ui}()}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";var e=i(3129),t=i.n(e),n=i(2130),r=i.n(n),o=i(2447),s=i(5545),a=i(9831),l=i.n(a);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f(e);if(t){var r=f(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var m=i(1999),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var t,i,n,o=h(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e.model)).model=e.model,t.onPredict=e.onPredict,t.adProperties=e.adProperties,t.onPredictCallback=e.onPredictCallback,t.currentKey=0,t.log=new s.Z({unitType:t.model.get("unitType"),className:"basePredictService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEvents(),t}return t=a,(i=[{key:"_bindEvents",value:function(){}},{key:"_setCuerrentKey",value:function(e){this.currentKey=m.last(e.split(".")),this.model.set("adsManagerLastPredictKey",this.currentKey)}},{key:"_predicted",value:function(e){if(!this.model.get("isGetRv1OnlyForEligible.isActive")||e!=r().RV_TYPES.RV||this.model.get("isEligibleToPlay")){if(this.model.set("lastPredictPoint",e),this.model.set("lastPredictPath",this.predictPath),this.model.get(this.predictPath+".isStartWF")&&this.startWf&&(this.log.info("startWF predicted"),this.startWf()),this._checkIsGet1OnlyOnAdLoaded()&&parseInt(e)===r().RV_TYPES.RV&&!this.model.get("playerHasRvInQ"))return this.log.warning("no rv=1 in adLoaded skipping predict"),void this.model.set("isSkippedDistancePredict",!0);this.predictPath&&!this.model.get(this.predictPath+".isActive")||(this._logPredict(e),this.onPredict(e,this.log.className,this.adProperties))}else this.model.get("isGetRv1OnlyForEligible.delayPrediction")&&this._delayRvPredict(e)}},{key:"_checkIsGet1OnlyOnAdLoaded",value:function(){var e=this.model.get("predictors.isGet1OnlyAfterAdLoaded");return this.predictPath&&void 0!==this.model.get("".concat(this.predictPath,".isGet1OnlyAfterAdLoaded"))&&(e=this.model.get("".concat(this.predictPath,".isGet1OnlyAfterAdLoaded"))),e}},{key:"_logPredict",value:function(e){var t="predicted with key: "+e;this.adProperties?this.log.info(t+" with properties: ",this.adProperties):this.log.info(t)}},{key:"_delayRvPredict",value:function(e){this.delayedPredictPointKey=e,this.delayStartTimeStamp=Date.now(),this.model.set("delayRvPredict",r().PREDICT_NAMES[this._getPredictName()]),this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_predictOnDelayRvPredict",isListenOnce:!0}])}},{key:"_predictOnDelayRvPredict",value:function(){this.model.set("executeDelayedRvPredict",{name:r().PREDICT_NAMES[this._getPredictName()],time:Date.now()-this.delayStartTimeStamp}),this._predicted(this.delayedPredictPointKey)}},{key:"_getPredictName",value:function(){return this.predictPath.split(".")[1]}}])&&d(t.prototype,i),n&&d(t,n),a}(o.O),y=g;function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=P(e);if(t){var r=P(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T(this,i)}}function T(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(o,e);var t,i,n,r=w(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"autoKillPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.autoKill.predictPoint",t.log.predict("predict created"),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adState:autoKill",funcName:"_onAutoKillPredict"}])}},{key:"_onAutoKillPredict",value:function(){var e=this.model.get("lastAutoKilledPredict");this.log.predict("predicted with key ".concat(e)),setTimeout(this._predicted.bind(this,e),0)}}])&&b(t.prototype,i),n&&b(t,n),o}(y),A=S,E=i(9057),C=i(9288),k=i.n(C),O=i(1999),D=function(e,t){e.model=t,e.parentSelectorStr=void 0,e.model.get("permanentCard")?e.parentSelectorStr='[data-card-index="'.concat(e.model.get("permanentCard"),'"]'):e.model.get("startCard")>1?e.parentSelectorStr='[data-card-index="'.concat(e.model.get("startCard"),'"]'):e.model.get("predictors.isUseWidgetSelector")?e.parentSelectorStr=e.model.get("widgetSelector"):e.parentSelectorStr=e.model.get("parentSelector");return{getParentSelector:function(){if(e.parentSelectorStr){var t=e.parentSelectorStr.toString(),i=(0,E.default)(t);return e.model.get("predictors.isNeedValidateParentSelector")?O.getValidSelectorElements(i)[0]:i[0]}},calcPredicts:function(){var t=e.model.get(e.predictPoints);O.each(t,(function(t,i){e._calcPredict(t,i)}))}}};function I(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var R,x=i(1999),B=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.conf=t,this.log=new s.Z({unitType:"Manager",className:"ScrollManager",version:this.conf.version,isDebug:this.conf.isDebug}),this.log.info("Created"),this.window=i||window,this.$window=(0,E.default)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.scrollElement=x.isEmpty(n)?this.window:(0,E.default)(n)[0],this.$scrollElement=(0,E.default)(this.scrollElement),this.timeBetweenEvents=100,this.lastTimeStamp=0,this.lastScrollTop=this.$scrollElement.scrollTop(),this.pps=0,this.ppsChange=0,this.vms=1/0,this.direction=1,this.maxMSBetweenEvents=2e3,this.scrollEndTimeout=500;var r=x.throttle(this.onScroll.bind(this),this.timeBetweenEvents);this.scrollElement.addEventListener("scroll",r)}var t,i,n;return t=e,(i=[{key:"getPps",value:function(){return this.pps}},{key:"onScroll",value:function(e){clearTimeout(this.scrollEnd);var t=e.timeStamp-this.lastTimeStamp;this.lastTimeStamp=e.timeStamp;var i=this.$scrollElement.scrollTop()-this.lastScrollTop;this.lastScrollTop=this.$scrollElement.scrollTop(),this.direction=i<0?-1:1,t<this.maxMSBetweenEvents&&this.changePPS(i/t*1e3),x.parseBool(this.conf.isLogScroll)&&this.log.info("onScroll - pps: "+this.direction*this.pps),this.scrollEnd=setTimeout(this.onScrollEnd.bind(this),this.scrollEndTimeout)}},{key:"onScrollEnd",value:function(){x.parseBool(this.conf.isLogScroll)&&this.log.warning("onScrollEnd"),this.changePPS(0),x.forEach(this.onScrollEndCBList,function(e){e()}.bind(this))}},{key:"changePPS",value:function(e){this.ppsChange=e-this.pps,this.pps=e,0===this.pps&&(this.vms=1/0),this.vms=this.windowHeight/this.pps*1e3,x.forEach(this.onScrollPPSChange,(function(e){setTimeout(e,0)}))}},{key:"registerForPPSChange",value:function(e){this.onScrollPPSChange=this.onScrollPPSChange||[];var t=this.onScrollPPSChange.indexOf(e);return-1!==t?t:this.onScrollPPSChange.push(e)-1}},{key:"deRegisterForPPSChange",value:function(e){var t=this.onScrollPPSChange.indexOf(e);this.onScrollPPSChange.splice(t,1)}},{key:"registerForScrollEnd",value:function(e){this.onScrollEndCBList=this.onScrollEndCBList||[];var t=this.onScrollEndCBList.indexOf(e);return-1!==t?t:this.onScrollEndCBList.push(e)-1}},{key:"deRegisterForScrollEnd",value:function(e){var t=this.onScrollEndCBList.indexOf(e);this.onScrollEndCBList.splice(t,1)}}])&&I(t.prototype,i),n&&I(t,n),e}(),V=function(e,t,i){return R||(R=new B(e,t,i)),R};function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=U(e);if(t){var r=U(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return j(this,i)}}function j(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}i(1999);var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(o,e);var t,i,n,r=L(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"baseDistancePredicts",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t}return t=o,(i=[{key:"_initPredict",value:function(e){this.predictPoint=e.predictPoint,this.predictKey=e.predictKey,this.startWf=e.startWfFunc,this.utils=D(this,this.model),this.scrollManager=new V,this._setParentSelector()}},{key:"_setParentSelector",value:function(){if(!this.isSelectorFound){var e=this.utils.getParentSelector();e?(this.isSelectorFound=!0,this.parentSelector=e,this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._calcPredict()):(this.log.info("no parentSelector can't predict distance waiting for parentSelector"),k().once("window:scroll:change",this._setParentSelector.bind(this)),this.model.listenToOnce(this.model,"change:parentSelector",this._setParentSelector.bind(this)))}}},{key:"_bindEvents",value:function(){this.parentSelector&&(window.taboolaBridge&&!this.registeredOnNotifyExternalRects&&(this.registeredOnNotifyExternalRects=!0,window.taboolaBridge.on("notifyExternalRects",this._calcPredict.bind(this))),k().once("window:scroll:change",this._calcPredict.bind(this)))}},{key:"_calcPredict",value:function(){}},{key:"_onDistancePredicted",value:function(e){if(this.log.predict("predict key ".concat(e,": max pps = ").concat(this.maxPPS,", current pps = ").concat(this.scrollManager.pps)),this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS)return this.log.warning("Distance Predicted, speed is too high",this.scrollManager.pps),this.model.set("isSkippedDistancePredict",!0),void this.log.predict("predict key ".concat(e,": skipping on pps"));this.log.warning("Distance Predicted, speed is OK",this.scrollManager.pps),this.log.predict("predict key ".concat(e,": predicted")),this._predicted(e)}}])&&M(t.prototype,i),n&&M(t,n),o}(y),H=W;function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function G(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Q(e);if(t){var r=Q(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return K(this,i)}}function K(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Y(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}var Z=i(1999),X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(o,e);var t,i,n,r=z(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"distancePercentPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.distancePercent",t.maxPPS=t.model.get("predictors.distancePercent.maxPPS"),t.utils=D(Y(t),t.model),t._initPredict(e),t}return t=o,(i=[{key:"_calcPredict",value:function(){if(!this.isPredicted){var e=(0,E.default)(this.model.get("scrollSelector"))[0],t=void 0!==e,i=t?e.clientHeight:window.innerHeight,n=t?i+e.scrollTop:i+window.pageYOffset,r=100/(this.predictPoint||1),o=Z.getTopOfEl(this.parentSelector),s=o+this.model.get("height")/(100/this.model.get("viewPercent")||1),a=i+(s-i)/r;this.model.get("logViewabilityCalc")&&this.log.info("\ntopParentSelector: "+o+",\neligibilityPoint: "+s+",\nstartPoint: "+i+",\nbottomViewPort: "+n+",\npredictionPoint: "+a+",\ncalc: predictionPoint <= bottomViewPort: "+(a<=n)),a<=n?(this.model.set("distancePercentPredictData",{topParentSelector:o,bottomViewPort:n,eligibilityPoint:s,startPoint:i,predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this._onDistancePredicted(this.predictKey)):this._bindEvents()}}}])&&G(t.prototype,i),n&&G(t,n),o}(H),J=X;function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e,t){return ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ie(e,t)}function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=oe(e);if(t){var r=oe(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return re(this,i)}}function re(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}var se=i(1999),ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(o,e);var t,i,n,r=ne(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"distancePixelsPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.distancePixels",t.maxPPS=t.model.get("predictors.distancePixels.maxPPS"),t.log.predict("predict created with key = ".concat(e.predictKey,", predict point = ").concat(e.predictPoint,", maxPPS = ").concat(t.maxPPS)),t._initPredict(e),t}return t=o,(i=[{key:"_calcPredict",value:function(){this.isPredicted||(se.hasPassedPixelFromSelector(this.parentSelectorStr,this.model.get("scrollSelector"),this.predictPoint,this.model.get("predictors.isNeedValidateParentSelector"))?(this.model.set("distancePixelPredictData",{predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this.log.predict("predict key ".concat(this.predictKey,": distance from selector is lower than ").concat(this.predictPoint,"px, checking max pps")),this._onDistancePredicted(this.predictKey)):this._bindEvents())}}])&&te(t.prototype,i),n&&te(t,n),o}(H),le=ae;function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function de(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ue(e,t){return ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ue(e,t)}function he(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=fe(e);if(t){var r=fe(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return pe(this,i)}}function pe(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}var me=i(1999),ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(o,e);var t,i,n,r=he(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"getAdFailPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.allowedPredictPoints="predictors.getAdFail.allowedPredictPoints",t.keysToPredict=t.model.get(t.allowedPredictPoints),t.log.predict("predict created with keys to predict ".concat(t.keysToPredict)),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"getAdState:failed",funcName:"_onFailedToGetAd"}])}},{key:"_onFailedToGetAd",value:function(){var e=this.model.get("lastFailedPredict");this._shouldPredict(e)&&(this.adProperties=this.model.get("lastFailedPredictProperties"),setTimeout(this._predicted.bind(this,this.model.get("lastFailedPredict")),200))}},{key:"_shouldPredict",value:function(e){var t=!1;return t=Array.isArray(this.keysToPredict)?me.contains(this.keysToPredict,e):"any"===this.keysToPredict.toString()||this.keysToPredict===e,this.log.predict("can predict key ".concat(e," = ").concat(t)),t}}])&&de(t.prototype,i),n&&de(t,n),o}(y),ye=ge;function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function be(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _e(e,t){return _e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_e(e,t)}function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Pe(e);if(t){var r=Pe(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Te(this,i)}}function Te(e,t){if(t&&("object"===ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pe(e){return Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pe(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(o,e);var t,i,n,r=we(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"loadingPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.loading.predictPoint",t.predictKey=t.model.get("predictors.loading.predictPoints"),t.log.predict("predict created with key = ".concat(t.predictKey)),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"playerState:restarted",funcName:"_onLoadingClick"}])}},{key:"_onLoadingClick",value:function(){this.log.predict("loading button clicked, predicting"),this._predicted(this.predictKey)}}])&&be(t.prototype,i),n&&be(t,n),o}(y),Ae=Se;function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function Ce(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ke(e,t)}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ie(e);if(t){var r=Ie(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return De(this,i)}}function De(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ie(e){return Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ie(e)}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(o,e);var t,i,n,r=Oe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"multiAdPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.multiAd",t.predictPoints="".concat(t.predictPath,".predictPoints"),t.predictKey=e.predictKey,t.predictOptions=t.model.get("".concat(t.predictPoints,".").concat(t.predictKey)),t.log.predict("predict created with key = ".concat(t.predictKey)),t.predictOptions.hasOwnProperty("secondsUntilComplete")?(t.secondsUntilAdComplete=t.predictOptions.secondsUntilComplete,t.log.predict("predict created with key = ".concat(t.predictKey,", seconds to ad complete = ").concat(t.secondsUntilAdComplete)),t._bindPredictSecondsUntilAdEnd()):t.predictOptions.hasOwnProperty("qState")&&(t.adQState=t.predictOptions.qState,t.log.predict("predict created with key = ".concat(t.predictKey,", ad quartile = ").concat(t.adQState)),t._bindPredictAdQState()),t}return t=o,(i=[{key:"_bindPredictSecondsUntilAdEnd",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_checkAdTimeLeft"}])}},{key:"_bindPredictAdQState",value:function(){var e=this.adQState;this.createStateHandlers([{event:"adQState:".concat(e),funcName:"_onPredictPoint"}])}},{key:"_checkAdTimeLeft",value:function(){var e=this.model.get("adDuration");if(e){var t=e<this.secondsUntilAdComplete?e:this.secondsUntilAdComplete,i=this.model.get("activeAdCurrentTime");e-i<=t&&(this.log.predict("ad duration = ".concat(e,", ad current time = ").concat(i)),this._onPredictPoint())}}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onPredictPoint",value:function(){if(this._allowPredict())return this.log.predict("allowing predict - in multi ad mode"),void this._predicted(this.predictKey);this.log.predict("disallowing predict - in single ad mode")}}])&&Ce(t.prototype,i),n&&Ce(t,n),o}(y),xe=Re;function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ve(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fe(e,t){return Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fe(e,t)}function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Le(e);if(t){var r=Le(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Ne(this,i)}}function Ne(e,t){if(t&&("object"===Be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}i(1999);var je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(o,e);var t,i,n,r=Me(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"playerReadyPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.playerReady",t.startWf=e.startWfFunc,t.predictKey=t.model.get(t.predictPath+".predictPoint"),t.predictPoint=t.predictPath+".predictPoint",t.log.predict("predict created with key = ".concat(t.predictKey)),t}return t=o,(i=[{key:"_bindEvents",value:function(){"ready"===this.model.get("playerState")?(this.log.predict("player is ready"),this._onPlayerReady()):(this.log.predict("waiting for player ready event"),this.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerReady",isListenOnce:!0}]))}},{key:"_onPlayerReady",value:function(){this._predicted(this.predictKey)}}])&&Ve(t.prototype,i),n&&Ve(t,n),o}(y),Ue=je;function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function He(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qe(e,t){return qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qe(e,t)}function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ze(e);if(t){var r=ze(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return $e(this,i)}}function $e(e,t){if(t&&("object"===We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ze(e)}i(1999);var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(o,e);var t,i,n,r=Ge(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"repeatPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.repeat.predictPoint",t.predictKey=t.model.get("predictors.repeat.predictPoints"),t.log.predict("predict created with key = ".concat(t.predictKey)),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"repeatState:spinning",funcName:"_onRepeatSpinning"}])}},{key:"_allowPredict",value:function(){return!this.model.get("isMultiAd")}},{key:"_onRepeatSpinning",value:function(){if(this._allowPredict())return this.log.predict("allowing predict - in multi ad mode"),void this._predicted(this.predictKey);this.log.predict("disallowing predict - in single ad mode")}}])&&He(t.prototype,i),n&&He(t,n),o}(y),Ye=Ke;function Qe(e){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(e)}function Ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xe(e,t){return Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xe(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=tt(e);if(t){var r=tt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return et(this,i)}}function et(e,t){if(t&&("object"===Qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function tt(e){return tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tt(e)}var it=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(o,e);var t,i,n,r=Je(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"firstScrollPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.firstScroll",t.predictPoints=t.predictPath+".predictPoints",t.predictKey=t.model.get(t.predictPath+".predictPoints"),t.startWf=e.startWfFunc,t.isPredicted=!1,t.log.predict("predict created with predict key = ".concat(t.predictKey)),t.model.get("isEligibleToPlay")?(t.log.predict("eligible to play on creation, calling predict"),t._callPredict()):t._onFirstScroll(),t}return t=o,(i=[{key:"_bindEvents",value:function(){k().once("window:scroll:change",this._onFirstScroll.bind(this)),this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_callPredict"}])}},{key:"_onFirstScroll",value:function(){if(!this.isPredicted){var e=window.pageYOffset,t=5,i=(0,E.default)(this.model.get("scrollSelector"))[0];if(void 0!==i){var n=i.clientHeight;e=n+i.scrollTop,t=n+5}t<=e?(this.log.predict("scrolled more than 5px, calling predict"),this._callPredict()):this._bindEvents()}}},{key:"_callPredict",value:function(){this.isPredicted||(this.isPredicted=!0,this._predicted(this.predictKey))}}])&&Ze(t.prototype,i),n&&Ze(t,n),o}(y),nt=it;function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function ot(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function st(e,t){return st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},st(e,t)}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ct(e);if(t){var r=ct(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return lt(this,i)}}function lt(e,t){if(t&&("object"===rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ct(e){return ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ct(e)}var dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(o,e);var t,i,n,r=at(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"emptyQueuePredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.log.predict("predict created"),t._bindEmptyQueuePredict(),t}return t=o,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindEmptyQueuePredict",value:function(){this.createStateHandlers([{event:"adManagerState:".concat(a.adManagerState.empty),funcName:"_onQEmpty"}])}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onQEmpty",value:function(){if(this.model.get("getAdState")!==a.getAdState.gettingAd)return this.log.predict("queue is empty, no get ad is process"),void this._onPredictPoint();this.log.predict("queue is empty, waiting for get ad reply")}},{key:"_onPredictPoint",value:function(){if(this._allowPredict())return this.log.predict("predict allowed - in multi ad mode"),void this._predicted(this.model.get("predictors.emptyQueue.predictPoints"));this.log.predict("predict disallowed - in single ad mode")}}])&&ot(t.prototype,i),n&&ot(t,n),o}(y),ut=dt;function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function pt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ft(e,t){return ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ft(e,t)}function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=yt(e);if(t){var r=yt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return gt(this,i)}}function gt(e,t){if(t&&("object"===ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yt(e){return yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yt(e)}i(1999);var vt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(l,e);var t,i,n,o=mt(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"fullEligibilityPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint=e.predictPoint,t.predictKey=t.model.get("predictors.fullEligibility.predictPoints"),t.predictPath="predictors.fullEligibility",t.startWf=e.startWfFunc,t.hadGetAdRv=!1,t.maxPPS=t.model.get("predictors.fullEligibility.maxPPS"),t.log.predict("predict created with key = ".concat(t.predictKey,", maxPPS = ").concat(t.maxPPS)),t.scrollManager=new V,t._bindEvents(),t}return t=l,(i=[{key:"_bindEvents",value:function(){if(this.scrollManager)if(this.createStateHandlers([{event:"getAdState:".concat(a.getAdState.gettingAd),funcName:"_onGettingAd",isListenOnce:!0}]),this.model.get("frameType")===r().FRAME_TYPE.plainPage)this.log.predict("listening to window scroll"),k().once("window:scroll:change",this._calcPredict.bind(this)),this.scrollManager.registerForScrollEnd(this._calcPredict.bind(this));else{var e=this.model.get("predictors.fullEligibility.checkPredictsSeconds");this.log.predict("checking eligibility every ".concat(e)),this.calcPredictInterval=setInterval(this._calcPredict.bind(this),1e3*e)}else this.log.predict("predict aborted, scroll manager not created")}},{key:"_onGettingAd",value:function(){if(1===this.model.get("lastGetAdKey"))return this.hadGetAdRv=!0,void this.log.predict("stop predict because get ad 1 in process");this.createStateHandlers([{event:"getAdState:".concat(a.getAdState.gettingAd),funcName:"_onGettingAd",isListenOnce:!0}])}},{key:"_calcPredict",value:function(){this.hadGetAdRv||this.isPredicted||(this._canPredict()&&this.maxPPS&&Math.abs(this.scrollManager.pps)<this.maxPPS?(this.isPredicted=!0,this.calcPredictInterval&&(clearInterval(this.calcPredictInterval),this.calcPredictInterval=void 0),this.model.set("fullEligibilityPredicted",!0),this.log.predict("allowed due to max pps - current pps = ".concat(this.scrollManager.pps," is lower than max pps ").concat(this.maxPPS)),this._predicted(this.predictKey)):(this.log.predict("disallowed due to max pps - current pps = ".concat(this.scrollManager.pps," is higher than or equal to max pps ").concat(this.maxPPS)),k().once("window:scroll:change",this._calcPredict.bind(this))))}},{key:"_canPredict",value:function(){var e=this.model.get("adState")===a.adState.playing,t=this.model.get("isEligibleToPlay"),i=this.model.get("isSkippedDistancePredict"),n=t&&i&&!e;if(this.log.predict("can predict = is eligible (".concat(t,") && skipped distance predict (").concat(i,") && no other ad playing (").concat(!e,") = ").concat(n)),n&&this._checkIsGet1OnlyOnAdLoaded()){var r=this.model.get("playerHasRvInQ");n=n&&r,this.log.predict("can predict = is player having RV1 in queue = ".concat(this.model.get("playerHasRvInQ")))}return n}}])&&pt(t.prototype,i),n&&pt(t,n),l}(y),bt=vt;function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}function wt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tt(e,t){return Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Tt(e,t)}function Pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=At(e);if(t){var r=At(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return St(this,i)}}function St(e,t){if(t&&("object"===_t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function At(e){return At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},At(e)}var Et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(o,e);var t,i,n,r=Pt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"bForcePredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.bForce.predictPoints",t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"canGetRv:true",funcName:"_onCanGetRv"}])}},{key:"_onCanGetRv",value:function(){this._predicted(this.model.get(this.predictPoint))}}])&&wt(t.prototype,i),n&&wt(t,n),o}(y),Ct=Et;function kt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ot=i(1999),Dt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new s.Z({unitType:"Util",className:"DeatchUtil",version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var t,i,n;return t=e,(i=[{key:"setSliderSize",value:function(){if(this.detachToSlider=this.model.get("detachToSlider"),this.model.get("stickyCard.isActive")){var e=this.model.get("width"),t=this.model.get("height"),i=this.getStickyPosition();return this.detachToSlider.position.horizontalOffset=i.left,this.detachToSlider.position.verticalOffset=i.top,this.detachToSlider.position.horizontal="left",this.detachToSlider.position.vertical="top",this.model.set("detachToSlider.width",e),void this.model.set("detachToSlider.height",t)}this.originalSliderWidth&&(this.detachToSlider.width=this.originalSliderWidth,this.originalSliderWidth=void 0),this.originalSliderHeight&&(this.detachToSlider.height=this.originalSliderHeight,this.originalSliderHeight=void 0),this.originalSliderHeight=this.detachToSlider.height;var n=this.model.get("width"),r=this.detachToSlider.liquidSize.isActive?this.calcLiquidWidth():this.detachToSlider.width;(n>r||this.detachToSlider.liquidSize.isDisableWidthLimit)&&(n=r);var o=Ot.getVideoHeightByRatio(n,this.model.get("aspectRatioNum")<=1?1.77:this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",n),this.model.set("detachToSlider.height",o)}},{key:"getStickyPosition",value:function(){var e=(0,E.default)(this.model.get("containerViewPlaceHolder")),t=e.length?e.offset().left:0,i=this.model.get("stickyCard.offset.top")||0,n=t+(this.model.get("stickyCard.offset.left")||0);return{top:"".concat(i),left:"".concat(n)}}},{key:"setSliderSizeVertical",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=Ot.getVideoHeight(this.model.get("width")),t=this.detachToSlider.liquidSize.isActive?this.calcLiquidHeight():this.detachToSlider.height;e>t&&(e=t);var i=Ot.getVideoWidthByRatio(e,this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",i),this.model.set("detachToSlider.height",e)}},{key:"calcLiquidWidth",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=this.detachToSlider.liquidSize.minWidth,t=this.detachToSlider.liquidSize.maxWidth,i=window.innerWidth*(this.detachToSlider.liquidSize.widthPercent/100);return t&&i>t&&(i=t),i<e&&(i=e),i}},{key:"calcLiquidHeight",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=this.detachToSlider.liquidSize.maxHeight,t=window.innerHeight*(this.detachToSlider.liquidSize.heightPercent/100);return e&&t>e&&(t=e),t}},{key:"setStickParams",value:function(){var e=this.model.get("stickyCard.navBarSelector"),t=document.querySelector(e),i=this.model.get("stickyCard.offset.top");if(t){var n=t.offsetHeight||0;this.model.set("stickyCard.offset.top",i+n)}}}])&&kt(t.prototype,i),n&&kt(t,n),e}(),It=function(){var e;return function(t){return e||(e=new Dt(t)),e}}(),Rt=It;function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Bt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vt(e,t){return Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vt(e,t)}function Ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Lt(e);if(t){var r=Lt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Mt(this,i)}}function Mt(e,t){if(t&&("object"===xt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Nt(e)}function Nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}var jt=i(1999),Ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(a,e);var t,i,r,o=Ft(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"intersectionPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint=e.predictPoint,t.predictKey=e.predictKey,t.isSliderOn=t.model.get("detachToSlider")&&(t.model.get("detachToSlider").isStartFromSlider||t.model.get("detachToSlider").isDetachToSlider),t.isSuperSlider=!!t.isSliderOn&&(t.model.get("detachToSlider.isStartFromSlider")&&t.model.get("detachToSlider.isDetachToSlider")),t.isAMP=t.model.get("frameType")===n.FRAME_TYPE.amp,t.predictPath="predictors.intersection",t.startWf=e.startWfFunc,t.utils=D(Nt(t),t.model),t.predictDelayTime=t.model.get("".concat(t.predictPath,".predictDelayTime")),t.isDelayPredict=!!t.predictDelayTime,t.log.predict("predict created with key = ".concat(t.predictKey,", predict point = ").concat(t.predictPoint,"% view, predictDelayTime = ").concat(t.predictDelayTime)),t._setSelector(),t}return t=a,(i=[{key:"_initObserver",value:function(){var e=[0,this.predictPoint/100];this.isAMP&&this.isSliderOn&&(this.detachUtil=Rt(this.model),this.detachUtil.setSliderSize(),e=jt.buildObserverThresholdList());var t={rootMargin:"0px",threshold:e};this.observer=new IntersectionObserver(this._observerCallback.bind(this),t),this.observer.observe(this.parentSelector)}},{key:"_setSelector",value:function(){if(!this.isSelectorFound){var e=this.utils.getParentSelector();e?(this.isSelectorFound=!0,this.selectorTimeOut&&(clearTimeout(this.selectorTimeOut),this.selectorTimeOut=void 0),this.parentSelector=e,this.log.predict("parent selector found, starting observer"),this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._initObserver()):(this.log.predict("parent selector couldn't be found, trying again in 1s"),this.log.info("no parentSelector can't predict distance waiting for parentSelector"),this.model.listenToOnce(this.model,"change:parentSelector",this._setSelector.bind(this)),this.selectorTimeOut=setTimeout(this._setSelector.bind(this),1e3))}}},{key:"_isIntersectingTest",value:function(e){return this.isAMP&&this.isSliderOn?e[0].intersectionRect.height>this.model.get("detachToSlider.height"):100*e[0].intersectionRatio>=this.predictPoint}},{key:"_observerCallback",value:function(e,t){if(!this.isPredicted){var i=this._isIntersectingTest(e);this.isSuperSlider&&this.isAMP&&i&&this.model.set("isSliderEligibleToPlay",!0),i||(this.log.predict("lost intersection, stoping delay if exist"),this._stopTimer()),i&&this.isDelayPredict&&(this.log.predict("intersected, starting delay for ".concat(this.predictDelayTime,"ms")),this._delayPredict()),i&&!this.isDelayPredict&&(this.log.predict("intersected, no delay"),this._onPrediction())}}},{key:"_delayPredict",value:function(){var e=this;this.delayPredictTimer?(this._stopTimer(),this._delayPredict()):this.delayPredictTimer=setTimeout((function(){e._onPrediction()}),this.predictDelayTime)}},{key:"_onPrediction",value:function(){this.isPredicted=!0,this.log.predict("predicted"),this._predicted(this.predictKey),this.observer.disconnect()}},{key:"_stopTimer",value:function(){this.delayPredictTimer&&(clearTimeout(this.delayPredictTimer),this.delayPredictTimer=void 0)}}])&&Bt(t.prototype,i),r&&Bt(t,r),a}(y),Wt=Ut;function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function qt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gt(e,t){return Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Gt(e,t)}function $t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Kt(e);if(t){var r=Kt(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return zt(this,i)}}function zt(e,t){if(t&&("object"===Ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Kt(e){return Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kt(e)}var Yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(o,e);var t,i,n,r=$t(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"feedXPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.feedX",t.predictPoints=t.predictPath+".predictPoints",t.predictKey=t.model.get(t.predictPath+".predictPoints"),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"feedxToggle",funcName:"_onFeedxToggle"}])}},{key:"_onFeedxToggle",value:function(){this.model.get("feedxToggle")%2==1&&this._predicted(this.predictKey)}}])&&qt(t.prototype,i),n&&qt(t,n),o}(y),Qt=Yt;function Zt(e){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(e)}function Xt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jt(e,t){return Jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Jt(e,t)}function ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ii(e);if(t){var r=ii(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return ti(this,i)}}function ti(e,t){if(t&&("object"===Zt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ii(e){return ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ii(e)}var ni=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jt(e,t)}(o,e);var t,i,n,r=ei(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"feedContainerChangedPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.feedContainerChanged",t.predictPoints=t.predictPath+".predictPoints",t.predictKey=t.model.get(t.predictPath+".predictPoints"),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"feedContainerChanged",funcName:"_onFeedContainerChanged"}])}},{key:"_onFeedContainerChanged",value:function(){this._predicted(this.predictKey)}}])&&Xt(t.prototype,i),n&&Xt(t,n),o}(y),ri=ni;function oi(e){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oi(e)}function si(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ai(e,t){return ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ai(e,t)}function li(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=di(e);if(t){var r=di(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return ci(this,i)}}function ci(e,t){if(t&&("object"===oi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function di(e){return di=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},di(e)}var ui=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ai(e,t)}(o,e);var t,i,n,r=li(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"baseAdProgressionPredicts",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t}return t=o,(i=[{key:"_initPredict",value:function(e){this.requestedTime=e.predictPoint,this.predictKey=e.predictKey,this._bindPredictAdDuration()}},{key:"_bindPredictAdDuration",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_onPredictPoint"},{event:"lastActiveAd",funcName:"_onAdCompleted"}])}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.predictKey)}},{key:"_allowPredict",value:function(){}},{key:"_onAdCompleted",value:function(){this.isPredicted=!1}}])&&si(t.prototype,i),n&&si(t,n),o}(y),hi=ui;function pi(e){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}function fi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mi(e,t){return mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mi(e,t)}function gi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=vi(e);if(t){var r=vi(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return yi(this,i)}}function yi(e,t){if(t&&("object"===pi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vi(e)}var bi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mi(e,t)}(o,e);var t,i,n,r=gi(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"adProgressionBeforeEndPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.adProgressionBeforeEnd",t._initPredict(e),t}return t=o,(i=[{key:"_allowPredict",value:function(){if(this.isPredicted)return!1;var e=this.model.get("activeAdMaxTime"),t=this.model.get("activeAdCurrentTime");return!!(e&&t&&e-this.requestedTime<=t)&&(this.isPredicted=!0,this.model.increaseCounter("onadProgressionBeforeEndPredictPredict"),!0)}}])&&fi(t.prototype,i),n&&fi(t,n),o}(hi),_i=bi;function wi(e){return wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wi(e)}function Ti(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pi(e,t){return Pi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Pi(e,t)}function Si(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ei(e);if(t){var r=Ei(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Ai(this,i)}}function Ai(e,t){if(t&&("object"===wi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ei(e)}var Ci=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pi(e,t)}(o,e);var t,i,n,r=Si(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"adProgressionAfterBeginPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.adProgressionAfterBegin",t._initPredict(e),t}return t=o,(i=[{key:"_allowPredict",value:function(){if(this.isPredicted)return!1;var e=this.model.get("activeAdCurrentTime");return!!(e&&this.requestedTime<=e)&&(this.isPredicted=!0,this.model.increaseCounter("onadProgressionAfterBeginPredict"),!0)}}])&&Ti(t.prototype,i),n&&Ti(t,n),o}(hi),ki=Ci;function Oi(e){return Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi(e)}function Di(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ii(e,t){return Ii=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ii(e,t)}function Ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Bi(e);if(t){var r=Bi(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return xi(this,i)}}function xi(e,t){if(t&&("object"===Oi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Bi(e){return Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bi(e)}var Vi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ii(e,t)}(o,e);var t,i,n,r=Ri(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"timePredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.time",t.modelKey=e.modelKey?e.modelKey:e.predictKey?"".concat(t.predictPath,".predictPoints.").concat(e.predictKey):t.predictPath,t.predictKey=e.predictKey||t.model.get("".concat(t.modelKey,".predictPoints")),t.isActive=t.model.get("".concat(t.modelKey,".isActive")),t.isActive?(t.length=1e3*t.model.get("".concat(t.modelKey,".lengthInSeconds")),t.length?(t.repeat=t.model.get("".concat(t.modelKey,".repeat"))||1,t.log.predict("predict created with key = ".concat(t.predictKey,", length = ").concat(t.length,"ms, repeat = ").concat(t.repeat)),t._bindTimePredict(),t._startPredictTimer(),t):xi(t)):xi(t)}return t=o,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindTimePredict",value:function(){this.createStateHandlers([{event:"time:".concat(this.predictPath),funcName:"_startPredictTimer"}])}},{key:"_canRepeatPredict",value:function(){return this.repeat>0}},{key:"_canStartTimer",value:function(){return!this.stopped&&this._canRepeatPredict()}},{key:"_startPredictTimer",value:function(){var e=this;if(this._canStartTimer())return this.timer&&(this.timer=clearTimeout(this.timer)),this.log.info("Starting timer",this.predictKey),this.log.predict("repeating ".concat(this.repeat," more times")),void(this.timer=setTimeout((function(){--e.repeat,e._predicted(e.predictKey),e._startPredictTimer()}),this.length));this.log.predict("no more repeats")}},{key:"stop",value:function(){this.log.info("Timer predict stopped"),this.log.predict("stopping timer"),this.timer=clearTimeout(this.timer),this.stopped=!0}}])&&Di(t.prototype,i),n&&Di(t,n),o}(y),Fi=Vi;function Mi(e){return Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mi(e)}function Ni(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Li(e,t){return Li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Li(e,t)}function ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Wi(e);if(t){var r=Wi(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Ui(this,i)}}function Ui(e,t){if(t&&("object"===Mi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Wi(e){return Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wi(e)}i(1999);var Hi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Li(e,t)}(o,e);var t,i,n,r=ji(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"mp4Predict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.mp4",t.predictKey=t.model.get(t.predictPath+".predictPoint"),t.predictPoint=t.predictPath+".predictPoint",t.log.predict("predict created with key = ".concat(t.predictKey)),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"playerQueue",funcName:"_onPlayerQueueStatusChange"}])}},{key:"_onPlayerQueueStatusChange",value:function(){this.adsListFromPlayer=this.model.get("playerQueue"),this._allowPredict()?(this.log.predict("found rv1 video ad in player queue, predicting"),this._predicted(this.predictKey),this.model.stopListening(this.model,"change:playerQueue")):this.log.predict("didn't find rv1 video ad in player queue, waiting for next queue change")}},{key:"_allowPredict",value:function(){var e=this.adsListFromPlayer[this.adsListFromPlayer.length-1];return!0===e.rv&&"video"===e.mt}}])&&Ni(t.prototype,i),n&&Ni(t,n),o}(y),qi=Hi;function Gi(e){return Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gi(e)}function $i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zi(e,t){return zi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},zi(e,t)}function Ki(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Qi(e);if(t){var r=Qi(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Yi(this,i)}}function Yi(e,t){if(t&&("object"===Gi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qi(e){return Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qi(e)}var Zi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zi(e,t)}(o,e);var t,i,n,r=Ki(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"transitionPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.transition",t.isActive=t.model.get("".concat(t.predictPath,".isActive")),t.isActive?(t.predictPoints="".concat(t.predictPath,".predictPoints"),t.predictKey=e.predictKey,t.predictOptions=t.model.get("".concat(t.predictPoints,".").concat(t.predictKey)),t.predictOptions.container?(t.container=document.querySelector(t.predictOptions.container),t.container?(t.predictOptions.event=t.predictOptions.event||"start",t.predictOptions.requireEligibility=t.predictOptions.requireEligibility||!1,t.predictOptions.repeat=t.predictOptions.repeat||0,t.predictOptions.checkQueueForSameRv=t.predictOptions.checkQueueForSameRv||!1,t.log.predict("predict created with key = ".concat(t.predictKey,", event = ").concat(t.predictOptions.event,", require eligibility = ").concat(t.predictOptions.requireEligibility,", repeat = ").concat(t.predictOptions.repeat,", check if queue has same rv = ").concat(t.predictOptions.checkQueueForSameRv)),t._startTransitionPredictor(),t):Yi(t)):Yi(t)):Yi(t)}return t=o,(i=[{key:"_bindEvents",value:function(){}},{key:"_startTransitionPredictor",value:function(){this.animationEventDetector=TRC.dom.detectAnimationEvent(this.container,this.predictOptions.event),this._bindedOnAnimationEvent=this._onAnimationEvent.bind(this,this.predictOptions.event),TRC.dom.on(this.container,this.animationEventDetector,this._bindedOnAnimationEvent)}},{key:"_onAnimationEvent",value:function(e){if(!this.stopped){var t=(new Date).getTime();if(!(this.lastPredicted&&t-this.lastPredicted<1e3))return this._isRequireEligibilityMatch()?void(this._isQueueContainSameRv()?this.log.predict("can't predict becuase queue already has the same ad type"):(this.lastPredicted=t,this._predicted(this.predictKey),--this.predictOptions.repeat<0&&(this.stopped=!0,TRC.dom.off(this.container,this.animationEventDetector,this._bindedOnAnimationEvent)))):(this.log.predict("can't predict because requiring eligibility"),void(this.predictOptions.requireEligibility&&(this.log.predict("listening to eligibility changes"),this._listenToEligibilityChanges())));this.log.predict("can't predict because of throttle from last prediction")}}},{key:"_isRequireEligibilityMatch",value:function(){return!this.predictOptions.requireEligibility||this.model.get("isEligibleToPlay")}},{key:"_isQueueContainSameRv",value:function(){return!!this.predictOptions.checkQueueForSameRv&&this.model.get(0==this.predictKey?"adsList.nonRvAds":"adsList.rvAds")>0}},{key:"_listenToEligibilityChanges",value:function(){this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_onAnimationEvent",isListenOnce:!0}])}}])&&$i(t.prototype,i),n&&$i(t,n),o}(y),Xi=Zi;function Ji(e){return Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ji(e)}function en(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tn(e,t){return tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tn(e,t)}function nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=on(e);if(t){var r=on(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return rn(this,i)}}function rn(e,t){if(t&&("object"===Ji(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function on(e){return on=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},on(e)}var sn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tn(e,t)}(o,e);var t,i,n,r=nn(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"feedCardsPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.feedCards",t.predictPoints="".concat(t.predictPath,".predictPoints"),t.isUseTimer=t.model.get(t.predictPath+".isUseTimer"),t.timerTime=t.model.get(t.predictPath+".timerTime")||5e3,t.predictKey=t.model.get(t.predictPath+".predictPoints"),t.startWf=e.startWfFunc,t.isPredicted=!1,t._bindEvents(),t.model.get("isCardsInViewPort")&&t._onPrediction(),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isCardsInViewPort",funcName:"_calculatePredict"}])}},{key:"_calculatePredict",value:function(){this.model.get("isCardsInViewPort")?(this._onPrediction(),this._handleTimer()):clearTimeout(this.predictTimer)}},{key:"_handleTimer",value:function(){this.isUseTimer&&!this.timerRunning&&(this.timerRunning=!0,this.predictTimer=setTimeout(this._timerCallback.bind(this),this.timerTime))}},{key:"_timerCallback",value:function(){this.timerRunning=!1,this._calculatePredict()}},{key:"_onPrediction",value:function(){this._predicted(this.predictKey)}}])&&en(t.prototype,i),n&&en(t,n),o}(y),an=sn;function ln(e){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ln(e)}function cn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dn(e,t){return dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},dn(e,t)}function un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=pn(e);if(t){var r=pn(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return hn(this,i)}}function hn(e,t){if(t&&("object"===ln(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pn(e){return pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pn(e)}i(1999);var fn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(o,e);var t,i,n,r=un(o);function o(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,e)).model=e,i.log=new s.Z({unitType:i.model.get("unitType"),className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.cardsSelector=t,i.usedCards=[],i}return t=o,(i=[{key:"_setMinDistance",value:function(){this.minCardDistance=this.model.get("cardsMinDistance")||0;var e=(0,E.default)(window).height();this.minCardDistance<e&&(this.minCardDistance=e,this.model.set("cardsMinDistance",e))}},{key:"getCard",value:function(e){}},{key:"cancelGetCard",value:function(){}},{key:"setCardAsUsed",value:function(e){this.usedCards.push(e)}},{key:"_getPlaceHolders",value:function(){}},{key:"_isElementBelowView",value:function(e){}}])&&cn(t.prototype,i),n&&cn(t,n),o}(o.O),mn=fn;function gn(e){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn(e)}function yn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vn(e,t){return vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},vn(e,t)}function bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=wn(e);if(t){var r=wn(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _n(this,i)}}function _n(e,t){if(t&&("object"===gn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wn(e){return wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wn(e)}var Tn=i(1999),Pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vn(e,t)}(o,e);var t,i,n,r=bn(o);function o(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,e)).model=e,i.cardsSelector=t,i.usedCards=[],i.shouldSearchForNewCard=!0,i._setMinDistance(),i._createDecisionFuncs(),i}return t=o,(i=[{key:"_createDecisionFuncs",value:function(){this.decisionsFuncs=[this._isNotUsedCard,this._isBelowUsedCard,this._viewPortFunc,this._isMinDistanceOk]}},{key:"getCard",value:function(e,t){if(this.shouldSearchForNewCard||t){t||this.log.info("searching for card");var i=void 0;this.cb=e;for(var n=this._getPlaceHolders(),r=n.length-1;r>=0;r--)this._isCardSuitable(n[r])&&(i=n[r]);i?(this.log.info("found card: ",i),this._callCardCB(e,i)):(this.shouldSearchForNewCard=!1,this._registerListeners())}}},{key:"_getPlaceHolders",value:function(){var e=(0,E.default)(this.cardsSelector);return this.model.get("msnWebComponentsEnabled")?this._getShadowDOMPlaceholders(e):this._getNonShadowDOMPlaceholders(e)}},{key:"_getNonShadowDOMPlaceholders",value:function(e){var t=[];this.model.get("msnCanOpenFirstRow")?t=this._getRowPlaceHolder(1,this.model.get("msnMinimumCardInFirstRow")):this.model.get("msnCanOpenSecondRow")&&(t=this._getRowPlaceHolder(2,this.model.get("msnMinimumCardInSecondRow")));for(var i=0;i<e.length;i++)t.push(e[i]);return t}},{key:"_getShadowDOMPlaceholders",value:function(e){var t=[],i=this.model.get("msnSizeSelector");return e&&e.length&&i&&e.forEach((function(e){if(e&&e.shadowRoot){var n=e.shadowRoot.querySelector(i);n&&n.parentElement&&t.push(n.parentElement)}})),t}},{key:"_getRowPlaceHolder",value:function(e,t){for(var i=[],n=[],r=document.querySelectorAll(this.model.get("msnUpperRowsSelector")),o=1,s=0,a=0;a<r.length&&o<=e;a++){var l=r[a],c=l.style.top&&Tn.convertRem(parseFloat(l.style.top));s!==c&&o++,o===e&&(!this.model.get("msnIsOpenOnSponsoredCards")&&l.querySelector(this.model.get("msnSponsoredSelector"))||n.push(l)),s=c}return n.length>=t&&("rtl"===document.querySelector("html").getAttribute("dir").toLowerCase()?i.push([n[1],n[0]]):i.push([n[0],n[1]])),i}},{key:"getEligiblePlaceHolders",value:function(){var e=this._getPlaceHolders()||[];return Tn.flattenArray(e)}},{key:"_isCardSuitable",value:function(e){for(var t=0;t<this.decisionsFuncs.length;t++){var i=this.decisionsFuncs[t].bind(this),n=e;if(Tn.isArray(e)&&(n=e[0]),!i(n))return!1}return!0}},{key:"_registerListeners",value:function(){k().once("window:scroll:change",this._onScroll.bind(this),this)}},{key:"_unRegisterListeners",value:function(){k().off("window:scroll:change",this._onScroll.bind(this),this)}},{key:"_callCardCB",value:function(e,t){this.shouldSearchForNewCard=!0,this.cb({cardToHide:Tn.isArray(t)?t[0]:t,additionalCard:Tn.isArray(t)?t[1]:void 0}),this.cb=void 0}},{key:"_onScroll",value:function(){this.getCard(this.cb,!0)}},{key:"setCardAsUsed",value:function(e){var t={cardEl:e,offsetTop:Tn.getTopOfEl(e)};Tn.extend(t,e.getBoundingClientRect()),t.offsetBottom=t.offsetTop+t.height,this.usedCards.push(t)}},{key:"_isNotUsedCard",value:function(e){return!this.usedCards.some((function(t){return t.cardEl===e}))}},{key:"_isBelowUsedCard",value:function(e){var t=Tn.getTopOfEl(e);return Tn.every(this.usedCards,(function(e){var i=e.offsetBottom;return t>i}))}},{key:"_viewPortFunc",value:function(e){return this.model.get("isOpenInViewPort")&&this._isCardInViewPort(e)||this._isElementBelowView(e)}},{key:"_isCardInViewPort",value:function(e){return Tn.getViewPercent(e,e.offsetWidth,e.offsetHeight)>=this.model.get("cardViewPercent")}},{key:"_isElementBelowView",value:function(e){return e.getBoundingClientRect().top>(window.innerHeight||document.documentElement.clientHeight)}},{key:"_isMinDistanceOk",value:function(e){var t=Tn.getTopOfEl(e),i=this.minCardDistance;return Tn.every(this.usedCards,(function(e){return t-e.offsetBottom>=i}))}}])&&yn(t.prototype,i),n&&yn(t,n),o}(mn),Sn=Pn;function An(e){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},An(e)}function En(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cn(e,t){return Cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Cn(e,t)}function kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=In(e);if(t){var r=In(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return On(this,i)}}function On(e,t){if(t&&("object"===An(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Dn(e)}function Dn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function In(e){return In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},In(e)}var Rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cn(e,t)}(o,e);var t,i,n,r=kn(o);function o(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).log=new s.Z({unitType:t.model.get("unitType"),className:"msnFullEligibilityPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.msnFullEligibility",t.maxPps=t.model.get("".concat(t.predictPath,".maxPps")),t.predictKey=t.model.get("".concat(t.predictPath,".predictPoints")),t.cardLocator=new Sn(t.model,t.model.get("msnSelector")),t.scrollManager=new V,t.availableCardsElements=t.cardLocator.getEligiblePlaceHolders(),!Array.isArray(t.availableCardsElements)||!t.availableCardsElements.length)return On(t);return t.intersectionObserver=new IntersectionObserver(t.intersectionCallback.bind(Dn(t)),{root:null,threshold:1,rootMargin:"0px"}),t._observePossibleCards(),t}return t=o,(i=[{key:"_observePossibleCards",value:function(){var e=this;this.availableCardsElements.forEach((function(t){e.intersectionObserver.observe(t)}))}},{key:"intersectionCallback",value:function(e,t){this._canPredict()&&e.some((function(e){return e.isIntersecting}))&&this._predicted(this.predictKey)}},{key:"_canPredict",value:function(){var e=this.scrollManager.getPps();if(e>this.maxPps)return this.log.predict("Can predict, current pps (".concat(e,") is higher then maxPps (").concat(this.maxPps,")")),!1;var t=this.model.get("adState")===a.adState.playing,i=this.model.get("isEligibleToPlay"),n=i&&!t;if(this.log.predict("can predict = is eligible (".concat(i,") && no other ad playing (").concat(!t,") = ").concat(n)),n&&this._checkIsGet1OnlyOnAdLoaded()){var r=this.model.get("playerHasRvInQ");n=n&&r,this.log.predict("can predict = is player having RV1 in queue = ".concat(this.model.get("playerHasRvInQ")))}return n}}])&&En(t.prototype,i),n&&En(t,n),o}(y),xn=Rn;function Bn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Vn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncUrl=t.get("sync"),this.syncUrl&&(this.log=new s.Z({unitType:t.get("unitType"),className:this.constructor.name,version:t.get("version"),isDebug:t.get("isDebug")}),this.timePredict=new Fi({model:t,onPredict:this._syncCookies.bind(this),predictKey:"cookieSync",modelKey:"predictors.time.cookieSync"}),this._syncCookies())}var t,i,n;return t=e,(i=[{key:"_syncCookies",value:function(){var e=this;this.log.info("Cookie sync request",this.syncUrl);var t=document.createElement("iframe");t.style.display="none",t.src=this.syncUrl,t.onerror=function(){e._stopSync()},document.body.appendChild(t)}},{key:"_stopSync",value:function(){this.log.info("Stopping cookie sync"),this.timePredict.stop()}}])&&Bn(t.prototype,i),n&&Bn(t,n),e}(),Fn=Vn;function Mn(e){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mn(e)}function Nn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ln(e,t){return Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ln(e,t)}function jn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Wn(e);if(t){var r=Wn(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Un(this,i)}}function Un(e,t){if(t&&("object"===Mn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Wn(e){return Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wn(e)}var Hn=i(1999),qn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(l,e);var t,i,n,o=jn(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e.model)).model=e.model,t.subModel=e.subModel,t.adData=e.adData||{},t.scrollManager=new V,t.onDebugDataChange=e.onDebugDataChange,t.predictName=e.predictName,t.log=new s.Z({unitType:t.model.get("unitType"),className:"DebugData",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.isViewed=e.isViewed,e.onDebugDataChange&&(t._onDebugChange(),t._bindEvents()),t}return t=l,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"sqv",funcName:"_onDebugChange"},{event:"conversionCount",funcName:"_onDebugChange"},{event:"rvvs1",funcName:"_onDebugChange"},{event:"rvvs0",funcName:"_onDebugChange"},{event:"rvps1",funcName:"_onDebugChange"},{event:"rvps0",funcName:"_onDebugChange"}])}},{key:"_onDebugChange",value:function(){this.onDebugDataChange(this.getDebugData())}},{key:"getDebugData",value:function(){if(this.model.get("isSendDebugDataReporting")){var e="";for(var t in r().DEBUG_DATA){var i=this[t]();e+=void 0!==i?"".concat(r().DEBUG_DATA[t],":").concat(i,"!"):"".concat(r().DEBUG_DATA[t],":!")}return e}}},{key:"pn",value:function(){return r().PREDICT_NAMES[this.predictName]}},{key:"sqg",value:function(){return this.adData.adId}},{key:"sqv",value:function(){return this.model.get("sqv")}},{key:"sqp",value:function(){if(this.model.get("conversionCount"))return parseInt(this.model.get("conversionCount"))}},{key:"rv",value:function(){return this.isRv()?1:0}},{key:"rvvs",value:function(){return this.isRv()?this.model.get("rvvs1"):this.model.get("rvvs0")}},{key:"rvps",value:function(){return this.isRv()?this.model.get("rvps1"):this.model.get("rvps0")}},{key:"ppsc",value:function(){return parseInt(this.scrollManager.ppsChange)}},{key:"vms",value:function(){var e=this.scrollManager.vms;return e=e!==1/0?parseInt(e):"inf"}},{key:"pps",value:function(){return parseInt(this.scrollManager.pps)}},{key:"gpps",value:function(){return parseInt(this.adData.getAdPPS)}},{key:"gppsc",value:function(){return parseInt(this.adData.getAdPPSChange)}},{key:"isRv",value:function(){return Hn.parseBool(this.adData.requiredViewability)}},{key:"ft",value:function(){return this.model.get("frameType")}},{key:"fsc",value:function(){var e=this.model.get("startCard");if(void 0!==e&&""!==e)return parseInt(e)}},{key:"fpc",value:function(){var e=this.model.get("permanentCard");if(void 0!==e&&""!==e)return parseInt(e)}},{key:"sa",value:function(){var e=this.subModel||this.model;return e&&e.get("isPlacementSingleAd")?1:0}},{key:"pi",value:function(){return this.model.get("MSNCard.placementIndex")}},{key:"dt",value:function(){var e=this.subModel||this.model;return e.get("videoViewState")&&e.get("videoViewState")===a.videoViewState.detached?1:0}},{key:"vb",value:function(){return this.isViewed?1:0}},{key:"dur",value:function(){var e=this.subModel||this.model,t=parseInt(e.get("activeAdMaxTime"));return t||(t=void 0),t}},{key:"ttv",value:function(){return this.adData.timeToVimp?parseInt(this.adData.timeToVimp):0}},{key:"bovpg",value:function(){return this.adData.bovpg?parseInt(this.adData.bovpg):""}},{key:"bovpv",value:function(){return this.adData.bovpv?parseInt(this.adData.bovpv):""}},{key:"be",value:function(){return this.model.get("playerHasRvInQ")?1:0}},{key:"pap",value:function(){return void 0!==this.adData.pap?parseInt(this.adData.pap):""}},{key:"mty",value:function(){return void 0!==this.adData.mty?parseInt(this.adData.mty):""}},{key:"esv",value:function(){return this.adData.esv?1:0}},{key:"rot",value:function(){return this.adData.rot}},{key:"roid",value:function(){return this.adData.roid}},{key:"rom",value:function(){return this.adData.rom}},{key:"tti",value:function(){return this.adData.timeToImpression}}])&&Nn(t.prototype,i),n&&Nn(t,n),l}(o.O),Gn=qn,$n=i(5264),zn=i.n($n);function Kn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Yn=i(1999),Qn=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.oppsOptions=i,this.options={"auc-dast":void 0,dast:void 0,d:void 0,dp:void 0,os:void 0,pv:void 0,pt:void 0,rs:void 0,rst:void 0,st:void 0,sts:void 0,tms:void 0,vmt:void 0,vpd:void 0,vptd:void 0},this.options=Yn.extend(this.options,t),this.log=new s.Z({className:"Opportunity Manager"}),this.pixelType={tagStarted:0,tagImpression:1,tagTimeout:2,tagError:4,playerClosed:7,AdVideoFirstQuartile:21,AdVideoMidpoint:22,AdVideoThirdQuartile:23,AdVideoComplete:24,viewability:30,firstImpression:99}}var t,i,n;return t=e,(i=[{key:"send",value:function(e,t){var i=this.isBillableEvent(e.rst)?this.oppsOptions.oppUrl:this.oppsOptions.nonBllbOppUrl;i+="?rst="+e.rst,e=Yn.extend({},this.options,{tms:Math.floor((new Date).getTime()/1e3)},e),t&&Yn.isSendBeaconSupported()?navigator.sendBeacon(i,JSON.stringify([e])):E.default.ajax({type:"POST",url:i,data:JSON.stringify([e]),contentType:"text/plain"})}},{key:"isBillableEvent",value:function(e){return this.oppsOptions.billableEvents.indexOf(e)>-1}}])&&Kn(t.prototype,i),n&&Kn(t,n),e}(),Zn=Qn;function Xn(e){return Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xn(e)}function Jn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function er(e,t){return er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},er(e,t)}function tr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=nr(e);if(t){var r=nr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return ir(this,i)}}function ir(e,t){if(t&&("object"===Xn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nr(e){return nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nr(e)}var rr=i(1999),or={viewability:{id:30,name:"viewability"},viewabilityOneS:{id:54,name:"viewabilityOneS"},viewability100:{id:63,name:"viewability100"},viewabilityAMP:{id:131,name:"viewabilityAMP"},noViewabilityAMP:{id:132,name:"noViewabilityAMP"},compView100:{id:107,name:"compView100"},pauseAfterPlay:{id:31,name:"pauseAfterPlay"},conversion:{id:32,name:"adPlay"},clickThru:{id:33,name:"clickThru"},skipVimp1EligibilityLost:{id:43,name:"skipVimp1EligibilityLost"},skipVimp1Vimp0Playing:{id:44,name:"skipVimp1Vimp0Playing"},unitImpression:{id:45,name:"unitImpression"},continueAd:{id:46,name:"continueAd"},continueAdInAnotherCard:{id:55,name:"continueAdInAnotherCard"},shouldContinueAdInAnotherCard:{id:56,name:"shouldContinueAdInAnotherCard"},lostCardEligibility:{id:57,name:"lostCardEligibil*ity"},adUnmuted:{id:58,name:"adUnmuted"},userAdUnmuted:{id:64,name:"userAdUnmuted"},learnMoreClick:{id:71,name:"learnMoreClick"},adTitleClick:{id:74,name:"adTitleClick"},adCtaButtonClick:{id:75,name:"adCtaButtonClick"},adDescriptionClick:{id:76,name:"adDescriptionClick"},adBrandingClick:{id:77,name:"adBrandingClick"},adIconClick:{id:78,name:"adIconClick"},detach:{id:79,name:"detach"},attach:{id:80,name:"attach"},sliderClosed:{id:81,name:"sliderClosed"},twoSecAfterPlay:{id:82,name:"twoSecAfterPlay"},adProgressionAfterBeginPredict:{id:84,name:"adProgressionAfterBeginPredict"},adProgressionBeforeEndPredict:{id:85,name:"adProgressionBeforeEndPredict"},adSwappedOut:{id:104,name:"adSwappedOut"},adSwappedIn:{id:105,name:"adSwappedIn"},pauseAfterPlayScrolledUp:{id:108,name:"pauseAfterPlayScrolledUp"},pauseAfterPlayScrolledDown:{id:109,name:"pauseAfterPlayScrolledDown"},pauseAfterPlaySwitchedTab:{id:110,name:"pauseAfterPlaySwitchedTab"},eligibilityLostScrolledUp:{id:111,name:"eligibilityLostScrolledUp"},eligibilityLostScrolledDown:{id:112,name:"eligibilityLostScrolledDown"},eligibilitySwitchedTab:{id:113,name:"eligibilitySwitchedTab"},oneSecondNoPlaySamePlace:{id:114,name:"oneSecondNoPlaySamePlace"},oneSecondNoPlayScrolledUp:{id:115,name:"oneSecondNoPlayScrolledUp"},oneSecondNoPlayScrolledDown:{id:116,name:"oneSecondNoPlayScrolledDown"},displayingFullNAS:{id:125,name:"displayingFullNAS"},displayingNASTitleOnly:{id:126,name:"displayingNASTitleOnly"},adPausedOtherUnitIsPlaying:{id:127,name:"adPausedOtherUnitIsPlaying"},rvBlockedInQ:{id:128,name:"rvBlockedInQ"},reportingObserver:{id:129,name:"reportingObserver"},noReplayForHipAdjacAd:{id:140,name:"noReplayForHipAdjacAd"},adPlayingNextAdReadyRV1:{id:142,name:"adPlayingNextAdReadyRV1"},adResumeAfterSwapOut:{id:145,name:"adResumeAfterSwapOut"},adPlayingRV1insteadRV0:{id:158,name:"adPlayingRV1insteadRV0"},skipVimp1Vimp1Playing:{id:160,name:"skipVimp1Vimp1Playing"},adEligibleAfterImpression:{id:161,name:"adEligibleAfterImpression"}},sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&er(e,t)}(l,e);var t,i,r,o=tr(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e.model)).model=e.model,t.adData=e.adData,t.reportFunc=e.reportFunc,t.getAdData=e.getAdDataFunc,t.setDebugData=e.setDebugData,t.vpaidData=e.vpaidData,t.log=new s.Z({unitType:t.model.get("unitType"),className:"oppsService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictId=e.predictId,t.oppManager=new Zn({"auc-dast":t.model.get("cmDast"),pt:rr.crc32(t.model.get("abTest")||999)},{billableEvents:t.model.get("billableEvents"),oppUrl:t.model.get("player.urls.oppsRequest"),nonBllbOppUrl:t.model.get("player.urls.nonBllboppsRequest")}),t.isViewed=!1,t.hadConversion=!1,t.hadImpression=!1,t.isFirstPlayForAd=!0,t.pageEventHistory=window.cmTag.PEH,t.unifiedPlacementEH=window.cmTag.UPEH,t._bindEvents(),t._fireUnitImpression(),t}return t=l,(i=[{key:"_bindEvents",value:function(){}},{key:"_fireUnitImpression",value:function(){this._fireOpp(or.unitImpression.id,or.unitImpression.name),this.reportFunc(or.unitImpression.name,{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime")},!0),this.model.get("hadEligibility")||this.reportFunc("waitingForEligibilty",{tab:this.model.get("isInTab")},!1)}},{key:"fireSkipVimp1EligibilityLost",value:function(e){if(e){this._fireOpp(or.skipVimp1EligibilityLost.id,or.skipVimp1EligibilityLost.name);var t=this.subModel?this.subModel.get("videoViewContainer"):this.model.get("videoViewContainer");if(!t){var i=(0,E.default)(this.subModel?this.subModel.get("parentSelector"):this.model.get("parentSelector"));t=rr.isArray(i)?i[0]:i}this.adData.pap=rr.offsetFromBottomOfViewPort(t)+(0,E.default)(t).height()>0?1:0,this.model.get("isInTab")?this.adData.pap?(this._fireOpp(or.eligibilityLostScrolledUp.id,or.eligibilityLostScrolledUp.name),this.reportFunc(or.eligibilityLostScrolledUp.name,{},!0)):(this._fireOpp(or.eligibilityLostScrolledDown.id,or.eligibilityLostScrolledDown.name),this.reportFunc(or.eligibilityLostScrolledDown.name,{},!0)):(this._fireOpp(or.eligibilitySwitchedTab.id,or.eligibilitySwitchedTab.name),this.reportFunc(or.eligibilitySwitchedTab.name,{},!0))}this.reportFunc(or.skipVimp1EligibilityLost.name,{},!1)}},{key:"fireSkipVimp1AdIsPlaying",value:function(e){var t=e===n.RV_TYPES.NON_RV?or.skipVimp1Vimp0Playing:or.skipVimp1Vimp1Playing;this._fireOpp(t.id,t.name),this.reportFunc(t.name,{otherAdRequiredViewbility:this.model.get("activeAdData.requiredViewability"),otherAdPlayerSequenceId:this.model.get("activeAdData.tagData.sequenceId"),otherAdDp:this.model.get("activeAdData.dp")},!1)}},{key:"fireLostCardEligibility",value:function(){this._fireOpp(or.lostCardEligibility.id,or.lostCardEligibility.name)}},{key:"onConversion",value:function(){this.hadConversion||(this.shouldFirePauseAfterPlay=!0,this.hadConversion=!0,this._fireOpp(or.conversion.id,or.conversion.name),this.reportFunc(or.conversion.name,{},!0))}},{key:"fireAdUnmuted",value:function(){this.adUnmutedOppFired||(this._fireOpp(or.adUnmuted.id,or.adUnmuted.name),this.adUnmutedOppFired=!0)}},{key:"fireUserAdUnmuted",value:function(){this.userAdUnmutedOppFired||(this._fireOpp(or.userAdUnmuted.id,or.userAdUnmuted.name),this.userAdUnmutedOppFired=!0)}},{key:"onFirstPauseAfterPlay",value:function(){if(this.shouldFirePauseAfterPlay&&!this.isViewed){this.shouldFirePauseAfterPlay=!1;var e=this.subModel?this.subModel.get("videoViewContainer"):this.model.get("videoViewContainer");e=rr.isArray(e)?e[0]:e,this.adData.pap=rr.offsetFromBottomOfViewPort(e)+(0,E.default)(e).height()>0?1:0,this._fireOpp(or.pauseAfterPlay.id,or.pauseAfterPlay.name),this.reportFunc(or.pauseAfterPlay.name,{tab:this.model.get("isInTab")},!0),this.model.get("isInTab")?this.adData.pap?(this._fireOpp(or.pauseAfterPlayScrolledUp.id,or.pauseAfterPlayScrolledUp.name),this.reportFunc(or.pauseAfterPlayScrolledUp.name,{},!0)):(this._fireOpp(or.pauseAfterPlayScrolledDown.id,or.pauseAfterPlayScrolledDown.name),this.reportFunc(or.pauseAfterPlayScrolledDown.name,{},!0)):(this._fireOpp(or.pauseAfterPlaySwitchedTab.id,or.pauseAfterPlaySwitchedTab.name),this.reportFunc(or.pauseAfterPlayScrolledUp.name,{},!0))}}},{key:"onViewabilityOneS",value:function(){this._fireOpp(or.viewabilityOneS.id,or.viewabilityOneS.name)}},{key:"onViewability",value:function(){this.isViewed=!0,this._fireOpp(or.viewability.id,or.viewability.name),this.reportFunc(or.viewability.name,{},!0)}},{key:"onTwoSecAfterPlay",value:function(){this.model.get("opps.twoSecAfterPlay.isFire")&&this._fireOpp(or.twoSecAfterPlay.id,or.twoSecAfterPlay.name)}},{key:"onViewability100",value:function(){this._fireOpp(or.viewability100.id,or.viewability100.name)}},{key:"onViewabilityAMP",value:function(){this._fireOpp(or.viewabilityAMP.id,or.viewabilityAMP.name)}},{key:"onNoViewabilityAMP",value:function(){this._fireOpp(or.noViewabilityAMP.id,or.noViewabilityAMP.name)}},{key:"onCompView100",value:function(){this._fireOpp(or.compView100.id,or.compView100.name)}},{key:"fireContinueAd",value:function(){this.isContinueAdFired||(this.isContinueAdFired=!0,this._fireOpp(or.continueAd.id,or.continueAd.name),this.reportFunc(or.continueAd.name,{tab:this.model.get("isInTab")},!0))}},{key:"onAdClicked",value:function(){this._fireOpp(or.clickThru.id),this.reportFunc(or.clickThru.name,{},!0),this.model.set("clickThruState",a.clickThruState.waiting)}},{key:"onAdDetached",value:function(){this.model.get("opps.detach.isFire")&&(this._fireOpp(or.detach.id),this.reportFunc(or.detach.name,{},!0))}},{key:"onAdAttached",value:function(){this.model.get("opps.attach.isFire")&&(this._fireOpp(or.attach.id),this.reportFunc(or.attach.name,{},!0))}},{key:"onAdSliderClosed",value:function(){this.model.get("opps.sliderClosed.isFire")&&(this._fireOpp(or.sliderClosed.id),this.reportFunc(or.sliderClosed.name,{},!0))}},{key:"fireLearnMoreClick",value:function(){this._fireOpp(or.learnMoreClick.id)}},{key:"fireTitleContaineClick",value:function(e){var t=or[e];t&&this._fireOpp(t.id,t.name)}},{key:"_fireOpp",value:function(e,t,i){if(this.adData&&e)if(t&&this.log.info("Fire ".concat(t," opps")),!0===this.model.get("isOppsulaEnabled")&&zn().oppsula){var r={tagItem:this.adData,playerDAST:this.adData.pdast,debugData:this._isSendDebugData()?this._getDebugData():void 0,activeData:this.getAdData(),predictorId:this.predictId};zn().oppsula.send(r,e)}else{var o={rs:this.adData.sequenceId,st:n.ROLL_TYPE[this.adData.rollType],sts:this.model.get("playerRepeatCount"),os:Number(this.adData.waterfallTagId)+1,rst:e,d:Date.now()-this.adData.created,dast:this.adData.dast,vpd:this.adData.pubId,vptd:this.adData.tagId,pv:this.model.get("playerVersion"),dp:rr.crc32(this.adData.dp),vmt:Number(this.adData.isRon)||0,abt:this._getAbTest(),vstt:this.model.get("isInTab")?1:0,agl:this.model.get("preset.level")?this.model.get("preset.level"):1,pdast:this.adData.pdast,ft:this.model.get("frameType"),ttv:this.adData.timeToVimp,bovpv:this.adData.bovpv,bovpg:this.adData.bovpg,be:this.model.get("playerHasRvInQ")?1:0,pap:void 0!==this.adData.pap?this.adData.pap:"",mty:this.adData.mty,extpvid:window.TRCImpl&&window.TRCImpl.external_page_view,rv:this.adData.requiredViewability,prdid:this.predictId};this._setSubUnitData(e,o),this._setCmTagParams(o),this._setModifiedPlacement(o),this._sendDebugDataReporting(o,e),this.oppManager.send(o,i)}}},{key:"_getAbTest",value:function(){return"".concat(this.model.get("abTest")).concat(this.adData.requiredViewabilityDrawn?"!ronrv":"").concat(this.adData.moatSampling?"!mtsmp":"").concat(rr.isMidArticleOnReadMorePage(this.model.get("isHip"))?"!rdmr":"")}},{key:"isBillableEvent",value:function(e){return this.model.get("billableEvents").indexOf(e)>-1}},{key:"setSubModel",value:function(e){this.subModel=e}},{key:"_onSecondsToCloseGlobal",value:function(){this.reportFunc("secondsToCloseGlobal",{},!0)}},{key:"_onCloseButtonClick",value:function(){this.reportFunc("closeButtonClick",{},!0)}},{key:"_setSubUnitData",value:function(e,t){var i=this.model.get("isFireSP");for(var n in i){if(e!==parseInt(n)||!i[n])break;var r=this.getAdData();void 0!==r.sp&&(t.sp=r.sp)}var o=this.model.get("subUnitType");this.model&&(o||0===o)&&(t.su=o)}},{key:"_setModifiedPlacement",value:function(e){var t=this.model.get("modifiedPlacement");t&&(e.mp=t)}},{key:"_setCmTagParams",value:function(e){var t=this.model.get("oppsQS")||{};rr.assignWithoutUndefinedValues(e,t)}},{key:"fireContinueAdInAnotherCard",value:function(){this._fireOpp(or.continueAdInAnotherCard.id,or.continueAdInAnotherCard.name),this.reportFunc(or.continueAdInAnotherCard.name,{},!0)}},{key:"fireShouldContinueAdInAnotherCard",value:function(){this._fireOpp(or.shouldContinueAdInAnotherCard.id,or.shouldContinueAdInAnotherCard.name),this.reportFunc(or.shouldContinueAdInAnotherCard.name,{},!0)}},{key:"adProgressionBeforeEndPredict",value:function(){this.model.get("opps.adProgressionBeforeEndPredict.isFire")&&this._fireOpp(or.adProgressionBeforeEndPredict.id,or.adProgressionBeforeEndPredict.name)}},{key:"adProgressionAfterBeginPredict",value:function(){this.model.get("opps.adProgressionAfterBeginPredict.isFire")&&this._fireOpp(or.adProgressionAfterBeginPredict.id,or.adProgressionAfterBeginPredict.name)}},{key:"_sendDebugDataReporting",value:function(e,t){this._isSendDebugData()&&(e.dbg=this._getDebugData(),this.model.get("isSendDebugDataReportingLog")&&this.log.info("DBG-Opp ".concat(t," - ").concat(e.dbg)))}},{key:"_getDebugData",value:function(){return new Gn({model:this.model,subModel:this.subModel,adData:this.adData,onDebugDataChange:this.setDebugData,isViewed:this.isViewed,predictName:this.adData.pn}).getDebugData()}},{key:"_isSendDebugData",value:function(){if(this.model.get("isSendDebugDataReporting"))return!0;var e=this.model.get("debugData.advertisersToReport")||"",t=this.vpaidData.advId;return e.toString().indexOf(t)>-1}},{key:"adSwappedOut",value:function(){this._fireOpp(or.adSwappedOut.id,or.adSwappedOut.name),this.reportFunc(or.adSwappedOut.name,{},!0)}},{key:"adSwappedIn",value:function(){this._fireOpp(or.adSwappedIn.id,or.adSwappedIn.name),this.reportFunc(or.adSwappedIn.name,{},!0)}},{key:"adResumeAfterSwapOut",value:function(){this._fireOpp(or.adResumeAfterSwapOut.id,or.adResumeAfterSwapOut.name),this.reportFunc(or.adResumeAfterSwapOut.name,{},!1)}},{key:"onOneSecondNoPlaySamePlace",value:function(){this._fireOpp(or.oneSecondNoPlaySamePlace.id,or.oneSecondNoPlaySamePlace.name),this.reportFunc(or.oneSecondNoPlaySamePlace.name,{},!0)}},{key:"onOneSecondNoPlayScrolledUp",value:function(){this._fireOpp(or.oneSecondNoPlayScrolledUp.id,or.oneSecondNoPlayScrolledUp.name),this.reportFunc(or.oneSecondNoPlayScrolledUp.name,{},!0)}},{key:"onOneSecondNoPlayScrolledDown",value:function(){this._fireOpp(or.oneSecondNoPlayScrolledDown.id,or.oneSecondNoPlayScrolledDown.name),this.reportFunc(or.oneSecondNoPlayScrolledDown.name,{},!0)}},{key:"onDisplayingFullNAS",value:function(){this._fireOpp(or.displayingFullNAS.id,or.displayingFullNAS.name),this.reportFunc(or.displayingFullNAS.name,{},!0)}},{key:"onDisplayingNASTitleOnly",value:function(){this._fireOpp(or.displayingNASTitleOnly.id,or.displayingNASTitleOnly.name),this.reportFunc(or.displayingNASTitleOnly.name,{},!0)}},{key:"fireGenericOpp",value:function(e){var t=or[e];t&&(this._fireOpp(t.id,t.name),this.reportFunc(t.name,{},!0))}},{key:"fireBeaconOpp",value:function(e){var t=or[e];t&&(this._fireOpp(t.id,t.name,!0),this.reportFunc(t.name,{},!0))}},{key:"onHipAdjacAdWithoutReplay",value:function(){this._fireOpp(or.noReplayForHipAdjacAd.id,or.noReplayForHipAdjacAd.name),this.reportFunc(or.noReplayForHipAdjacAd.name,{},!0)}},{key:"onAdPlayingNextAdReadyRV1",value:function(){this._fireOpp(or.adPlayingNextAdReadyRV1.id,or.adPlayingNextAdReadyRV1.name),this.reportFunc(or.adPlayingNextAdReadyRV1.name,{},!0)}},{key:"onAdPlayingRV1StackWithRV0",value:function(){this._fireOpp(or.adPlayingRV1insteadRV0.id,or.adPlayingRV1insteadRV0.name),this.reportFunc(or.adPlayingRV1insteadRV0.name,{},!0)}},{key:"fireAdEligibleAfterImpression",value:function(){this._fireOpp(or.adEligibleAfterImpression.id,or.adEligibleAfterImpression.name),this.reportFunc(or.adEligibleAfterImpression.name,{},!0)}}])&&Jn(t.prototype,i),r&&Jn(t,r),l}(o.O),ar=sr,lr=i(914),cr=i(2167),dr=i.n(cr);function ur(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hr=i(1999),pr=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.kibana=i,this.videoElRegexIdentifier=new RegExp(/^_cm/),this.log=new s.Z({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var t,i,n;return t=e,(i=[{key:"detect",value:function(){!this.stopped&&this.model.get("clsDetector.isActive")&&window.TRC&&this.kibana&&(this.clsEventListener=window.TRC.listen("onCls",this._onClsEvent.bind(this)))}},{key:"_onClsEvent",value:function(e){var t=this;e&&e.sources&&hr.forEach(e.sources,(function(e){e.node&&(t._isElementRelatedToVideo(e.node.id)||t._isElementRelatedToVideo(e.node.className))&&t._logSourceToKibana(e)}))}},{key:"_isElementRelatedToVideo",value:function(e){try{return e&&e.match(this.videoElRegexIdentifier)}catch(e){return!1}}},{key:"_logSourceToKibana",value:function(e){this.log.info("cls event - video element",e),this.kibana.onCls({el:"".concat(this._joinValues(e.node.id,"#")," ").concat(this._joinValues(e.node.className,".")),delta:hr.getDeltaBetweenRects(e.currentRect,e.previousRect)})}},{key:"_joinValues",value:function(e,t){return"".concat(t).concat((e||"").split(" ").join(t))}},{key:"stop",value:function(){this.stopped||(this.stopped=!0,this.clsEventListener&&this.clsEventListener.remove&&this.clsEventListener.remove(),this.clsEventListener=void 0)}}])&&ur(t.prototype,i),n&&ur(t,n),e}(),fr=pr;function mr(e){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr(e)}function gr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yr(e,t){return yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},yr(e,t)}function vr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=_r(e);if(t){var r=_r(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return br(this,i)}}function br(e,t){if(t&&("object"===mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _r(e){return _r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_r(e)}var wr=i(1999),Tr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yr(e,t)}(l,e);var t,i,r,o=vr(l);function l(e){var t,i=e.model,n=e.ppKey,r=e.adId,c=e.impressionCb,d=e.completeCb,u=e.kibana,h=e.predictName,p=e.getAdProperties,f=e.predictId;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,i)).model=i,t._handleKibana(u),t.getAdKey=isNaN(parseInt(n))?n:parseInt(n),t.adId=r,t.impressionCb=c,t.completeCb=d,t.predictName=h,t.predictId=f,t.scrollManager=new V,t.getAdProperties=p||{},t.handleAdjacencyAd(),t.log=new s.Z({unitType:t.model.get("unitType"),className:"adService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.adState=a.readyState,t.getAdState=a.getAdState.notCalled,t.adQState=a.adQState.readyState,t.hadPlay=!1,t.isActive=!1,t.hadImpression=!1,t.sizeObj={},t.adClickCounter=1,t.onAdImpressionTimer=null,t._bindEvents(),t._onPlayerStateReady(),t._getAd(),t.isLostView100=!1,t}return t=l,i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adManagerState:paused",funcName:"_pauseGetAd",isListenOnce:!0},{event:"adManagerState:stopped",funcName:"_stopGetAd",isListenOnce:!0},{event:"playerState:ready",funcName:"_onPlayerStateReady",isListenOnce:!0},{event:"adViewabilityFired:true",funcName:"adViewabilityFired",isListenOnce:!0},{event:"adConversionFired:true",funcName:"adConversionFired",isListenOnce:!0}])}},{key:"_onPlayerStateReady",value:function(){!this.player&&zn().player&&(this.player=zn().player)}},{key:"_pauseGetAd",value:function(){this.cancelGetAd(),this.getAdState=a.getAdState.stopped,this.setToModel("getAdState",a.getAdState.stopped),this.model.get("isReplayAd")||(this.player=void 0)}},{key:"_stopGetAd",value:function(){this.cancelGetAd(),this.getAdState=a.getAdState.finished,this.player=void 0}},{key:"adViewabilityFired",value:function(){if(this._hasVpaidWrapper()&&this.vpaidWrapper.emit){this.vpaidWrapper.emit("unit::viewability");var e=this.vpaidWrapper.getVpaidData(),t=e&&e.eventTrackers&&e.eventTrackers.viewability;wr.each(t,this._sendPixel,this)}this.isViewabilityFired=!0}},{key:"adConversionFired",value:function(){this._hasVpaidWrapper()&&this.vpaidWrapper.emit&&(this._setBottomOfVViewPort(),this.vpaidWrapper.emit("unit::conversion"))}},{key:"_getAd",value:function(){if(!this._hasPlayer()||!this.player.getAd)return this.setToModel("getAdCurrId",this.adId),void setTimeout(this.setToModel.bind(this,"getAdState",a.getAdState.failed),0);if(this.getAdState!==a.getAdState.gettingAd){if(this.adRequestTime=Date.now(),this.model.get("bottomOfViewPortDebugSelector")){var e=(0,E.default)(this.model.get("bottomOfViewPortDebugSelector"));this.bottomOfViewPortOnGetAd=e.length>0&&wr.offsetFromBottomOfViewPort(e[0])}this.log.info("GetAd was called, requiredViewability: ".concat(this.getAdKey,", time =").concat(this.adRequestTime," ")),this.getAdPPS=this.scrollManager.pps,this.getAdPPSChange=this.scrollManager.ppsChange,this.setToModel("lastGetAdKey",this.getAdKey),this.model.get("getAdState")===a.getAdState.gettingAd?this.model.trigger("change:getAdState",this.model,this.model.get("getAdState")):this.setToModel("getAdState",a.getAdState.gettingAd),this.getAdState=a.getAdState.gettingAd;var t=this.model.get("exploreMore")>0,i=new Gn({model:this.model,predictName:this.predictName}),n={getAdTimeout:this._getTimeOut(),adProperties:this.getAdProperties.adProperties,excAdProperties:this.getAdProperties.excAdProperties,forceWf:t,getDebugData:i.getDebugData.bind(i),predictId:this.predictId};"any"!==this.getAdKey&&(n.requiredViewability=this.getAdKey),this.getAdResult=this.player.getAd(n),this._sendEventToKibana(this.kibanaEvents.getAd,{getAdKey:this.getAdKey,predictName:this.predictName}),this.getAdResult?this.getAdResult.then(this._getAdResult.bind(this)).catch(this._getAdCatch.bind(this)):this.log.error("getAd Failed in auction  manager")}else this.log.info("[adID=${trimmedBranch}]getAd was called while trying to get an ad from player",this.adId)}},{key:"_getAdResult",value:function(e){try{if(wr.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoGotAd",n.TRC_PERFORMANCE_ACTIONS.START),this.vpaidWrapper=e,this._setAdTypeConfig(),this._setCLSDetector(),this.rpox=e.tag.rpox,this.vpaidData=this.vpaidWrapper.getVpaidData(),this.adData=wr.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon","requiredViewability","rpox"]),this.adData.cpm=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.vastPrice?this.vpaidWrapper.tag.vpaidWrapperData.vastPrice:this.vpaidWrapper.tag.price,this.adData.requiredViewability=wr.parseBool(this.adData.requiredViewability),this.adData.getAdPPS=this.getAdPPS,this.adData.getAdPPSChange=this.getAdPPSChange,this.adData.timeToVimp=Date.now()-this.adRequestTime,this.model.get("bottomOfViewPortDebugSelector")&&this.bottomOfViewPortOnGetAd){var t=(0,E.default)(this.model.get("bottomOfViewPortDebugSelector"));this.adData.bovpg=!!this.bottomOfViewPortOnGetAd&&parseInt(this.bottomOfViewPortOnGetAd),this.adData.bovpv=t.length>0&&parseInt(wr.offsetFromBottomOfViewPort(t[0]))}this.adData.dast=this.vpaidWrapper.tag.vidDast||this.vpaidWrapper.tag.dast,this.adData.mty=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.mediatype?this.vpaidWrapper.tag.vpaidWrapperData.mediatype:void 0,this.adData.moatSampling=this.vpaidWrapper.tag.moatSampling||!1,this.adData.requiredViewabilityDrawn=this.vpaidWrapper.tag.requiredViewabilityDrawn||!1,this.vpaidWrapper.playerDAST&&this.vpaidWrapper.playerDAST.get&&(this.adData.pdast=this.vpaidWrapper.playerDAST.get()),this._setDebugReportDataOnGotAd(),this.vpaidWrapper.vpaidLog.data.unit_history=[],this.reportToVpaid("gotAd",{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime"),predictName:this.predictName,getAdKey:"any"===this.getAdKey?10:this.getAdKey},!1),this.adData&&(zn().supportTool.dp[this.adId]=this.adData.dp),this.setToModel("lastGotAdData",this.adData),this.model.get("lastImpressionData.sequenceId")?this.sequenceId=this.model.get("lastImpressionData.sequenceId")+1:this.sequenceId=1;var i=void 0;return this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(i=this.vpaidWrapper.vpaidLog.data._id),this.lastImpressionData={predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag.requiredViewability,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag.dp,tagData:wr.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:i,lineItemId:this.vpaidWrapper.tag.lineItemId,predictName:this.predictName},this.setToModel("lastImpressionData",this.lastImpressionData),this._sendEventToKibana(this.kibanaEvents.gotAd,this.lastImpressionData),this.setToModel("impressionCount",this.model.get("impressionCount")+1),this.oppsService=new ar({model:this.model,adData:this.adData,vpaidData:this.vpaidData,reportFunc:this.reportToVpaid.bind(this),getAdDataFunc:this.getAdData.bind(this),setDebugData:this.vpaidWrapper.setDebugData.bind(this.vpaidWrapper),predictId:this.predictId}),this.vpaidWrapper.setDebugDataFunc&&this.vpaidWrapper.setDebugDataFunc(this.oppsService._getDebugData.bind(this.oppsService)),this.log.info("GotAd requiredViewability: ".concat(e.tag.requiredViewability?1:0)),this.getAdState=a.getAdState.gotAd,this.setToModel("getAdState",a.getAdState.gotAd),this.getAdResult=void 0,this._registerListeners(),this._onAdImpression(e),this._setAdRV(),null}catch(e){this.log.error(e)}finally{wr.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoGotAd",n.TRC_PERFORMANCE_ACTIONS.STOP)}}},{key:"_getAdCatch",value:function(e){this.hadImpression||(this.getAdResult=void 0,this.log.info("GetAd failed requiredViewability: ".concat(this.getAdKey),this.adId),this.getAdState=a.getAdState.failed,this.setToModel("getAdCurrId",this.adId),this.setToModel("getAdState",a.getAdState.failed))}},{key:"_registerListeners",value:function(){this.vpaidWrapper.on&&(this.vpaidWrapper.on("AdError",this._onAdError.bind(this)),this.vpaidWrapper.on("AdVideoFirstQuartile",this._onAdVideoFirstQuartile.bind(this)),this.vpaidWrapper.on("AdVideoMidpoint",this._onAdVideoMidpoint.bind(this)),this.vpaidWrapper.on("AdVideoThirdQuartile",this._onAdVideoThirdQuartile.bind(this)),this.vpaidWrapper.on("end",this._adVideoEnd.bind(this)),this.vpaidWrapper.on("AdClickThru",this._onAdClickThru.bind(this)),this.vpaidWrapper.on("activeAdCurrentTime",this._onActiveAdCurrentTime.bind(this)),this.vpaidWrapper.on("NewCompletion",this._onNewCompletion.bind(this)))}},{key:"_setCLSDetector",value:function(){this.clsDetector=new fr(this.model,this.kibana),this.clsDetector.detect()}},{key:"_onActiveAdCurrentTime",value:function(e){this.isCompleted||(this.setToModel("activeAdCurrentTime",e.currentTime),this.setToModel("activeAdMaxTime",e.duration))}},{key:"_onAdImpression",value:function(e){this.vpaidWrapper.pauseAd(),this._sendEventToKibana(this.kibanaEvents.adPaused,{pauseReason:"pauseOnAdImpression"}),this.reportToVpaid("pauseAdCalled",{reason:"pauseOnAdImpression",tab:this.model.get("isInTab")},!1),this._bringToBack(),this.log.info("onAdImpression (got ad - pausing ad)",this.adId),this.hadImpression=!0,this.rpox=e.tag.rpox,this.adQState=a.adQState.impression;var t={lineItemId:this.model.get("lineItemId"),placement:this.model.get("placement"),redId:this.model.get("redId")};this.model.get("isSendCPM")&&(t.cpm=this.adData.cpm),k().trigger("onImpression",t);var i=e.getVpaidData();this.adData.timeToImpression=i.startTimestamp?Date.now()-i.startTimestamp:void 0,this.model.get("adQState")===a.adQState.impression?setTimeout(this.model.trigger.bind(this.model,"change:adQState",this.adQState),0):setTimeout(this.setToModel.bind(this,"adQState",this.adQState),0),this.impressionCb(this),wr.sendingEventToTaboolaBridge("impression",this.adId),this.adData.requiredViewability&&(this.setToModel("player.settings.startDelay",0),this._startOneSecondNoPlayTimer())}},{key:"_onAdError",value:function(e){this.log.error("Vpaid Wrapper Error, key: "+this.getAdKey,this.adId),wr.sendingEventToTaboolaBridge("adError",this.adId)}},{key:"_onAdVideoFirstQuartile",value:function(){this.hadPlay&&(this.adQState=a.adQState.q1,this.setToModel("adQState",a.adQState.q1,this.adId),this.log.info("AdVideoFirstQuartile"),wr.sendingEventToTaboolaBridge("firstQuartile",this.adId))}},{key:"_onAdVideoMidpoint",value:function(){this.hadPlay&&(this.adQState=a.adQState.q2,this.setToModel("adQState",a.adQState.q2,this.adId),this.log.info("AdVideoMidpoint"),wr.sendingEventToTaboolaBridge("midpoint",this.adId))}},{key:"_onAdVideoThirdQuartile",value:function(){this.hadPlay&&(this.adQState=a.adQState.q3,this.setToModel("adQState",a.adQState.q3,this.adId),this.log.info("AdVideoThirdQuartile"),wr.sendingEventToTaboolaBridge("thirdQuartile",this.adId))}},{key:"_adVideoEnd",value:function(){if(this.player){var e=this.subModel||this.model;if(this.model.get("isReplayAd")||e.stopListening(e,"change:nativeAdClick"),this._setAdPlayingWithAdChoice(!1),this.log.info("on ad video end",this.adId),this.reportToVpaid("vpaidDone",{tab:this.model.get("isInTab")},!0),this.isCompleted=!0,!this.hadPlay)return this.adState=a.adState.autoKill,void this.completeCb(this,!0);this._sendEventToKibana(this.kibanaEvents.adComplete),this.setToModel("activeTag",void 0),this.adQState=a.adQState.completed,this.adState=a.adState.completed,this.completeCb(this,!1),this.model.get("isReplayAd")||(this.vpaidWrapper=void 0,this.setToModel("activeAdData",void 0)),this.setOrTrigger("adQState",this.adQState),this.setOrTrigger("adState",this.adQState),this.getAdState=a.getAdState.stopped,zn().supportTool.dp[this.adId]=void 0,delete zn().supportTool.dp[this.adId],wr.sendingEventToTaboolaBridge("complete",this.adId),this.onCompView100(),this._stopRV1Observer(),this.clsDetector&&this.clsDetector.stop()}}},{key:"_onAdClickThru",value:function(){1===this.adClickCounter?(this.setToModel("clickThruState",a.clickThruState.clicked),this.oppsService.onAdClicked(),wr.sendingEventToTaboolaBridge("adClick",this.adId),this.reportToVpaid("firstAdClick",{number:this.adClickCounter},!1)):this.reportToVpaid("falseAdClick",{number:this.adClickCounter},!1),this.adClickCounter++}},{key:"_onTitleContainerClick",value:function(){if(this._hasVpaidWrapper()){var e=this.vpaidWrapper.getVpaidData(),t=this.getFromModel("adNativeSettings").link||e.vastClickThruLink;t&&this._clickThru(t);var i=this.getFromModel("nativeAdClick");this.oppsService.fireTitleContaineClick(i),this._onAdClickThru()}}},{key:"_clickThru",value:function(e){if(this.model.get("isInApp")&&window.taboolaMobile&&window.tbNativeBridge){var t=window.tbNativeBridge;if(t.invoke)return void t.invoke("onClick",["",e,e,!1,"0","video"])}window.open(e)}},{key:"_bringToFront",value:function(){if(this.vpaidWrapper.localTarget){var e=this.model.get("style.videoBackgroundColor");(0,E.default)(this.vpaidWrapper.localTarget).css({zIndex:1e3,display:"block",backgroundColor:e})}}},{key:"_bringToBack",value:function(){this.vpaidWrapper.localTarget&&(0,E.default)(this.vpaidWrapper.localTarget).css({zIndex:0})}},{key:"_hasVpaidWrapper",value:function(){return this._hasPlayer()&&this.vpaidWrapper}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"setActiveTag",value:function(){this.log.info("setActiveTag",this.adId);var e=wr.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]);this.model.get("activeTag")!==e&&this.setToModel("activeTag",e)}},{key:"getAdData",value:function(){if(this.vpaidWrapper){var e=void 0;this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(e=this.vpaidWrapper.vpaidLog.data._id);var t={adId:this.adId,predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag?wr.parseBool(this.vpaidWrapper.tag.requiredViewability):void 0,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag?this.vpaidWrapper.tag.dp:void 0,rpox:this.rpox,isCompleted:this.isCompleted,tagData:wr.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:e};return this._setSubUnitData(t),t}}},{key:"isPWOV",value:function(){return!(!this.vpaidWrapper||!this.vpaidWrapper.pwov)&&this.model.get("isPWOV")&&wr.isFactor(100/this.vpaidWrapper.pwov)}},{key:"pause",value:function(){if((this.model.get("isInTab")&&"continueAd"===this.model.get("onOutOfView")||this.isPWOV())&&this.isViewabilityFired&&!this.model.get("blockedByExternalUnit"))return this.log.info("onOutOfView continueAd",this.adId),this.setToModel("adState",a.adState.continueAd),this.adState=a.adState.continueAd,this.oppsService.fireContinueAd(),this._sendEventToKibana(this.kibanaEvents.continueAd),void(this.isLostView100=!0);this._hasVpaidWrapper()&&(this.log.info("Pause ad",this.adId),this.vpaidWrapper.pauseAd(),this._setBottomOfVViewPort(),this.oppsService.onFirstPauseAfterPlay(),this._sendEventToKibana(this.kibanaEvents.adPaused,{pauseReason:"outOfView"}),this.reportToVpaid("pauseAdCalled",{reason:"outOfView",tab:this.model.get("isInTab")},!1)),this.setToModel("adState",a.adState.paused),this.adState=a.adState.paused}},{key:"skipAd",value:function(){this.log.info("Skip ad",this.adId),this.setToModel("isReplayAd",!1),this._hasVpaidWrapper()&&this.vpaidWrapper.skipAd(),this.setToModel("adState",a.adState.skipped)}},{key:"play",value:function(){this.clearOnAdImpressionTimer(),this.model.set("lastActiveAd",this.adId),this.log.info("playing ad",this.adId);var e=this.getAdData();this.setToModel("activeAdData",e),this._hasVpaidWrapper()&&(this._updateAdChoiceVisibility(),this._keepReplayableAdAlive(),this.model.get("isToggleIframeContent")&&this.vpaidWrapper.toggleIframeContentDisplay&&this.vpaidWrapper.toggleIframeContentDisplay("show")),this.hadPlay||(this.hadPlay=!0,this.log.info("Winning ad: "+this.getAdKey,this.adId),this.model.get("isMultiActiveAds")||(this._bringToFront(this.vpaidWrapper),(0,E.default)(this.vpaidWrapper.adTarget).removeClass("_cm-ad")),this.setActiveTag(),this._checkIfStartRV1Observer(),this.adQState=a.adQState.q0,this.setToModel("adQState",a.adQState.q0),this.setToModel("adDuration",this.vpaidData.duration),this._setDebugReportDataOnConversion(e),this.oppsService.onConversion(),this.adConversionFired(),this.setAdParametersToModel(),setTimeout(this._fireTwoSecAfterPlay.bind(this),2e3)),this._hasVpaidWrapper()?(this.log.info("resumeAd VpaidWrapper is alive ",this.adId),this._bringToFront(this.vpaidWrapper),this.vpaidWrapper.resumeAd(),this.model.set("hadPlayedAd",!0),this.reportToVpaid("resumeAdCalled",{tab:this.model.get("isInTab")},!1),this._sendEventToKibana(this.kibanaEvents.adPlay)):this.log.warning("resumeAd failed VpaidWrapper is NOT alive ",this.adId),setTimeout(this._firePlayEvents.bind(this),0),this.start||(this.start=!0,wr.sendingEventToTaboolaBridge("start",this.adId));var t=this.getCurrModel();this.isLostView100||(this.isLostView100=!t.get("isViewable100"),this.isViewabilityListenerSet||this.isLostView100||(t.on("change:isViewable100",this.onViewabile100Change.bind(this)),this.isViewabilityListenerSet=!0))}},{key:"_firePlayEvents",value:function(){this.adState=a.adState.playing,this.setToModel("adState",a.adState.playing),k().trigger("global:adState:playing")}},{key:"_fireTwoSecAfterPlay",value:function(){this.oppsService.onTwoSecAfterPlay()}},{key:"cancelGetAd",value:function(e){this.getAdResult&&(this.log.info("GetAd was cancelled",this.adId),this.getAdResult.cancel(e),this.getAdResult=void 0)}},{key:"setToModel",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model.set(e,t,i),this.subModel&&this.subModel.set(e,t,i)}},{key:"getFromModel",value:function(e){return this.subModel?this.subModel.get(e):this.model.get(e)}},{key:"setSubModel",value:function(e){this.subModel=e,this.oppsService&&this.oppsService.setSubModel(this.subModel)}},{key:"getCurrModel",value:function(){return this.subModel?this.subModel:this.model}},{key:"forceTrigger",value:function(e){this.model.trigger("change:"+e,this.model,this.model.get(e)),this.subModel&&this.subModel.trigger("change:"+e,this.subModel,this.subModel.get(e))}},{key:"setOrTrigger",value:function(e,t){this.model.get(e)===t?this.forceTrigger(e):this.setToModel(e,t)}},{key:"resize",value:function(e){e&&e.width&&e.height?this.sizeObj.width===e.width&&this.sizeObj.height===e.height||(this.sizeObj.width=e.width,this.sizeObj.height=e.height,this.log.info("resizing ad",E.default.extend({},e,{adId:this.adId,aspectRatio:this.aspectRatioString})),this.vpaidWrapper.resizeAd(e.width,e.height,this.aspectRatioString)):this.log.warning("resize was called with empty sizeObj!",e)}},{key:"recheckSize",value:function(){var e=this.sizeObj;this.sizeObj={},this.resize(e)}},{key:"mute",value:function(){this.vpaidWrapper&&(this.log.info("Mute Player"),this.vpaidWrapper.mute(),wr.sendingEventToTaboolaBridge("volumeChange",0))}},{key:"unmute",value:function(){this.vpaidWrapper&&(this.log.info("UnMute Player"),this.vpaidWrapper.unmute(),this.oppsService.fireAdUnmuted(),wr.sendingEventToTaboolaBridge("volumeChange",100))}},{key:"fireSkipVimp1EligibilityLost",value:function(e){this.clearOnAdImpressionTimer(),this.oppsService.fireSkipVimp1EligibilityLost(e)}},{key:"fireSkipVimp1AdIsPlaying",value:function(e){this.clearOnAdImpressionTimer(),this.oppsService.fireSkipVimp1AdIsPlaying(e)}},{key:"onAdPlayingRV1StackWithRV0",value:function(){this.oppsService.onAdPlayingRV1StackWithRV0()}},{key:"onViewability",value:function(){this.isViewed||(this.isViewed=!0,this.adViewabilityFired(),this.oppsService.onViewability(),this._sendEventToKibana(this.kibanaEvents.viewability))}},{key:"onViewabilityOneS",value:function(){this.isViewedOneS||(this.isViewedOneS=!0,this.oppsService.onViewabilityOneS())}},{key:"onViewability100",value:function(){this.isViewed100||(this.setToModel("viewability100",!0),this.isViewed100=!0,this.oppsService.onViewability100())}},{key:"onViewabilityAMP",value:function(){this.isViewedAMP||(this.isViewedAMP=!0,this.isNoViewedAMP=!0,this.oppsService.onViewabilityAMP())}},{key:"onNoViewabilityAMP",value:function(){this.isNoViewedAMP||(this.isNoViewedAMP=!0,this.oppsService.onNoViewabilityAMP())}},{key:"onCompView100",value:function(){this.isLostView100||this.isCompViewed100||(this.isCompViewed100=!0,this.oppsService.onCompView100())}},{key:"onDetached",value:function(){this.isDetached||(this.isDetached=!0,this.oppsService.onAdDetached())}},{key:"onAttached",value:function(){this.isDetached&&(this.isDetached=!1,this.oppsService.onAdAttached())}},{key:"onSliderClose",value:function(){this.isSliderClosed||(this.isSliderClosed=!0,this.oppsService.onAdSliderClosed())}},{key:"reportToVpaid",value:function(e,t,i){this._setSubUnitData(t),this._hasVpaidWrapper()&&this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.push&&(this.vpaidWrapper.vpaidLog.push("unit_".concat(e),t,!1),this.vpaidWrapper.vpaidLog.data&&this.vpaidWrapper.vpaidLog.data.unit_history&&this.vpaidWrapper.vpaidLog.data.unit_history.push&&this.vpaidWrapper.vpaidLog.data.unit_history.push(e),this.vpaidWrapper.vpaidLog.data.statuses.push(e),i&&this.vpaidWrapper.vpaidLog.push("unit_state",{status:e},i))}},{key:"reportRpoxSkip",value:function(e){this.reportToVpaid("skipRpox",{otherRpox:e.rpox,otherRequiredViewability:e.requiredViewability,otherAdDp:e.dp,otherSequenceId:e.sequenceId},!1)}},{key:"reportPpKeySkip",value:function(e){this.reportToVpaid("skipPpKey",{otherRpox:e.rpox,otherRequiredViewability:e.requiredViewability,otherAdDp:e.dp,otherSequenceId:e.sequenceId},!1)}},{key:"_setAdPlayingWithAdChoice",value:function(e){this.setToModel("adPlayingWithAdChoice",e)}},{key:"_updateAdChoiceVisibility",value:function(){this.vpaidWrapper.hasAdChoices?this._setAdPlayingWithAdChoice(!0):this._setAdPlayingWithAdChoice(!1)}},{key:"_setSubUnitData",value:function(e){var t=this.model.get("subUnitType");if(this.model&&(t||0===t)&&(e.su=t),this.subModel){var i=this.model.get("detachToSlider"),n=this.subModel.get("gotFirstEligibility");i&&i.isStartFromSlider&&i.isDetachToSlider?e.sp=n?this.subModel.get("cardNumber"):0:i&&i.isStartFromSlider&&!this.subModel.get("isEligibleToPlay")?e.sp=0:this.model.get("cardNumber")&&(e.sp=this.model.get("cardNumber"))}else this.model.get("MSNCard.row")&&(e.sp=this.model.get("MSNCard.row"))}},{key:"_handleKibana",value:function(e){this.kibanaEvents=n.KIBANA_EVENTS,e&&(this.kibana=e)}},{key:"_sendEventToKibana",value:function(e,t){this.kibana&&((t=t||{}).adId=this.adId,this.subModel&&this.subModel.get("cardNumber")&&(t.cardNumber=this.subModel.get("cardNumber")),this.kibana.adEvent(e,t))}},{key:"onCardSwap",value:function(){this.oppsService.fireContinueAdInAnotherCard()}},{key:"onShouldCardSwap",value:function(){this.oppsService.fireShouldContinueAdInAnotherCard()}},{key:"onLearnMoreClick",value:function(){this.oppsService.fireLearnMoreClick()}},{key:"_setDebugReportDataOnGotAd",value:function(){this.model.increaseCounter("sqv"),this.adData.requiredViewability?this.model.increaseCounter("rvvs1"):this.model.increaseCounter("rvvs0"),this.adData.pn=this.predictName,this.adData.adId=this.adId,this.adData.esv=this.vpaidData.earlySrcVPAID}},{key:"_setDebugReportDataOnConversion",value:function(){this.model.increaseCounter("conversionCount"),this.adData.requiredViewability?this.model.increaseCounter("rvps1"):this.model.increaseCounter("rvps0")}},{key:"_setAdRV",value:function(){this.adData.requiredViewability?this.setToModel("gotRvAd",!0):this.setToModel("gotNonRvAd",!0)}},{key:"_getTimeOut",value:function(){return this.model.get("vForce.secondsToGetAdFail.".concat(this.getAdKey))}},{key:"_setAdTypeConfig",value:function(){if(this.vpaidWrapper&&this.vpaidWrapper.getVpaidData){var e=this.vpaidWrapper.getVpaidData();for(var t in this.adTypeTranslator=new lr.default({model:this.subModel||this.model}),this.adTypeConfig={},e)if(e[t]){var i=this.adTypeTranslator.getConfigForKey(t);if(wr.isEmpty(i))continue;if(this.log.info("got adTypeConfig for key "+t,i),i.revertAfter){var n=this._createRevertAdType(i,t);this._setAdTypeConfigAfter(i.revertAfter,n)}i.setAdConfigAfter?this._setAdTypeConfigAfter(i.setAdConfigAfter,i):this.setToModel(i),this.adTypeConfig[t]=i}this.aspectRatioNum=this.getAspectRatioNum(e),this.log.info("Ad size received is - width: "+e.adWidth+"; height: "+e.adHeight),this._setAdTypeConfigAfter("setSubModel",{aspectRatioNum:this.aspectRatioNum}),this.supportVideoCurrentTimeEvents=e.supportVideoCurrentTimeEvents}}},{key:"_setAdTypeConfigAfter",value:function(e,t){var i=this[e];wr.isFunction(i)&&(this[e]=function(){i.apply(this,arguments),this.setToModel(t),this.log.info("setting ad type config after ".concat(i.name," function"),t)})}},{key:"_createRevertAdType",value:function(e,t){var i={};for(var n in e)"setAdConfigAfter"!==n&&"revertAfter"!==n&&(i[n]=this.model.get(n));return i}},{key:"onAdSetToUnits",value:function(){}},{key:"_keepReplayableAdAlive",value:function(){var e=this.vpaidWrapper;e.dontDie&&this.model.get("isReplayAd")&&(e.isReplayable||this.model.get("isForceDontDie"))&&(e.dontDie(),this.model.set("dontRenderRepeatButton",!e.isReplayable))}},{key:"setAdParametersToModel",value:function(){if(this.model.get("components.nativeAd.isActive")){var e=this.vpaidWrapper.getVpaidData(),t=e.adNativeSettings||{},i=this.subModel||this.model;e.adNativeSettings&&this.model.set("continueToPlayInNexCard.isActive",!1),this.setNativeAdClickListener(),this.setToModel("adNativeSettings",void 0,{silent:!0}),this.setToModel("adNativeSettings",t,{silent:!0}),i.trigger("change:adNativeSettings",i,i.get("adNativeSettings"))}this.vpaidWrapper.clickThruUrl?(this.log.info("updated click through URL",this.vpaidWrapper.clickThruUrl),this.setToModel("adClickThroughUrl",this.vpaidWrapper.clickThruUrl)):this.setToModel("adClickThroughUrl",""),this.setToModel("activeAdRV",this.adData.requiredViewability)}},{key:"_setTagDataToStorage",value:function(){try{this.model.setStorage("activeAdData",this.vpaidWrapper.tag)}catch(e){this.log.error("error setting activeAdData",{error:e,tag:this.vpaidWrapper.tag})}}},{key:"setNativeAdClickListener",value:function(){var e=this.subModel||this.model;e.listenTo(e,"change:nativeAdClick",this._onTitleContainerClick.bind(this))}},{key:"_sendPixel",value:function(e){"img"===e.method?(new Image).src=e.pixel:"js"===e.method&&this._sendJSPixel(e.pixel)}},{key:"_sendJSPixel",value:function(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.async=!0,document.body.appendChild(t)}},{key:"getAspectRatioNum",value:function(e){return e&&e.supportVerticalVideo?(this.aspectRatioString=e.adWidth.toString()+":"+e.adHeight.toString(),e.adWidth/e.adHeight):this.aspectRatioNum?this.aspectRatioNum:(this.aspectRatioString="16:9",this.model.get("defaultAspectRatioNum"))}},{key:"onadProgressionAfterBeginPredict",value:function(){this.oppsService.adProgressionAfterBeginPredict()}},{key:"onadProgressionBeforeEndPredictPredict",value:function(){this.oppsService.adProgressionBeforeEndPredict()}},{key:"onAdSwappedOut",value:function(){this.oppsService.adSwappedOut()}},{key:"onAdSwappedIn",value:function(){this.oppsService.adSwappedIn()}},{key:"onResumeAfterSwapOut",value:function(){this.oppsService.adResumeAfterSwapOut()}},{key:"_startOneSecondNoPlayTimer",value:function(){var e=(0,E.default)(this.subModel?this.subModel.get("parentSelector"):this.model.get("parentSelector"));this.mesureElement=wr.isArray(e)?e[0]:e,this.mesureElement&&(this.onImpressionPosition=wr.offsetFromBottomOfViewPort(this.mesureElement),this.onAdImpressionTimer=setTimeout(this._reportOneSecondNoPlay.bind(this),1e3))}},{key:"_reportOneSecondNoPlay",value:function(){null!==this.onAdImpressionTimer&&(this.onOneSecondPosition=wr.offsetFromBottomOfViewPort(this.mesureElement),this.onImpressionPosition===this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlaySamePlace(),this.onImpressionPosition>this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlayScrolledDown(),this.onImpressionPosition<this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlayScrolledUp())}},{key:"clearOnAdImpressionTimer",value:function(){this.onAdImpressionTimer&&(clearTimeout(this.onAdImpressionTimer),this.onAdImpressionTimer=null)}},{key:"onViewabile100Change",value:function(){var e=this.getCurrModel();this.model.get("adState")===a.adState.paused||e.get("isViewable100")||(this.isLostView100=!0)}},{key:"_onNewCompletion",value:function(){this.onCompView100()}},{key:"handleAdjacencyAd",value:function(){this.model.get("hasScAdjacency")&&(this.getAdProperties=wr.extend(this.getAdProperties,{excAdProperties:{adjacencyAd:[!0]}}))}},{key:"onDisplayingFullNAS",value:function(){this.firedDisplayingFullNAS||(this.firedDisplayingFullNAS=!0,this.oppsService.onDisplayingFullNAS())}},{key:"onDisplayingNASTitleOnly",value:function(){this.firedDisplayingNASTitleOnly||(this.firedDisplayingNASTitleOnly=!0,this.oppsService.onDisplayingNASTitleOnly())}},{key:"fireAdOppOnce",value:function(e){this["".concat(e,"Fired")]||(this["".concat(e,"Fired")]=!0,this.oppsService.fireGenericOpp(e))}},{key:"_stopRV1Observer",value:function(){this.AmpViewabilityHelper&&(this.AmpViewabilityHelper.stopObserver(this.targetElement),this.AmpViewabilityHelper=null)}},{key:"_checkIfStartRV1Observer",value:function(){this.model.get("frameType")===n.FRAME_TYPE.amp&&this.model.get("isUseAmpObserver")&&(this.AmpViewabilityHelper=new(dr())({model:this.model,subModel:this.subModel}),this.targetElement=this.vpaidWrapper.adTarget?this.vpaidWrapper.adTarget:this.vpaidWrapper.localTarget,this.targetElement&&(this.log.info("Winning ad vpaidWrapper: ",this.targetElement),this.AmpViewabilityHelper.startObserver(this.targetElement),this.createStateHandlers([{event:"isViewableAMP:false",funcName:"pause"},{event:"isViewableAMP:true",funcName:"play"}])))}},{key:"onHipAdjacAdWithoutReplay",value:function(){this.oppsService.onHipAdjacAdWithoutReplay()}},{key:"_setBottomOfVViewPort",value:function(){if(this.model.get("isReportBottomOfVViewPort")){var e=this.vpaidWrapper.adTarget;this.adData.bovpv=!!e&&parseInt(wr.offsetFromBottomOfViewPort(e))}}}],i&&gr(t.prototype,i),r&&gr(t,r),l}(o.O),Pr=Tr;function Sr(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sr(e)}function Ar(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Er(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Er(e,t)}function Cr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Or(e);if(t){var r=Or(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return kr(this,i)}}function kr(e,t){if(t&&("object"===Sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Or(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Or(e)}var Dr=i(1999);o.O;function Ir(e){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}function Rr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xr(e,t){return xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xr(e,t)}function Br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Fr(e);if(t){var r=Fr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Vr(this,i)}}function Vr(e,t){if(t&&("object"===Ir(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fr(e)}var Mr=i(1999),Nr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xr(e,t)}(s,e);var t,i,n,o=Br(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).model=e.model,t.events=r().KIBANA_EVENTS,t.startTime=e.startTime,t.predictors=e.predictors,t.adsList=[],t.getAdCount=0,t.impressionCount=0,t.dirtyAds=[],t._createEventList(),t}return t=s,(i=[{key:"_getAd",value:function(e){this.createAd(e.adId),this.getAdCount++;var t="any"===e.getAdKey?10:e.getAdKey,i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:e.eventTime-this.startTime,getAdTime:e.eventTime,getAdCount:this.getAdCount,predictPointKey:t,predictName:e.predictName,isInTab:this.model.get("isInTab"),topParentSelector:e.scrollData.topParentSelector};this.model.get("distancePercentPredictData")&&"distancePercentPredict"===e.predictName&&Mr.extend(i,this.model.get("distancePercentPredictData")),this.model.get("distancePixelPredictData")&&"distancePixelsPredict"===e.predictName&&Mr.extend(i,this.model.get("distancePixelPredictData")),Mr.extend(i,this._checkIsFirstGetAdType(e.getAdKey)),this._addDataToAd(this.events.getAd,e.adId,i,{hadImpression:!1,getAdKey:t}),this.isFirstGetAd&&(this.isFirstGetAd=!1)}},{key:"_checkIsFirstGetAdType",value:function(e){var t={isFirstGetAd:!1,isFirstNonRv:!1,isFirstRv:!1};return void 0===this.isFirstGetAd&&(t.isFirstGetAd=!0,this.isFirstGetAd=!1),0===e&&void 0===this.isFirstNonRv?(t.isFirstNonRv=!0,this.isFirstNonRv=!1):1===e&&void 0===this.isFirstRv&&(t.isFirstRv=!0,this.isFirstRv=!1),t}},{key:"_gotAd",value:function(e){this.createAd(e.adId),this.impressionCount++;var t={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:e.eventTime-this.adsList[e.adId].getAd.getAdTime,adImpressionTime:e.eventTime,scrollPercentageFromSelector:e.scrollData.scrollPercentageFromSelector,bottomViewPort:e.scrollData.bottomViewPort,topParentSelector:e.scrollData.topParentSelector,isInTab:this.model.get("isInTab"),isFirstImpression:1===this.impressionCount,isFirstRv:this.adsList[e.adId].getAd.isFirstRv,isFirstNonRv:this.adsList[e.adId].getAd.isFirstNonRv};t.hadLostEligibility=!!this.model.get("lostEligibilityTime"),this.model.get("lostEligibilityTime")&&(t.timeFromLostEligibility=e.eventTime-this.model.get("lostEligibilityTime")),Mr.extend(t,e);var i={hadImpression:!0,lineItemId:e.lineItemId,requiredViewability:e.requiredViewability};t.isFirstRv?(i.hadRvVimp=!0,this.hadRvVimp=!0):t.isFirstNonRv&&(i.hadNonRvVimp=!0,this.hadNonRvVimp=!0),e.requiredViewability?i.hadNonRvVimpBefore=this.hadNonRvVimp||!1:i.hadRvVimpBefore=this.hadRvVimp||!1,this._addDataToAd(this.events.gotAd,e.adId,t,i)}},{key:"_adPlay",value:function(e){this.createAd(e.adId);var t=!this.adsList[e.adId].hadConversion,i={timeFromAdImpression:e.eventTime-this.adsList[e.adId].gotAd.adImpressionTime,adPlayTime:e.eventTime,isInTab:this.model.get("isInTab"),isFirstConversion:!this.hadConversion,playPauseReason:this.model.get("playPauseReason")};Mr.extend(i,e);var n={hadConversion:!0};t&&(n.conversionTime=e.eventTime,this._addDataToAd(this.events.conversion,e.adId,i,n)),i.isFirstPlayForAd=t,this._addDataToAd(this.events.adPlay,e.adId,i,n),this.hadConversion||(this.hadConversion=!0)}},{key:"_adPaused",value:function(e){this.createAd(e.adId);var t={isInTab:this.model.get("isInTab"),pauseReason:e.pauseReason,playPauseReason:"pauseOnAdImpression"!==e.pauseReason?this.model.get("playPauseReason"):e.pauseReason};this.adsList[e.adId].conversionTime?t.timeFromAdPlay=e.eventTime-this.adsList[e.adId].conversionTime:t.timeFromAdImpression=e.eventTime-this.adsList[e.adId].gotAd.adImpressionTime,Mr.extend(t,e),this._addDataToAd(this.events.adPaused,e.adId,t)}},{key:"_viewability",value:function(e){this.createAd(e.adId);var t={timeFromAdPlay:e.eventTime-this.adsList[e.adId].conversionTime};Mr.extend(t,e),this._addDataToAd(this.events.viewability,e.adId,t,{hadViewability:!0})}},{key:"_completed",value:function(e){this.createAd(e.adId);var t={timeFromAdPlay:e.eventTime-this.adsList[e.adId].conversionTime};Mr.extend(t,e),this._addDataToAd(this.events.adComplete,e.adId,t,{isCompleted:!0})}},{key:"_continueAd",value:function(e){}},{key:"createAd",value:function(e){var t=this.adsList[e];return t||((t={adId:e,_id:Mr.generateGuid(10),countChanges:0,hadImpression:!1,hadConversion:!1,abTest:this.model.get("abTest"),pageUrl:window.location.href}).conf=this._createConf(),this.adsList[e]=t),t}},{key:"_createConf",value:function(){return{predictors:this.predictors,detachToSlider:this.model.get("detachToSlider"),unitType:this.model.get("unitType"),version:this.model.get("version")}}},{key:"_createEventList",value:function(){this.adEvents={},this.adEvents[this.events.getAd]=this._getAd.bind(this),this.adEvents[this.events.gotAd]=this._gotAd.bind(this),this.adEvents[this.events.viewability]=this._viewability.bind(this),this.adEvents[this.events.adPlay]=this._adPlay.bind(this),this.adEvents[this.events.adPaused]=this._adPaused.bind(this),this.adEvents[this.events.adComplete]=this._completed.bind(this),this.adEvents[this.events.continueAd]=this._continueAd.bind(this)}},{key:"pushEvent",value:function(e,t){this.adEvents[e]&&this.adEvents[e](t)}},{key:"_addDataToAd",value:function(e,t,i,n){var r=this.adsList[t];r[e]?Mr.isArray(r[e])?r[e].push(i):r[e]=[r[e],i]:r[e]=i,r.redId=this.model.get("redId"),r.abTest=this.model.get("abTest"),this._addCardData(i,n),Mr.extend(r,n),r.countChanges++,this.adsList[t]=r,this.dirtyAds[t]=!0}},{key:"_addCardData",value:function(e,t){if(e.cardNumber){var i=this._getCardInfo(e.cardNumber);e.scrollData=e.scrollData||{},Mr.extend(e.scrollData,i),t&&(t.cardInfo=t.cardInfo||{},Mr.extend(t.cardInfo,i))}}},{key:"_getCardInfo",value:function(e){var t=("#cm_place_holder_"+e).replace(".",""),i=(0,E.default)(t)[0],n=Mr.getTopOfEl(i),r=window.innerHeight+window.pageYOffset;return{distanceToEligibility:n-r,eligibilityPercentage:r/n*100,cardTopPixels:n,cardNumber:e}}},{key:"getAdsData",value:function(){return{adsList:this.adsList}}},{key:"saveAdsData",value:function(e){this.adsList.length&&Mr.forEach(this.adsList,function(t,i){t.hadImpression&&this.dirtyAds[i]&&(this.dirtyAds[i]=!1,E.default.ajax({type:"POST",url:e+"/putes/units-ads-analytics",data:JSON.stringify(Mr.extend(t,{timestamp:(new Date).toISOString()})),contentType:"text/plain"}))}.bind(this))}}])&&Rr(t.prototype,i),n&&Rr(t,n),s}(o.O),Lr=Nr;function jr(e){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jr(e)}function Ur(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wr(e,t){return Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wr(e,t)}function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Gr(e);if(t){var r=Gr(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return qr(this,i)}}function qr(e,t){if(t&&("object"===jr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Gr(e){return Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gr(e)}var $r=i(1999),zr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wr(e,t)}(s,e);var t,i,n,o=Hr(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).model=e.model,t.getAdCount=0,t.impressionCount=0,t.isFirstImpression=!0,t.isFirstPlay=!0,t.isFirstPauseAfterPlay=!0,t.isFirstisEligiblilty=!0,t.hadLostEligibility=!1,t.eventsToSend=t.model.get("kibanaEventsToSend")||"all",t.isDirty=!1,t.changesCount=0,t.totalData={_id:$r.generateGuid(10),redId:t.model.get("redId")},t.startTime=t._getCurrentTime(),t._createAdsEvents(),t.kibanaAdsService=new Lr({model:t.model,startTime:t.startTime,predictors:t._parsePredicts(t.model.get("predictors"))}),t._start(),t._bindEvents(),t}return t=s,(i=[{key:"_start",value:function(){this._saveDataToStorage(r().KIBANA_EVENTS.start,{isEligible:this.model.get("isEligibleToPlay")||!1,startTime:this.startTime,pageUrl:window.location.href,selector:this.model.get("parentSelector")?this.model.get("parentSelector").toString():"",predictors:this._parsePredicts(this.model.get("predictors")),viewPercent:this.model.get("viewPercent"),viewabilityPercent:this.model.get("viewabilityPercent"),creativeId:this.model.get("creativeId"),unitType:this.model.get("unitType"),abTest:this.model.get("abTest"),playerType:this.model.get("mobilePlayer"),playerVersions:this.model.get("player.versions"),urlPrefix:this.model.get("urlPrefix"),version:this.model.get("version"),vForce:this.model.get("vForce"),isInTab:this.model.get("isInTab"),detachToSlider:this.model.get("detachToSlider"),scrollSelector:this.model.get("scrollSelector"),isUseObserver:this.model.get("isUseObserver"),isUseObserverChanged:this.model.get("isUseObserverChanged"),documentReadyState:this.model.get("documentReadyState"),lineItemId:this.model.get("lineItemId"),isAMP:window.TRC&&window.TRC.isAMP,isEligibilityNomination:this.model.get("isEligibilityNomination")||!1,secondsToWaitForRV:this.model.get("secondsToWaitForRV")},!0)}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"renderWasCalled:true",funcName:"_onRenderCalled"},{event:"getAdState:failed",funcName:"_getAdFailed"},{event:"isEligibleToPlay:true",funcName:"_onFirstEligibility"},{event:"closeState:closeButtonClicked",funcName:"_closeButtonClicked"},{event:"getAdState:stopped",funcName:"_unitClosedByMidRollTimeOut"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"},{event:"playerWidthLost:true",funcName:"_onLostPlayerSize"},{event:"playerHeightLost:true",funcName:"_onLostPlayerSize"},{event:"invalidCDBobject",funcName:"_onInvalidCDBobject"},{event:"playerHasRvInQ",funcName:"_onPlayerHasRvInQ"},{event:"rvHandlerState",funcName:"_onRvHandlerStateChange"},{event:"rvHandlerTimerExpired",funcName:"_onRvHandlerTimerExpired"}])}},{key:"_getCurrentTime",value:function(){return(new Date).getTime()}},{key:"_onRenderCalled",value:function(){this.renderCallTime=this._getCurrentTime();var e={isEligible:this.model.get("isEligibleToPlay"),timeFromAdImpression:this.renderCallTime-this.adImpressionTime,isInTab:this.model.get("isInTab")};this._saveDataToStorage(r().KIBANA_EVENTS.renderWasCalled,e)}},{key:"_getAdFailed",value:function(){this.getAdFailTime=this._getCurrentTime();var e={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:this.getAdFailTime-this.getAdTime,isInTab:this.model.get("isInTab"),width:this.model.get("width"),height:this.model.get("height")};this._saveDataToStorage(r().KIBANA_EVENTS.getAdFailed,e)}},{key:"getAdCalled",value:function(e){this.getAdCount++,this.getAdTime=this._getCurrentTime();var t=this._getTopParentSelector();t=t||-999;var i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.getAdTime-this.startTime,getAdCount:this.getAdCount,predictPointKey:"any"===e.getAdKey?10:e.getAdKey,predictName:e.predictName,isInTab:this.model.get("isInTab"),topParentSelector:t,adId:e.adId};this.model.get("distancePercentPredictData")&&"distancePercentPredict"===e.predictName&&$r.extend(i,this.model.get("distancePercentPredictData")),this.model.get("distancePixelPredictData")&&"distancePixelsPredict"===e.predictName&&$r.extend(i,this.model.get("distancePixelPredictData")),this._saveDataToStorage(r().KIBANA_EVENTS.getAd,i)}},{key:"gotAd",value:function(e){this.isFirstImpression=!1,this.adImpressionTime=this._getCurrentTime();var t=this._calcScrollPercentage(),i={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:this.adImpressionTime-this.getAdTime,scrollPercentageFromSelector:t.scrollPercentageFromSelector,bottomViewPort:t.bottomViewPort,topParentSelector:t.topParentSelector,isInTab:this.model.get("isInTab")};i.hadLostEligibility=!!this.model.get("lostEligibilityTime"),this.model.get("lostEligibilityTime")&&(i.timeFromLostEligibility=this.adImpressionTime-this.model.get("lostEligibilityTime")),this.playerHadRvInQTime&&this.model.get("gotRvAd")&&(i.timeFromPlayerHasRV=this.adImpressionTime-this.playerHadRvInQTime),e&&$r.extend(i,e),this._saveDataToStorage(r().KIBANA_EVENTS.gotAd,i,!1),this.impressionCount++}},{key:"adPlaying",value:function(e){this.hadPlay=!0,this.adPlayingTime=this._getCurrentTime();var t={timeFromAdImpression:this.adPlayingTime-this.adImpressionTime,isInTab:this.model.get("isInTab"),isFirstPlay:this.isFirstPlay};e&&$r.extend(t,e),this.isFirstPlay=!1,this._saveDataToStorage(r().KIBANA_EVENTS.adPlay,t)}},{key:"adPaused",value:function(e){if(this.hadPlay){this.adPausedAfterPlayTime=this._getCurrentTime();var t={timeFromAdPlay:this.adPausedAfterPlayTime-this.adPlayingTime,isInTab:this.model.get("isInTab"),pauseReason:e.pauseReason};e&&$r.extend(t,e),this._saveDataToStorage(r().KIBANA_EVENTS.adPaused,t)}}},{key:"_onFirstEligibility",value:function(){if(this.isFirstisEligiblilty){this.isFirstisEligiblilty=!1,this.firstEligibilityTime=this._getCurrentTime();var e={timeFromStart:this.firstEligibilityTime-this.startTime};this._saveDataToStorage(r().KIBANA_EVENTS.firstEligibility,e)}}},{key:"_closeButtonClicked",value:function(){this._unitClose(r().KIBANA_EVENTS.unitCloseByUser)}},{key:"_unitClosedByMidRollTimeOut",value:function(){this._unitClose(r().KIBANA_EVENTS.unitClosedByMidRollTimeOut)}},{key:"_unitClose",value:function(e){this.closeTime=this._getCurrentTime();var t={impressionCount:this.impressionCount,timeFromAdPlay:this.closeTime-this.adPlayingTime};this._saveDataToStorage(e,t,!0),clearInterval(this.updateTimer),this.updateTimer=void 0}},{key:"onViewability",value:function(e){this.viewabilityTime=this._getCurrentTime();var t={timeFromAdPlay:this.viewabilityTime-this.adPlayingTime};e&&$r.extend(t,e),this._saveDataToStorage(r().KIBANA_EVENTS.viewability,t,!1)}},{key:"onD2DClick",value:function(e,t){var i={isTrusted:e,isNewTab:t};this._saveDataToStorage(EVENTS.D2DClick,i,!1)}},{key:"_onParentSelectorLost",value:function(){this.lostTime=this._getCurrentTime();var e=this._getTopParentSelector();e=e||-999;var t={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.lostTime-this.startTime,isInTab:this.model.get("isInTab"),topParentSelector:e,isTop0Left0:this.model.get("top0Left0")};this._saveDataToStorage(r().KIBANA_EVENTS.topParentSelectorLost,t,!0)}},{key:"_onLostPlayerSize",value:function(){var e=r().KIBANA_EVENTS.playerHeightLost;this.model.get("playerWidthLost")&&(e=r().KIBANA_EVENTS.playerWidthLost),this.lostTime=this._getCurrentTime();var t=this._calcScrollPercentage();t.topParentSelector=t.topParentSelector?t.topParentSelector:-999;var i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.lostTime-this.startTime,isInTab:this.model.get("isInTab"),scrollPercentageFromSelector:t.scrollPercentageFromSelector,bottomViewPort:t.bottomViewPort,topParentSelector:t.topParentSelector};this._saveDataToStorage(e,i)}},{key:"_getTopParentSelector",value:function(){var e=this.model.get("parentSelector");return e=$r.isArray(e)?e[0]:e,e=(0,E.default)(e)[0],$r.getTopOfEl(e)}},{key:"_calcScrollPercentage",value:function(){var e=this._getTopParentSelector();e=e||-999;var t=window.innerHeight+window.pageYOffset;return{scrollPercentageFromSelector:t/e*100,topParentSelector:e,bottomViewPort:t}}},{key:"_onInvalidCDBobject",value:function(){var e=r().KIBANA_EVENTS.invalidCDBobject,t=this._getCurrentTime(),i={cdbObject:this.model.get("invalidCDBobject"),timeFromStart:t-this.startTime};this._saveDataToStorage(e,i)}},{key:"_onRvHandlerStateChange",value:function(e,t){var i=r().KIBANA_EVENTS.rvHandlerState,n={rvHandlerState:t,timeFromStart:this._getCurrentTime()-this.startTime,gotRvAd:this.model.get("gotRvAd"),gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(i,n)}},{key:"_onPlayerHasRvInQ",value:function(e,t){var i=r().KIBANA_EVENTS.playerHasRvInQ,n=this._getCurrentTime();this.playerHadRvInQTime=n;var o={rvHandlerState:this.model.get("rvHandlerState"),timeFromStart:n-this.startTime,gotRvAd:this.model.get("gotRvAd"),gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(i,o)}},{key:"_onRvHandlerTimerExpired",value:function(){var e=r().KIBANA_EVENTS.rvHandlerTimerExpired,t={timeFromStart:this._getCurrentTime()-this.startTime,gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(e,t)}},{key:"_parsePredicts",value:function(e){var t=E.default.extend(!0,{},e);return"any"===t.playerReady.predictPoint&&(t.playerReady.predictPoint=10),t}},{key:"_createAdsEvents",value:function(){this.adEvents={},this.adEvents[r().KIBANA_EVENTS.getAd]=this.getAdCalled.bind(this),this.adEvents[r().KIBANA_EVENTS.gotAd]=this.gotAd.bind(this),this.adEvents[r().KIBANA_EVENTS.viewability]=this.onViewability.bind(this),this.adEvents[r().KIBANA_EVENTS.adPlay]=this.adPlaying.bind(this),this.adEvents[r().KIBANA_EVENTS.adPaused]=this.adPaused.bind(this)}},{key:"adEvent",value:function(e,t){var i={eventTime:this._getCurrentTime(),scrollData:this._calcScrollPercentage()};$r.extend(t,i),this.kibanaAdsService.pushEvent(e,t),this.adEvents[e]&&this.adEvents[e](t)}},{key:"onCls",value:function(e){this._saveDataToStorage("cls",e)}},{key:"_saveDataToStorage",value:function(e,t,i){("all"===this.eventsToSend||$r.contains(this.eventsToSend,e))&&(this.totalData[e]?$r.isArray(this.totalData[e])?this.totalData[e].push(t):this.totalData[e]=[this.totalData[e],t]:this.totalData[e]=t,i?this._saveDataToLogServer(i):this.isDirty=!0)}},{key:"_saveDataToLogServer",value:function(e){if(e||this.isDirty){this.changesCount++,this.totalData.redId=this.model.get("redId"),this.totalData.countChanges=this.changesCount,this.totalData.abTest=this.model.get("abTest"),this.totalData.age=this._getCurrentTime()-this.startTime;var t=this.model.get("kbnul");this.kibanaAdsService.saveAdsData(t),E.default.ajax({type:"POST",url:t+"/putes/unitsanalytics",data:JSON.stringify($r.extend(this.totalData,{timestamp:(new Date).toISOString()})),contentType:"text/plain"}),this.isDirty=!1,this.updateTimer||(this.updateTimer=setInterval(this._saveDataToLogServer.bind(this),1e3*this.model.get("reportTimerSeconds")))}}}])&&Ur(t.prototype,i),n&&Ur(t,n),s}(o.O),Kr=zr;function Yr(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yr(e)}function Qr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zr(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Zr(e,t)}function Xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=to(e);if(t){var r=to(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Jr(this,i)}}function Jr(e,t){if(t&&("object"===Yr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eo(e)}function eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function to(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},to(e)}var io=i(1999),no=(o.O,i(701)),ro=i.n(no);function oo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var so=i(1999),ao=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adsList=[],this.listeners=[],this.registerIndex=0,this.model=t}var t,i,n;return t=e,(i=[{key:"updateAdsList",value:function(e){e&&!so.isEmpty(e)?(this.adsList=e.items,this._notifyListeners(e)):(this.model.set("generalErrorData",1),this.model.increaseCounter("generalError"))}},{key:"_notifyListeners",value:function(e){var t=this;this.isPlayerHasRvInQ(e);var i=[];this.listeners.forEach((function(e){var n=t._findAdsByStatusAndType(e.type,e.typeValue,e.status,e.cb);e.isListenOnce&&n&&i.push(e.index)})),i.forEach((function(e){return t.unregisterToPlayerQueueStatusChange(e)}))}},{key:"_findAdsByStatusAndType",value:function(e,t,i,n){var o=this,s=!1,a=[];return this.adsList.forEach((function(n){(!e||o[e]&&o[e](n,t))&&(!i||r().AD_STATUS[i]&&n.vw&&n.vw.st===r().AD_STATUS[i])&&(a.push(n),s=!0)})),s&&so.isFunction(n)&&n(a),s}},{key:"singleAd",value:function(e,t){return!!(t&&e.sa||!t&&!e.sa)}},{key:"adjacency",value:function(e,t){return!!(t&&e.adjc||!t&&!e.adjc)}},{key:"registerIsPlayerHasRvInQ",value:function(e){this.isPlayerHasRvInQCb=e}},{key:"isPlayerHasRvInQ",value:function(e){this.isPlayerHasRvInQCb&&e.requiredViewabilityCount&&this.isPlayerHasRvInQCb()}},{key:"registerToPlayerQueueStatusChange",value:function(e){var t=e.type,i=e.typeValue,n=e.status,o=void 0===n?r().AD_STATUS.new:n,s=e.cb,a=e.isListenOnce,l={type:t,typeValue:i,status:o,cb:s,isListenOnce:void 0!==a&&a,index:this.registerIndex};return this.registerIndex=this.registerIndex+1,this.listeners.push(l),l.index}},{key:"unregisterToPlayerQueueStatusChange",value:function(e){this.listeners=this.listeners.filter((function(t){return t.index!==e}))}}])&&oo(t.prototype,i),n&&oo(t,n),e}(),lo=function(){var e;return function(t){return e||(e=new ao(t)),e}}(),co=lo;function uo(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uo(e)}function ho(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function po(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},po(e,t)}function fo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=go(e);if(t){var r=go(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return mo(this,i)}}function mo(e,t){if(t&&("object"===uo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function go(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},go(e)}var yo=i(1999);o.O;i(1999);i(1999);i(1999);i(1999);function vo(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vo(e)}function bo(e){return function(e){if(Array.isArray(e))return _o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&e.constructor.name;if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){(null==t||t>e.length)&&e.length;for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function wo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function To(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},To(e,t)}function Po(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ao(e);if(t){var r=Ao(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return So(this,i)}}function So(e,t){if(t&&("object"===vo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ao(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ao(e)}var Eo=i(1999);o.O;function Co(e){return e.get("isUseHasFocus")?document.hasFocus():!document.hidden}i(1999);i(1999);i(1999);function ko(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ko(e)}function Oo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Do(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Do(e,t)}function Io(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=xo(e);if(t){var r=xo(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Ro(this,i)}}function Ro(e,t){if(t&&("object"===ko(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xo(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xo(e)}i(1999),o.O;i(1999);i(1999);function Bo(e){return Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bo(e)}function Vo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fo(e,t){return Fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fo(e,t)}function Mo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Lo(e);if(t){var r=Lo(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return No(this,i)}}function No(e,t){if(t&&("object"===Bo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lo(e){return Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lo(e)}var jo=i(1999),Uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fo(e,t)}(a,e);var t,i,r,o=Mo(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e.model)).model=e.model,t.log=new s.Z({unitType:t.model.get("unitType"),className:"PlayPriorityHandler",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.isRvPriority=t.model.get("isRvPriority")&&t._isAllowedInFT(),t.isHadFirstSetAd=!1,t.detachToSlider=t.model.get("detachToSlider"),t.isStickyCardActive=t.model.get("stickyCard.isActive"),t.isDetachActive=t.detachToSlider&&(t.detachToSlider.isStartFromSlider||t.detachToSlider.isDetachToSlider),t.isForceDetachOnGotAd=(t.isDetachActive||t.isStickyCardActive)&&t.model.get("detachToSlider.forceDetach.isActive"),t._bindEvents(),t}return t=a,(i=[{key:"_isAllowedInFT",value:function(){return!!this.model.get("playPriority.isAllowInIframes")||this.model.get("frameType")===n.FRAME_TYPE.plainPage}},{key:"_bindEvents",value:function(){}},{key:"setNextAd",value:function(e){this.lastAd=e,this._isForceAdToDetach(e)?this._setReadyAd(e):this.isRvPriority&&!this.isHadFirstSetAd?this._handleRvPriority(e):this._setReadyAd(e)}},{key:"_isForceAdToDetach",value:function(e){if(!this.isForceDetachOnGotAd||this.model.get("hadStickyDetach"))return!1;var t=this.model.get("detachToSlider.forceDetach.restrictions.rv"),i="any"===t||t===e.adData.requiredViewability;return this.log.info("force ad detach:",{isForced:i,activeAdRV:e.adData.requiredViewability}),i}},{key:"_setReadyAd",value:function(e){e.onAdSetToUnits(),this.lastSetAdId=e.adId;var t=e.adData.requiredViewability;this.model.setNextAd(e),setTimeout(function(){this.model.set("isNextAdRV",t),this.model.set("hasReadyAd",!0)}.bind(this),0)}},{key:"_handleRvPriority",value:function(e){var t=!1;if(e.adData.requiredViewability)t=!0;else{var i=this._isAtDecisionPoint();t=this._shouldSetReadyAd(i)}t&&(this._setReadyAd(e),e._bringToFront(),this.isHadFirstSetAd=!0)}},{key:"_shouldSetReadyAd",value:function(e){return!!e&&(this.model.get("playPriority.isAlwaysWaitForRv")?!this.model.get("playerHasRvInQ"):!this.model.get("playerHasRvInQ")||this.model.get("isSkippedDistancePredict")||this._isLoaderInRequiredPercentage())}},{key:"_isAtDecisionPoint",value:function(){if(!this.model.get("playPriority.checkForRvPriority"))return!1;var e=this.model.get("playPriority.checkForRvPriority");return this[n.CHECK_FOR_RV_PRIORITY[e]].bind(this)()}},{key:"_reCheckAd",value:function(e){this.isHadFirstSetAd||(this.hasListener=!1,this.setNextAd(this.lastAd))}},{key:"hasReachedEligibility",value:function(){return!(!this.model.get("isEligibleToPlay")&&!this.model.get("hadEligibility"))||(this.hasListener?void 0:(this._waitForEligibility(),this.hasListener=!0,!1))}},{key:"_waitForEligibility",value:function(){this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_reCheckAd",isListenOnce:!0}])}},{key:"hasReachedPixelsFromSelector",value:function(){if(void 0===this.model.get("playPriority.pixelsFromSelector"))return!1;var e=jo.hasPassedPixelFromSelector(this.model.get("parentSelector"),this.model.get("scrollSelector"),this.model.get("playPriority.pixelsFromSelector"),this.model.get("isNeedValidateParentSelector"));return e||this.hasListener||(this.hasListener=!0,k().once("window:scroll:change",this._reCheckAd.bind(this))),e}},{key:"intersectionPercent",value:function(){if(void 0===this.model.get("playPriority.intersectionPercent"))return!1}},{key:"_activeSecondsToGetRVTime",value:function(){}},{key:"_secondsAfterGetAdRv",value:function(){}},{key:"beforeLoaderEnd",value:function(){return!!this._isLoaderInRequiredPercentage()||(this.createStateHandlers([{event:"loaderCurrCount",funcName:"_reCheckAd",isListenOnce:!0}]),!1)}},{key:"_isLoaderInRequiredPercentage",value:function(){return this.model.get("loaderCurrCount")>=this.model.get("playPriority.loaderPercent")}}])&&Vo(t.prototype,i),r&&Vo(t,r),a}(o.O),Wo=Uo;function Ho(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ho(e)}function qo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Go(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Go(e,t)}function $o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ko(e);if(t){var r=Ko(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return zo(this,i)}}function zo(e,t){if(t&&("object"===Ho(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ko(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ko(e)}var Yo=i(1999);o.O;function Qo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Zo=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new s.Z({unitType:this.model.get("unitType"),className:"ObserverService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.options=i,this.setObserver()}var t,i,n;return t=e,(i=[{key:"observe",value:function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)e[t].dataset.elViewPercent||this.observer.observe(e[t])}},{key:"unobserve",value:function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)this.observer.unobserve(e[t])}},{key:"setObserver",value:function(){this.setDefaults(),this.observer=new IntersectionObserver(this.observerCallback.bind(this),this.options);var e=this.options.targetEl;this.observe(e)}},{key:"setDefaults",value:function(){var e=this.options;e.threshold=e.threshold||[0,this.model.get("viewPercent")/100,this.model.get("viewabilityPercent")/100],e.rootMargin=e.rootMargin||"0px",e.targetEl=Array.isArray(e.targetEl)?e.targetEl:[e.targetEl]}},{key:"observerCallback",value:function(e,t){this.options.callback&&this.options.callback(e,t),e.forEach((function(e){e.target.dataset.elViewPercent=e.intersectionRatio.toString()}))}},{key:"getViewPercent",value:function(e){return 100*parseFloat(e.dataset.elViewPercent)}},{key:"isElIntersectingViewport",value:function(e){return this.getViewPercent(e)>0}},{key:"isElViewPercentReached",value:function(e){return this.getViewPercent(e)>this.model.get("viewPercent")}},{key:"isElViewabilityPercentReached",value:function(e){return this.getViewPercent(e)>this.model.get("viewabilityPercent")}}])&&Qo(t.prototype,i),n&&Qo(t,n),e}(),Xo=Zo;function Jo(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jo(e)}function es(e){return function(e){if(Array.isArray(e))return ts(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ts(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&e.constructor.name;if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ts(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ts(e,t){(null==t||t>e.length)&&e.length;for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function is(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ns(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ns(e,t)}function rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=as(e);if(t){var r=as(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return os(this,i)}}function os(e,t){if(t&&("object"===Jo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ss(e)}function ss(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function as(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},as(e)}var ls=i(1999);o.O;function cs(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cs(e)}function ds(e){return function(e){if(Array.isArray(e))return us(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return us(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&e.constructor.name;if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return us(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function us(e,t){(null==t||t>e.length)&&e.length;for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function hs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ps(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ps(e,t)}function fs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=gs(e);if(t){var r=gs(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return ms(this,i)}}function ms(e,t){if(t&&("object"===cs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gs(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gs(e)}i(1999),o.O;function ys(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ys(e)}function vs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bs(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},bs(e,t)}function _s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ts(e);if(t){var r=Ts(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return ws(this,i)}}function ws(e,t){if(t&&("object"===ys(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ts(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ts(e)}var Ps=i(1999);o.O;function Ss(e){return Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ss(e)}function As(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Es(e,t){return Es=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Es(e,t)}function Cs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Os(e);if(t){var r=Os(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return ks(this,i)}}function ks(e,t){if(t&&("object"===Ss(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Os(e){return Os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Os(e)}var Ds=i(1999),Is=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Es(e,t)}(a,e);var t,i,n,o=Cs(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).model=e,t.log=new s.Z({unitType:t.model.get("unitType"),className:"GDPRManager",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._init(),t}return t=a,(i=[{key:"_init",value:function(){var e=window.__cmp,t=r().UNIT_TYPES[this.model.get("unitType")],i=t===r().UNIT_TYPES.EXPANDABLE||t===r().UNIT_TYPES.EXPANDABLE_MOBILE,n=t===r().UNIT_TYPES["300X600"]||t===r().UNIT_TYPES["300X600_MOBILE"];(i||n)&&!this.model.get("isStayInIframe")&&this._isInFriendlyIframe()&&(e=Ds.getTopWindow().__cmp),void 0!==e?(this.model.set("hasCMPonPage",!0),e("getConsentData",null,this._getConsentDataCB.bind(this))):(this.model.set("hasCMPonPage",!1),this.model.set("canStartPlayer",!0))}},{key:"_getConsentDataCB",value:function(e){var t=e.gdprApplies,i=e.consentData||"";this._setPlayerParams(t,i)}},{key:"_setPlayerParams",value:function(e,t){zn().player?(zn().player.set("gdprApplies",e),zn().player.set("cdb",t)):(this.model.set("gdprApplies",e),this.model.set("consentDaisyBit",t),this.model.set("canStartPlayer",!0))}},{key:"_isInFriendlyIframe",value:function(){return this._isInIframe()&&cmTag.config.iframeData.isFriendlyIframe}},{key:"_isInIframe",value:function(){return cmTag.config.iframeData.inIframe||cmTag.config.iframeData.inDFP}}])&&As(t.prototype,i),n&&As(t,n),a}(o.O),Rs=Is;function xs(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xs(e)}function Bs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vs(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vs(e,t)}function Fs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ns(e);if(t){var r=Ns(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Ms(this,i)}}function Ms(e,t){if(t&&("object"===xs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ns(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ns(e)}i(1999),o.O;function Ls(e){return Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ls(e)}function js(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Us(e,t){return Us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Us(e,t)}function Ws(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=qs(e);if(t){var r=qs(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Hs(this,i)}}function Hs(e,t){if(t&&("object"===Ls(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qs(e){return qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qs(e)}var Gs=i(1999),$s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Us(e,t)}(o,e);var t,i,n,r=Ws(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e.model)).version=e.version,t.model=e.model,t.oppsulaLoaded=!1,t.log=new s.Z({unitType:t.model.get("unitType"),className:"OppsulaManager",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.oppsArr=[],t._bindEvents(),t.serviceLoader=zn().serviceLoader,t._loadService(),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isOppsulaLoaded:true",funcName:"_sendOppsFromArr"}])}},{key:"_loadService",value:function(){this.serviceLoader.get("oppsula",this.version,this._onOppsulaLoaded.bind(this),this._onLoadOppsulaError.bind(this))}},{key:"_onOppsulaLoaded",value:function(e){this.oppsula=new e(this.model,"unit"),this.oppsulaLoaded=!0,this.log.info("Oppsula Loaded",this.oppsula),this._sendOppsFromArr()}},{key:"_onLoadOppsulaError",value:function(){this.log.error("Error while loading Oppsula from service loader")}},{key:"send",value:function(e,t){!0===this.oppsulaLoaded?this.oppsula.send("unit",t,e):this.oppsArr.push(e)}},{key:"_sendOppsFromArr",value:function(){0!==this.oppsArr.length&&(Gs.forEach(this.oppsArr,this.send,this),this.oppsArr=[])}}])&&js(t.prototype,i),n&&js(t,n),o}(o.O),zs=function(){var e;return function(t){return e||(e=new $s(t)),e}}(),Ks=zs;function Ys(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ys(e)}function Qs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zs(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Zs(e,t)}function Xs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ea(e);if(t){var r=ea(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Js(this,i)}}function Js(e,t){if(t&&("object"===Ys(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ea(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ea(e)}var ta=i(1999);o.O;function ia(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ia(e)}function na(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ra(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ra(e,t)}function oa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=aa(e);if(t){var r=aa(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return sa(this,i)}}function sa(e,t){if(t&&("object"===ia(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function aa(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},aa(e)}var la=i(1999);o.O;function ca(e){return ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ca(e)}function da(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ua(e,t){return ua=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ua(e,t)}function ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=fa(e);if(t){var r=fa(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return pa(this,i)}}function pa(e,t){if(t&&("object"===ca(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fa(e){return fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fa(e)}var ma=i(1999),ga=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ua(e,t)}(o,e);var t,i,n,r=ha(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).model=e,t.adjacCardPlacement=t.model.get("adjacCardPlacement"),t.log=new s.Z({unitType:t.model.get("unitType"),className:"organicCardInjector",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEvents(),t}return t=o,(i=[{key:"_bindEvents",value:function(){}},{key:"injectOrganicCard",value:function(e){if(this.adjacCardPlacement=this.model.get("adjacCardPlacement")||this.adjacCardPlacement,!this._isCardOrganic(this.adjacCardPlacement)&&!this.isOrganicCardInjected){this.organicContainer=(0,E.default)(e)[0];var t=ma.getOrganicCard();if(!t)return this.log.error("missing mode can't inject organic"),!1;if(!this.organicContainer)return this.log.error("missing container to inject an organic card"),!1;var i=document.createElement("div");i.id="taboola-adjacent-organic-card",i.classList.add("tbl-feed-card"),i.dataset.cardIndex=this.adjacCardPlacement-.25,this.organicContainer.insertAdjacentElement("afterend",i),window._taboola=window._taboola||[];var n=this._getPlacementName();return this.isOrganicCardInjected=!0,this.model.set("isOrganicCardInjected",!0),_taboola.push({mode:t,container:"taboola-adjacent-organic-card",placement:n,target_type:"mix"}),!0}}},{key:"_getPlacementName",value:function(){var e=(0,E.default)(this.model.get("parentSelector"))[0];if(e&&e.dataset&&e.dataset.parentPlacementName)return e.dataset.parentPlacementName+" | Card 0"}},{key:"_isCardOrganic",value:function(e){var t=(0,E.default)('[data-card-index="'.concat(e,'"]'))[0];return!(!t||!t.querySelector(".trc-content-organic"))}}])&&da(t.prototype,i),n&&da(t,n),o}(o.O);!function(){var e}();function ya(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var va="data-cm-v-ad-id",ba=function(){function e(t,i){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance)return e.instance;this.viewabilityPercent=t/100,this.viewPercent100=i/100,this.threshold=[0,this.viewabilityPercent,this.viewPercent100,1],e.instance=this,this.elementsToObserve={},this.observerOptions={root:null,rootMargin:"0px",threshold:this.threshold},this.intersectionObserver=this._createObserver(this._observerCallback.bind(this),this.observerOptions)}var t,i,n;return t=e,i=[{key:"_observerCallback",value:function(e){var t=this;e.map((function(e){var i=e.intersectionRatio,n=e.target.getAttribute(va),r=t.viewabilityPercent<=i,o=t.viewPercent100<=i;t.elementsToObserve[n].model.set("isViewableByOb",r),t.elementsToObserve[n].model.set("isViewableByOb100",o)}))}},{key:"_createObserver",value:function(e,t){return new IntersectionObserver(e,t)}},{key:"startObserverElement",value:function(e,t,i){e.setAttribute(va,t),this.elementsToObserve[t]={element:e,model:i},this.elementsToObserve[t].model.set("isViewableByOb100",i.get("isViewable100")),this.intersectionObserver.observe(e)}},{key:"stopObserveElement",value:function(e){this.intersectionObserver.unobserve(this.elementsToObserve[e].element),delete this.elementsToObserve[e]}},{key:"stopObserver",value:function(){this.intersectionObserver.disconnect()}}],i&&ya(t.prototype,i),n&&ya(t,n),e}();function _a(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_a(e)}function wa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ta(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ta(e,t)}function Pa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Aa(e);if(t){var r=Aa(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Sa(this,i)}}function Sa(e,t){if(t&&("object"===_a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Aa(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Aa(e)}i(1999),o.O;function Ea(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return Ca(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ca(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}function Ca(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var ka=function(){return window.parent.document.getElementsByTagName("iframe")};function Oa(e){return Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oa(e)}function Da(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return Ia(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ia(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}function Ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ra(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xa(e,t){return xa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xa(e,t)}function Ba(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Fa(e);if(t){var r=Fa(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Va(this,i)}}function Va(e,t){if(t&&("object"===Oa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fa(e){return Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fa(e)}var Ma=i(1999),Na="tbl-data-mutation-observer",La={attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["style"]},ja=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xa(e,t)}(a,e);var t,i,n,o=Ba(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).model=e.model,t.globalModel=e.globalModel,t.log=new s.Z({unitType:t.model.get("unitType"),className:t.constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEvents(),t.validVideoClass=t.model.get("eligibilityValidator.validVideoClass")||["cm-vpaid-iframe","cm-ad-player","cm_video_content_video_element","_cm-loading","_cm-native-ad","_cm-background-filler","_cm-components-holder"],t.observers=[],t.observerThrottle=t.model.get("eligibilityValidator.observers.mutation.throttle")||200,t}return t=a,i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"closeState:terminate",funcName:"_clearObservers"}]),this.model.get("videoValidator.isActive")&&(this.model.set("videoValidator.isActive",!1),this.createStateHandlers([{event:"adState:playing",funcName:"_triggerVideoValidation",isListenOnce:!0}]))}},{key:"_isElementTheTopMostElement",value:function(e){return!this.elementData.topMostEl||this.elementData.topMostEl===e||this._isElementDescendantOfTopMostEl(e)||this._isValidVideoEl(this.elementData.topMostEl)||this._isValidElementInVideoPlaceholderOverlay(this.elementData.topMostEl)||this._isValidRboxElement(this.elementData.topMostEl)||this._isInlineUnitPushingDownTopMostEl(this.elementData.topMostEl)}},{key:"_isElementDescendantOfTopMostEl",value:function(e){return e.className&&this.elementData.topMostEl.querySelector&&!!this.elementData.topMostEl.querySelector(this._getQuerySelectorFromElementClassName(e))}},{key:"_isValidElementInVideoPlaceholderOverlay",value:function(e){var t=this.model.get("videoViewContainer");return Array.isArray(t)&&(t=t[0]),this.elementData.topMostEl.className&&t&&t.querySelector&&t.querySelector(this._getQuerySelectorFromElementClassName(this.elementData.topMostEl))}},{key:"_getQuerySelectorFromElementClassName",value:function(e){return".".concat(e.className.trim().replace(/\s+/g," ").split(" ").join("."))}},{key:"_isInlineUnitPushingDownTopMostEl",value:function(e){return"INLINE_INSTREAM"===this.model.get("unitType")&&"fixed"!==e.style.position}},{key:"_isValidRboxElement",value:function(e){for(;e.parentElement;){if(e.className.indexOf("trc_rbox_container")>-1)return!0;e=e.parentElement}return!1}},{key:"_handleTopElement",value:function(e){return this._clearObservers(),e}},{key:"_handleElementIsNotOnTop",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=this._calcEligiblePercent(e,this.elementData,i/100);return t&&!this._isEligiblePercentValid(n)&&(this._fireOverlayPixel(n),this._setMutationObserver(this._getElToObserve(this.elementData.topMostEl))),n}},{key:"getViewablePercentForNonFullyViewableUnits",value:function(e,t){try{return this._setElementEligibilityDataByViewabilityPercent(e),this._isElementTheTopMostElement(e)?this._handleTopElement(t):this._handleElementIsNotOnTop(e,this._isEligiblePercentValid(t),t)}catch(e){this.log.error(e)}finally{this.measured=!0}}},{key:"getViewablePercent",value:function(e){try{if((0,E.default)(e).show(),this._setElementEligibilityData(e),this._isElementTheTopMostElement(e))return(0,E.default)(e).hide(),this._handleTopElement(100);var t=this._handleElementIsNotOnTop(e,!0);return(0,E.default)(e).hide(),t}catch(t){this.log.error(t),(0,E.default)(e).hide()}}},{key:"validateVideoIsTopEle",value:function(e){try{return this._setElementEligibilityData(e),this._isValidVideoEl(this.elementData.topMostEl)}catch(e){this.log.error(e)}}},{key:"_setElementEligibilityDataByViewabilityPercent",value:function(e){this.elementData={},this.elementData.elementBound=e.getBoundingClientRect(),this.elementData.elementBound.height=this.elementData.elementBound.height||this.model.get("height"),this.elementData.elementBound.width=this.elementData.elementBound.width||this.model.get("width"),this.elementData.samplePoint=this._getSamplePointByViewabilityPercent(e,this.elementData.elementBound),this.elementData.topMostEl=this._findTopMostEl(e,this.elementData.samplePoint.x,this.elementData.samplePoint.y)}},{key:"_findTopMostEl",value:function(e,t,i){var n,r,o=Ma.getTopWindow().document.elementsFromPoint(t,i),s=o[0],a=Da(o);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(l===e||!l.contains(s))break;n=l}}catch(e){a.e(e)}finally{a.f()}return n||s}},{key:"_isParentContainingChild",value:function(e){try{var t=e.getBoundingClientRect(),i=e.parentElement.getBoundingClientRect();return i.x<=t.x&&i.y<=t.y&&i.x+i.width>=t.x+t.width&&i.y+i.height>=t.y+t.height}catch(e){}return!1}},{key:"_setElementEligibilityData",value:function(e){this.elementData={},this.elementData.elementBound=e.getBoundingClientRect(),this.elementData.samplePoint=this._getSamplePoint(e,this.elementData.elementBound),this.elementData.topMostEl=this._getTopMostElementAtPoint(this.elementData.samplePoint.x,this.elementData.samplePoint.y)}},{key:"_isValidVideoEl",value:function(e){return!!this._isElementHasValidClasses(e)||this._isElementHasValidClasses(this._getVideoEl(e))}},{key:"_isElementHasValidClasses",value:function(e){for(var t in this.validVideoClass)if((0,E.default)(e).hasClass(this.validVideoClass[t]))return!0;return!1}},{key:"_calcEligiblePercent",value:function(e,t,i){var n=this._getIntersectionRatio(e,this.elementData.elementBound,this.elementData.topMostEl),r=Math.max(100*(i-n),0);return this.log.warning("video ad is not the top most element",{validPercent:r}),r}},{key:"_isEligiblePercentValid",value:function(e){return e>=(this.model.get("viewabilityPercent")||100)}},{key:"_setMutationObserver",value:function(e){this._isSetObserver(e)&&(this.observer||this._initMutationObserver(),e.setAttribute(Na,!0),this.mutationsObserver.observe(e,La))}},{key:"_initMutationObserver",value:function(){var e=Ma.throttle(this._onOverlayChange.bind(this),this.observerThrottle);this.mutationsObserver=new MutationObserver(e)}},{key:"_isSetObserver",value:function(e){var t=e&&e.getAttribute(Na);return this.model.get("eligibilityValidator.observers.mutation.isActive")&&!t&&Ma.isObserverSupported("IntersectionObserver")}},{key:"_getElToObserve",value:function(e){if(this.model.get("eligibilityValidator.observers.mutation.isObserveParent")){var t=e.parentElement;if(["HTML"].indexOf(t.tagName)<0)return t}return e}},{key:"_fireOverlayPixel",value:function(e){this._setToModel("overlay",{overlayData:this._getOverlayData(this.elementData.topMostEl),actualEligiblePercent:parseInt(e)}),this._setToModel("overlayDetected",!0)}},{key:"_setToModel",value:function(e,t){this.model.set(e,t),this.globalModel&&this.globalModel.set(e,t)}},{key:"_getOverlayData",value:function(e){return"id@".concat(e.id,";cl@").concat(e.className).slice(0,100)}},{key:"_getVideoEl",value:function(e){var t=e.tagName.toLowerCase();return"video"===t?e:"iframe"===t?e.contentDocument&&e.contentDocument.querySelector&&e.contentDocument.querySelector("video"):e&&e.querySelector&&e.querySelector("video")}},{key:"_getTopMostElementAtPoint",value:function(e,t){return Ma.getTopWindow().document.elementFromPoint(e,t)}},{key:"_getSamplePoint",value:function(e,t){var i=Math.min(this.model.get("eligibilityValidator.yThreshold"),t.height)||10;return{x:t.x+t.width/2,y:t.y+t.height-i}}},{key:"_getSamplePointByViewabilityPercent",value:function(e,t){var i=(100-this.model.get("viewabilityPercent"))/100,n=t.height*i,o=t.width*i,s=Math.min(this.model.get("eligibilityValidator.yThreshold"),t.height)||10,a=Math.min(this.model.get("eligibilityValidator.xThreshold"),t.width)||10,l=t.x+t.width-o-a,c=t.y+t.height-n-s,d={x:Math.min(l,window.innerWidth-1),y:Math.min(Math.max(c+s,c),window.innerHeight-1)};return this.model.get("frameType")===r().FRAME_TYPE.friendlyIframe?this._friendlyIframeCorrection(d):d}},{key:"_friendlyIframeCorrection",value:function(e){var t={x:e.x,y:e.y},i=function(){var e,t=Ea(ka());try{for(t.s();!(e=t.n()).done;){var i=e.value;if(window===i.contentWindow)return i}}catch(e){t.e(e)}finally{t.f()}}();if(!i)return this.log.warning("Could not locate iFrame of current unit"),t;var n=i.getBoundingClientRect();return t.x+=n.left,t.y+=n.top,t}},{key:"_getIntersectionRatio",value:function(e,t,i){var n=t.width*t.height;return this._getElementsIntersectionArea(i,e,t)/n}},{key:"_getElementsIntersectionArea",value:function(e,t,i){if(!e||!t)return 0;var n=e.getBoundingClientRect(),r=i||t.getBoundingClientRect(),o=n.left,s=n.top,a=n.left+n.width,l=n.top+n.height,c=r.left,d=r.top,u=r.left+r.width,h=r.top+r.height;return Math.max(0,Math.min(a,u)-Math.max(o,c))*Math.max(0,Math.min(l,h)-Math.max(s,d))}},{key:"_clearObservers",value:function(){(0,E.default)("[".concat(Na,"]")).removeAttr(Na),this.mutationsObserver&&this.mutationsObserver.disconnect()}},{key:"_onOverlayChange",value:function(e,t){var i=this;Ma.forEach(e,(function(e){var t=e.removedNodes&&Ma.contains(e.removedNodes,i.elementData.topMostEl);(e.target===i.elementData.topMostEl||t)&&i.model.increaseCounter("overlayMutation")}))}},{key:"_validateVideoPosition",value:function(){var e=this.model.get("containerViewPlaceHolder")||this.model.get("videoViewContainer");this.validateVideoIsTopEle(e)||this.model.set("misplacedVideoDetected",!0)}},{key:"_triggerVideoValidation",value:function(){var e=this;setTimeout((function(){e.model.get("adState")===l().adState.playing&&e._validateVideoPosition()}),this.model.get("videoValidator.timeToValidation")||500)}}],i&&Ra(t.prototype,i),n&&Ra(t,n),a}(o.O),Ua=ja;i(1999);function Wa(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wa(e)}function Ha(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qa(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qa(e,t)}function Ga(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=za(e);if(t){var r=za(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return $a(this,i)}}function $a(e,t){if(t&&("object"===Wa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function za(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},za(e)}var Ka=".tbl-read-more-box",Ya=(o.O,i(5281));function Qa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Za=i(1999),Xa=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.window=t||window,this.$window=(0,E.default)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.setScrollableSelector(i),this._timeBetweenEvents=100,this.keyPressMap={17:!1,18:!1,84:!1,86:!1},this._setScrollListener(),this._setMouseMoveListener(),this._setKeyPressListener(),this._setTabViewListener(),this._setOrientationChangeListener(),this._setResizeListener(),this._setTaboolaReadMoreListener()}var t,i,n;return t=e,(i=[{key:"_setScrollListener",value:function(){var e=Za.throttle(this._trigger.bind(this,"window:scroll:change"),this._timeBetweenEvents);this.scrollSelector.addEventListener("scroll",e)}},{key:"_setMouseMoveListener",value:function(){var e=Za.throttle(this._trigger.bind(this,"window:mouse:move"),this._timeBetweenEvents);this.window.addEventListener("mousemove",e)}},{key:"_setKeyPressListener",value:function(){var e=this;this.window.addEventListener("keyup",(function(t){e._trigger.bind(e,"window:key:press"),t.keyCode in e.keyPressMap&&(e.keyPressMap[t.keyCode]=!1)})),this.window.addEventListener("keydown",(function(t){t.keyCode in e.keyPressMap&&(e.keyPressMap[t.keyCode]=!0,e.keyPressMap[17]&&e.keyPressMap[18]&&e.keyPressMap[84]&&e.keyPressMap[86]&&(k().trigger("supportTool:event","open"),e.keyPressMap[17]=e.keyPressMap[18]=e.keyPressMap[84]=e.keyPressMap[86]=!1))}))}},{key:"_setOrientationChangeListener",value:function(){var e=Za.throttle(this._trigger.bind(this,"window:orientation:change"),this._timeBetweenEvents);window.addEventListener("orientationchange",e)}},{key:"_setResizeListener",value:function(){var e=Za.throttle(this._handleResizeEvent.bind(this),this._timeBetweenEvents);window.addEventListener("resize",e)}},{key:"_setTabViewListener",value:function(){this.isTabOut="hidden"===document.visibilityState,this.window.document.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this)),this.window.addEventListener("focus",this._handleTabEvents.bind(this),!0),this.window.addEventListener("blur",this._handleTabEvents.bind(this),!0)}},{key:"_handleResizeEvent",value:function(e){var t=this.$window.height(),i=t-this.windowHeight;this.windowHeight=t;var n=this.$window.width(),r=n-this.windowWidth;this.windowWidth=n,this._trigger("window:resize:change",{heightChange:i,widthChange:r})}},{key:"_handleVisibilityChange",value:function(e){this.isTabOut="hidden"===document.visibilityState,this._handleTabEvents(e)}},{key:"_handleTabEvents",value:function(e){this._trigger("window:tab:change",this._getTabState(e.type))}},{key:"_getTabState",value:function(e){return this.isTabOut?r().TAB_STATE.tabOut:"focus"===e?r().TAB_STATE.focus:r().TAB_STATE.blur}},{key:"_trigger",value:function(e,t){k().trigger(e,t)}},{key:"_setTaboolaReadMoreListener",value:function(){window._taboola=window._taboola||[],_taboola.push({listenTo:"readmore.click",handler:function(){k()&&k().trigger("taboola:readmore:click")}})}},{key:"setScrollableSelector",value:function(e){this.scrollSelector="document"===e?document:Za.isEmpty(e)?this.window:(0,E.default)(e)[0]}}])&&Qa(t.prototype,i),n&&Qa(t,n),e}(),Ja=function(){var e;return function(t,i){return e||(e=new Xa(t,i)),e}}(),el=Ja,tl=i(2707),il=i.n(tl),nl=(i(2782),i(1999)),rl=(i(9644),i(7904)),ol=(i(9861),i(9288)),sl=i(9245),al=i(9791);var ll=k().View.extend({className:"_cm-poster",id:"_cm-css-reset",initialize:function(e){this.log=new s.Z({unitType:"Component",className:"PosterView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.render()},render:function(){this.staticBanner=document.createElement("img"),this.staticBanner.addEventListener("error",this._onError.bind(this));var e=this.model.get("components.PosterView.imageLocation");this.staticBanner.src=e,this.staticBanner.height=this.model.get("height"),this.staticBanner.width=this.model.get("width"),this.staticBanner.onclick=this._onClick.bind(this),this.$el.hide(),this.$el.append(this.staticBanner),this.container.prepend(this.$el)},_onError:function(){k().trigger("error",this.staticBanner,"imageLoadError"),this.$el.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_onClick:function(e){this.trigger("cm:banner:click")}}),cl=i(9288),dl=i(1999),ul=i(9652),hl=cl.View.extend({className:"_cm-brand-logo",events:{"click ":"_onClick"},initialize:function(e){this.log=new ul({unitType:e.unitType,className:"branLogoView"}),this.model=e.model,this.container=e.container,this.options=this.model.get("components.BrandLogo")||{},this.options.imageSrc=this.model.get("components.BrandLogo.imageSrc"),this.openUrl=this._getOpenUrl(),this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=dl.template('<a href="javascript:void(0);"> <img src="{{imageSrc}}"> </a>'),this.$el.append(this.template(this.options)),this.options.style&&this.$el.css(this.options.style),this.options.imageStyle&&this.$el.find("a>img").css(this.options.imageStyle),this.container.appendChild(this.el)},_onClick:function(){window.open(this.openUrl,"_blank")},_getOpenUrl:function(){var e=this.model.get("clickUrl"),t=this.options.logoLander,i=this.options.fallBackClickUrl,n=this._getClickUrlQueryStrings(t);return e&&e.length>0&&-1===e.indexOf("_#")?decodeURIComponent(e)+encodeURIComponent(i)+n:i+n},_getClickUrlQueryStrings:function(e){return"?ttype=1&cipid="+this.model.get("cipid")+"&ttype=1&crid="+this.model.get("creativeId")+"&dast="+this.model.get("dast")+"&tgtf="+encodeURIComponent(e)},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),pl=k().View.extend({className:"_cm-click-through",initialize:function(e){this.log=new s.Z({unitType:"Component",className:"ClickThrough",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.link=e.link,this.render()},render:function(){this.$el.click(this.onClick.bind(this)),this.container.appendChild(this.el)},onClick:function(){this.link&&window.open(this.link,"_blank")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},updateLink:function(e){this.link=e}}),fl=i(1231),ml='<?xml version="1.0" encoding="utf-8"?> <svg version="1.1" id="_x2014_ÎÓÈ_x5F_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 99 99" xml:space="preserve"> <style>.st0{fill:#fff}</style> <g> <g stroke="null" id="svg_1"> <g stroke="null" id="svg_2"> <path stroke="null" id="svg_3" d="m82.77256,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964l-65.57555,-69.42328c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341c2.49406,-2.6404 6.53931,-2.6404 9.03337,0l65.57555,69.45548c2.49406,2.6404 2.49406,6.92301 0,9.56341c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class="st0"/> </g> <g stroke="null" id="svg_4"> <path stroke="null" id="svg_5" d="m17.19702,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341l65.57555,-69.42328c2.49406,-2.6404 6.53931,-2.6404 9.03337,0c2.49406,2.6404 2.49406,6.92301 0,9.56341l-65.57555,69.45548c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class="st0"/> </g> </g> </g> </svg>',gl=i(9288),yl=i(1999),vl=i(9652),bl=i(9831),_l=gl.View.extend({className:"_cm-close-area",id:"_cm-close-area",events:{"click ":"_onClick"},initialize:function(e){this.log=new vl({unitType:e.unitType,className:"closeButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=fl.L,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){this._rendered=!0,this.$el.append(ml);var e=this.model.get("wurfl.browser.name").toLowerCase();-1===e.indexOf(r().BROWSER.FIREFOX.toLowerCase())&&-1===e.indexOf(r().BROWSER.IE.toLowerCase())&&-1===e.indexOf(r().BROWSER.EDGE.toLowerCase())||this.$el.addClass("_cm-close-ie-fix"),this.container=yl.isArray(this.container)?this.container[0]:this.container,this.container.appendChild(this.el),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&("detached"===this.model.get("videoViewState")?this.show():this.hide())}},_bindEvents:function(){this.model.get("vForce.isActive")?this.listenTo(this.model,"change:adState",this._onStateChange):this.listenTo(this.model,"change:state",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){var e=this.model.get("components.CloseButtonView.delay");this.renderTimeout=setTimeout(this.render.bind(this),e)},_onClick:function(e){e.stopPropagation(),this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||yl.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),gl.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser",bl.closeState.terminate)},_onStateChange:function(e,t){t!==e.STATE.PLAYING&&t!==bl.adState.playing||this._onPlaying()},_onVideoViewStateChange:function(e,t){switch(t){case"detached":this.show();break;case"attached":this.hide()}},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),wl=i(9288),Tl=i(1999),Pl=i(9652),Sl=i(9831),Al=(wl.View.extend({className:"_cm-close-area",id:"_cm-close-area",closeButtonRenderd:!1,events:{"click ":"_onClick"},initialize:function(e){this.log=new Pl({unitType:e.unitType,className:"closeButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=fl.L,this.render(),this.hide()},render:function(){this._rendered||(this._rendered=!0,this.isInDelay=!1,this.$el.append(ml),this.container.appendChild(this.el))},_bindEvents:function(){this.listenTo(this.model,"change:state",this._onStateChange),this.listenTo(this.model,"change:adState",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.model.get("detachToSlider.hasCloseButton")&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){this.model.get("videoViewState")!==Sl.videoViewState.attached||this.model.get("hasCloseButton")?this._startRender():this.isInDelay&&(this.closeButtonRenderd=!1,clearTimeout(this.delayTimeout))},_startRender:function(){if(this.closeButtonRenderd)this.show();else{this.closeButtonRenderd=!0;var e=this.model.get("components.CloseButtonView.delay");this.isInDelay=!0,this.delayTimeout=setTimeout(this.render.bind(this),e)}},_onClick:function(){this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||Tl.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),wl.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser")},_onStateChange:function(e,t){if("playing"===t)this._onPlaying()},_onVideoViewStateChange:function(e,t){"detached"===t&&!this.closeButtonRenderd&&this.model.get("detachToSlider.hasCloseButton")&&this._startRender(),"attached"!==t||this.model.get("hasCloseButton")||this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),i(9288)),El=i(1999),Cl=i(9652),kl=Al.View.extend({className:"_cm-d2d-fallback",initialize:function(e){this.log=new Cl({unitType:e.unitType,className:"D2dFallbackView"}),this.model=e.model,this.container=e.container,this.isTrusted=!0,this.shouldReport=El.isFactor(this.model.get("gaFactor")),this.shouldReport&&this.model.get("isReportToKibana")&&(this.model.set("gaFactor",1),this.kibana=new Kr({model:this.model})),this.pubId=e.pubId?e.pubId:this.model.get("components.D2DFallbackView.pubId"),this.pubTagId=e.pubTagId?e.pubTagId:this.model.get("components.D2DFallbackView.pubTagId"),this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append('<iframe style="width:100%;height:100%" frameborder="0" border="0" padding="0" scrolling="no" marginwidth="0" marginheight="0"></iframe>'),this._customize(),(0,E.default)(this.container).append(this.$el),this.iframe=this.$el.find("iframe")[0],this.iframe.contentWindow?this._writeIframe():this.iframe.onload=this._writeIframe.bind(this),El.firePixel(this.model.getPixel("pixels.D2DFallback"),"D2DFallback")},_writeIframe:function(){this.iframe.onload=this.iFrameOnLoad.bind(this);var e=this.iframe.contentWindow.document;e.open(),e.write('<script type="text/javascript" src="'.concat(this.buildFallbackURL(),'"><\/script>')),e.close(),e.onclick=this._onClick.bind(this)},iFrameOnLoad:function(){var e=(0,E.default)(this.iframe.contentWindow.document.body);(0,E.default)("div",e).length>0&&this.model.set("d2dLoaded",!0)},buildFallbackURL:function(){return"".concat(this.model.get("components.D2DFallbackView.location"),"?")+"oid=15"+"&width=".concat(this.model.get("components.D2DFallbackView.width"))+"&height=".concat(this.model.get("components.D2DFallbackView.height"))+"&pubid=".concat(this.pubId)+"&tagid=".concat(this.pubTagId)+"&pstn=".concat(this.model.get("components.D2DFallbackView.pstn"))+"&cirf=".concat(this.model.get("referrer"))+"&noaop=1&revmod=INSERT_CONTENT_TYPE&encoded=1&cb=INSERT_CACHEBUSTER&keywords=INSERT_COMMA_SEPARATED_KEYWORDS&urlonly=1&callback=document.write"},hide:function(e){this.log.info("D2D hide:",e),e?this.$el.css({display:"none"}):this.$el.css({display:"block"})},show:function(){this.$el.css({display:"block"})},_onClick:function(e){this.isTrusted=!0,e.isTrusted?window.setTimeout(this._onTimeoutEnd.bind(this),1e3*this.model.get("clickTestSeconds")):(El.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"),this.kibana&&this.kibana.onD2DClick(e.isTrusted))},_onTimeoutEnd:function(){Co(this.model)?(El.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"),this.kibana&&this.kibana.onD2DClick(!0,!1)):El.firePixel(this.model.getPixel("pixels.D2DClick"),"D2DClick")},_customize:function(){var e=this.model.get("components.D2DFallbackView.additionalCss");this.$el.css(El.toCssObj(e))},updateD2D:function(e,t){this.iframe&&this.pubId!=e&&this.pubTagId!=t&&(this.pubId=e,this.pubTagId=t,this._writeIframe())},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide(!0)},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide(!0)}}),Ol=(i(9836),'<div id="_cm-css-reset" class="_cm-repeat-div"> <div class="_cm-repeat-view-wrapper"> <div class="_cm-repeat-buttons-wrapper"> <img class="_cm-repeat-button"> <img class="_cm-repeat-button-hover"> </div> <div class="_cm-learn-more-buttons-wrapper"> <img class="_cm-learn-more-button"> <img class="_cm-learn-more-button-hover"> </div> </div> </div>'),Dl=(k().View.extend({className:"_cm-loading",id:"_cm-css-reset",initialize:function(e){this.log=new s.Z({unitType:"Component",className:"LoadingView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),e.globalModel&&(this.globalModel=e.globalModel),this.container=e.container,this.isShowReplayScreen=e.isStartWithReplay,this.isReplayable=e.isReplayable,this._createStatesAction(),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange.bind(this,this.adStateActions)),this.listenTo(this.model,"change:adManagerState",this._onAdStateChange.bind(this,this.getAdStateActions)),this.model.on("change:viewTopComponent",this._toggleLoadingVisibility,this),this.model.on("change:repeatState",this._onReplayAdShowing,this),this.globalModel&&this.listenTo(this.globalModel,"change:adManagerState",this._onGlobalModelAdStateChange.bind(this,this.getAdStateActions))},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),stopped:this._stop.bind(this)},this.getAdStateActions={stopped:this._stop.bind(this)}},_onGlobalModelAdStateChange:function(e,t,i){if(i==a.adManagerState.stopped){var n=e[i];n&&n()}},_onAdStateChange:function(e,t,i){var n=e[i];n&&n()},render:function(){this.$el.append('<div class="_cm-loading-div"> </div>'),this.loadingDiv=this.$el.find("._cm-loading-div"),"css"==this.model.get("components.Loading.type")?this.loadCss():"img"==this.model.get("components.Loading.type")&&this.loadImage(),this._applyAdditionalCss(),this.isShowReplayScreen&&this.$el.css("background","transparent"),this.$el.hide(),this.container.appendChild(this.el),this._renderReapet(),this.currentActiveImage=this.innerDisplay},_renderReapet:function(){this.repeatEl=(0,E.default)(Ol),this._setBackground(),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this.repeatEl.hide(),this.loadingDiv.append(this.repeatEl)},_setRepeatIcon:function(){this.repeatViewWrapper=this.repeatEl.find("._cm-repeat-view-wrapper"),this.repeatButtonsWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var e=this.repeatEl.find("._cm-repeat-button"),t=this.repeatEl.find("._cm-repeat-button-hover"),i=this.model.get("components.Repeat.repalyIcon"),n=this.model.get("components.Repeat.replayHoverIcon");this._setButtonSrc(e,t,i,n)},_setLearnMoreIcon:function(){var e=this.repeatEl.find("._cm-learn-more-button"),t=this.repeatEl.find("._cm-learn-more-button-hover"),i=this.model.get("components.Repeat.learnMoreIcon"),n=this.model.get("components.Repeat.learnMoreHoverIcon");this._setButtonSrc(e,t,i,n),this.model.get("adClickThroughUrl")?this.repeatEl.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_setButtonSrc:function(e,t,i,n){e.attr("src",i),t.attr("src",n)},_setBackground:function(){var e=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+e+'") !important')},loadCss:function(){var e=document.createElement("div");e.className="_cm-loading-icon",this.loadingDiv.append(e),this.innerDisplay=(0,E.default)(e)},loadImage:function(){var e=document.createElement("img");e.src=this.model.get("components.Loading.imgUrl"),e.className="_cm_loader_img",this.loadingDiv.append(e),this.innerDisplay=(0,E.default)(e)},hide:function(){this.isRepeatShowing=!1,this.$el.hide(),this._setModel("loadingViewState",a.loadingViewState.hiding)},show:function(){this.isShowReplayScreen&&this._showRe(),this.$el.show(),this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height()),this._setModel("loadingViewState",a.loadingViewState.showing)},showRepeat:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stop(e)},_onRepeatClick:function(e){e.stopPropagation(),this.log.info("User click"),this.clickEventRegistered=!1,this._setModel("loadingViewState",a.loadingViewState.clicked),this.repeatEl.hide(),this.innerDisplay.show(),this.currentActiveImage=this.innerDisplay,this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height())},_onLearnMoreClick:function(e){window.open(this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_onAdPlaying:function(){this.hide()},_onVideoComplete:function(){this.model.get("displayFiller.betweenAds")!==r().DISPLAY_FILLER.BETWEEN_ADS.CONTENT&&this.show()},_stop:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.model.get("isAdClosedByTimer")||this.model.get("closeState")||(this.clickEventRegistered||(this.repeatButtonsWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.show(),this.innerDisplay.hide(),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.repeatButtonsWrapper.hide(),e&&this.repeatViewWrapper.addClass("_cm-repeat-view-wrapper-detached"),this.repeatEl.show())},_showRe:function(){this.isRepeatShowing||(this.innerDisplay.hide(),this.clickEventRegistered||(this.repeatButtonsWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.repeatButtonsWrapper.hide(),this.repeatEl.show(),this.isRepeatShowing=!0)},_setLoadingViewSize:function(e,t){this.loadingDiv.css({width:e,height:t})},_setModel:function(e,t){this.globalModel&&this.globalModel.set(e,t),this.model.set(e,t)},_applyAdditionalCss:function(){var e=this.model.get("additionalCss");e&&((e["z-index"]||e.zIndex)&&this.$el.css({"z-index":e["z-index"]}))},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.repeatEl.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},_toggleLoadingVisibility:function(){var e=this.model.get("viewTopComponent");this.log.info("_onTopComponentChange",e),e===r().FLOATING_VIEW_TOP_COMPONENT.loading?this.show():this.hide()},_onReplayAdShowing:function(){this.model.get("repeatState")===a.repeatState.showing&&this.hide()},resize:function(e){this._isLoadingViewDisplayed()&&this.loadingDiv.css(e)},onAttach:function(){this._isLoadingViewDisplayed()&&this.repeatViewWrapper.removeClass("_cm-repeat-view-wrapper-detached")},_isLoadingViewDisplayed:function(){return this.model.get("loadingViewState")===a.loadingViewState.showing}}),i(9288)),Il=i(1999),Rl=i(9652),xl=i(9831),Bl=Dl.View.extend({events:{"click ._cm-opt-button":"toggleDialog","click ._cm-cancel":"hideDialog","click ._cm-submit":"submitDialog"},id:"_cm-opt-out-view",className:"_cm-opt-out-view",initialize:function(e){this.log=new Rl({unitType:e.unitType,className:"optOut"}),this.container=e.container,this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append('<div class="_cm-opt-out"> <div class="_cm-opt-button"></div> <div class="_cm-opt-dialog"> <div id="" class="_cm-opt-message"> Never show me Video ads </div> <textarea class="_cm-opt-text" placeholder="What was the problem with this ad?"></textarea> <div> <button type="button" class="_cm-cancel">Cancel</button> <button type="button" class="_cm-submit">Send</button> </div> </div> </div>'),(0,E.default)(this.container).prepend(this.$el),this.ui={},this.ui.Dialog=this.$el.find("._cm-opt-dialog"),this.hideDialog()},toggleDialog:function(){"none"===this.ui.Dialog.get(0).style.display?this.showDialog():this.hideDialog()},showDialog:function(){this.$el.trigger("cm:optout:dialog:show"),this.ui.Dialog.show()},hideDialog:function(){this.$el.trigger("cm:optout:dialog:hide"),this.ui.Dialog.hide()},submitDialog:function(){var e=this.el.querySelector("._cm-opt-text").value,t=this.model.getPixel("pixels.optOutNever")+"&userComplaint="+e;Il.firePixel(t,"Never OptOut"),this.hideDialog(),this.model.set("state",this.model.STATE.OPT_OUT),this.model.set("closeState",xl.closeState.terminate),this.$el.trigger("cm:optout:submit")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()}}),Vl=i(9288),Fl=i(1999),Ml=i(9652),Nl=Vl.View.extend({errorCount:0,events:{"click ._cm-playlist-item":"_onItemClick"},initialize:function(e){this.log=new Ml({unitType:"playlist-item",className:"PlayListView"}),this.model=e.model,this.container=e.container,this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:active",this.setActive)},render:function(){var e={image:this.model.get("image"),title:this.model.get("title")},t=Fl.template('<li class="_cm-playlist-item"> <img class="_cm-playlist-img" src="{{image}}"> <span class="_cm-playlist-text">{{title}}</span> </li>')(e);this.$el.append(t),(0,E.default)(this.container).append(this.$el),this._item=this.$el.find("._cm-playlist-item")},_onItemClick:function(e){this.model.set("clicked",!0)},setActive:function(e,t){t?this._item.addClass("active"):this._item.removeClass("active")}}),Ll=i(6042),jl=i.n(Ll),Ul=(i(9306),i(1999),k().View.extend({errorCount:0,className:"_cm-playlist",initialize:function(e){this.log=new s.Z({unitType:"playlist",className:"PlayListView"}),this.playListCollection=new(jl()),this.container=e.container,this._playlist=e.playlist,this._height=e.height||350,this._itemCount=parseInt(this._height/74),this._itemCount=Math.min(this._playlist.length,this._itemCount),this._playlist=this._playlist.slice(0,this._itemCount),this._height=Math.min(this._height,74*this._itemCount),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(k(),"change:player:content",this._onContentChanged),this.listenTo(this.model,"change:state",this._onStateChange),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},render:function(){this.$el.append('<ul class="_cm-playlist-list"> </ul>'),(0,E.default)(this.container).append(this.$el),this._playlist_list=this.$el.find("._cm-playlist-list"),this.$el.css({height:parseInt(this._height)})},_setPlayList:function(){this.playListCollection.length>0||(this.playListCollection.add(this._playlist),this.playListCollection.forEach((function(e){new Nl({model:e,container:this._playlist_list})}),this),this.playListCollection.first().set("active",!0))},_onStateChange:function(e,t){if(t===e.STATE.PLAYER_READY)this._setPlayList()},_itemSelected:function(e){e.set("clicked",!1),this._playItem(e),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},_playItem:function(e){if(!this._playlist_list.hasClass("unclickable")){var t=this.playListCollection.findWhere({active:!0});t&&t.set("active",!1),e.set("active",!0),this.$el.trigger("_cm-unit-play",e.attributes)}},_onContentChanged:function(e){this.log.important("On content changed",e);var t=this.playListCollection.findWhere({active:!0});t&&t.set("active",!1),(t=this.playListCollection.findWhere({id:e.id}))&&t.set("active",!0)},playNext:function(){var e=this.playListCollection.findWhere({active:!0}),t=this.playListCollection.indexOf(e)+1;t>=this._itemCount&&(t=0),this._playItem(this.playListCollection.at(t))},setUnclickable:function(e){e?this._playlist_list.addClass("unclickable"):this._playlist_list.removeClass("unclickable")}}),i(1999)),Wl=(k().View.extend({className:"_cm-repeat",id:"_cm-css-reset",initialize:function(e){this.log=new s.Z({unitType:"Component",className:"RepeatView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.active=!1,this._createStatesAction(),this._bindEvents(),this._render()},_render:function(){this.repeatEl=(0,E.default)(Ol),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this._setBackground(),this.$el.hide(),this.$el.append(this.repeatEl),this.container.appendChild(this.el)},_setRepeatIcon:function(){this.repeatWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var e=this.repeatEl.find("._cm-repeat-button"),t=this.repeatEl.find("._cm-repeat-button-hover"),i=this.model.get("components.Repeat.repalyIcon"),n=this.model.get("components.Repeat.replayHoverIcon");this._setButtonSrc(e,t,i,n),this.repeatWrapper.click(this._onClick.bind(this))},_setLearnMoreIcon:function(){var e=this.repeatEl.find("._cm-learn-more-button"),t=this.repeatEl.find("._cm-learn-more-button-hover"),i=this.model.get("components.Repeat.learnMoreIcon"),n=this.model.get("components.Repeat.learnMoreHoverIcon");this._setButtonSrc(e,t,i,n),this.model.get("adClickThroughUrl")?this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_setButtonSrc:function(e,t,i,n){e.attr("src",i),t.attr("src",n)},_setBackground:function(){var e=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+e+'") !important')},hide:function(){this.$el.hide(),this.active=!1,this.isSpinning=!1,this.model.set("repeatState",a.repeatState.hiding)},show:function(){this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.repeatWrapper&&this.model.get("dontRenderRepeatButton")&&this.repeatWrapper.hide(),this.$el.show(),this.active=!0,this.model.set("repeatState",a.repeatState.showing)},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange)},_onClick:function(e){e.stopPropagation(),this.isSpinning||this.model.getPixel&&Ul.firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel"),this.model.set("repeatState",a.repeatState.clicked),this.trigger("cm:repeat:click")},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),repeating:this._onAdPlaying.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onAdPlaying:function(){var e=this;setTimeout((function(){e.hide()}),100)},_onVideoComplete:function(){this.model.get("isReplayAd")&&this.show()},_onLearnMoreClick:function(e){window.open(this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},addAdditionalCss:function(e){(0,E.default)(this.repeatEl).addClass(e)}}),i(9288)),Hl=(i(1999),i(9652)),ql=i(2023),Gl=(Wl.View.extend({className:"_cm-timer",initialize:function(e){this.log=new Hl({unitType:e.unitType,className:"timerView"}),this.container=e.container,this._time=Number(e.time)||Number(this.model.get("components.TimerView.time")),this._isHide=e.isHide,this._stepTime=1,this.render()},render:function(){this.$el.append(ql),this.hide(),this.container.appendChild(this.el),this.$el.find("._cm-timer-circle ._cm-timer-mask, ._cm-timer-circle ._cm-timer-fill").css("transition","transform "+this._stepTime+"s linear"),this._innerText=this.$el.find("._cm-timer-inset>span")},startTimer:function(){this.log.info("Timer start"),0!==this._time?(this._currentTimer=this._stepTime,this._innerText.text(parseInt(this._time)),this._setDegree(180/this._time*this._currentTimer),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)):this._finish()},_timerUpdate:function(){if(this._innerText.text(parseInt(this._time-this._currentTimer)),this._currentTimer+=this._stepTime,this._currentTimer>this._time)this._finish();else{var e=180/this._time*this._currentTimer;this._setDegree(e),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)}},_setDegree:function(e){this.$el.find("._cm-timer-circle ._cm-timer-fill, ._cm-timer-circle ._cm-timer-mask._cm-timer-full").css("transform","rotate("+e+"deg)"),this.$el.find("._cm-timer-circle ._cm-timer-fill._cm-timer-fix").css("transform","rotate("+2*e+"deg)")},_finish:function(){this._isHide&&this.hide(),this.$el.trigger("cm:timer:finish")},hide:function(){this.$el.hide()}}),i(1999)),$l="._cm-branding-view-title-text",zl="._cm-branding-view-branding-text",Kl=(k().View.extend({className:"_cm-branding-title",id:"_cm-css-reset",events:{},initialize:function(e){this.log=new s.Z({unitType:"Component",className:"BrandingTitleView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.render(),this.bindEvents()},bindEvents:function(){this.model.listenTo(this.model,"change:customization.titleContainer.branding",this._customize.bind(this)),this.model.listenTo(this.model,"change:customization.titleContainer.branding.displayState",this._onDisplayStateChange.bind(this))},render:function(){this.template=Gl.template('<span class="_cm-branding-view-title-text">{{titleContainer.titleText}}</span> <span class="_cm-branding-view-branding-text">{{titleContainer.BrandingText}}</span>'),this.$el.append(this.template(this.model.attributes)),this.ui={title:this.$el.find($l),branding:this.$el.find(zl)},this._customize(),this.container.appendChild(this.el),this.model.get("isFitToSize")&&this._fitToSize()},_customize:function(){var e=this.model.get("customization.titleContainer.title"),t=this.model.get("customization.titleContainer.branding");e&&((e=Gl.toCssObj(e)).height="auto",this.ui.title.css(e)),t&&((t=Gl.toCssObj(t)).height="auto",this.ui.branding.css(t))},_fitToSize:function(){var e=(0,E.default)(this.container).height(),t=this.model.get("videoPlaceholderSize");e&&t&&(Number(t.height)+this.$el.height()>=e?Number(t.height)+this.ui.title.height()<e?this._hideDescription():this._hide():this._show())},_hide:function(){this.$el.hide()},_show:function(){this.$el.show()},_onDisplayStateChange:function(e){e===a.brandingDisplayState.show?this._showAndFitToSize():this._hide()},_showAndFitToSize:function(){this._show(),this._fitToSize()},_hideDescription:function(){this.ui.branding.hide()}}),i(9288)),Yl=(i(1999),i(9652)),Ql=(Kl.View.extend({className:"_cm-disc-text",id:"_cm-css-reset",initialize:function(e){this.log=new Yl({unitType:e.unitType,className:"disclosureTextView"}),this.disclosureText='<div class="title text opt-out-hidden">{text}</div>',this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=fl.L},render:function(){this._rendered||(this._rendered=!0,this.container.appendChild(this.el),"detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.isActive")?this.show():this.hide():this.model.get("components.disclosureText.isActive")?this.show():this.hide())},_bindEvents:function(){(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onVideoViewStateChange:function(e,t){switch(t){case"detached":0==this.model.get("detachToSlider.components.disclosureText.isActive")?this.hide():this.show();break;case"attached":this.model.get("components.disclosureText.isActive")?this.show():this.hide()}},hide:function(){this.$el.hide()},show:function(){var e="detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.text"):this.model.get("components.disclosureText.text");this.$el[0].innerHTML="",this.$el.append(this.disclosureText.replace("{text}",e)),this.$el.show()}}),i(9288)),Zl=i(1999),Xl=i(3474),Jl=Ql.View.extend({events:{click:"_openAdChoice"},className:"_cm-ad-choice",initialize:function(e){this.log=new s.Z({unitType:this.model.get("unitType"),className:"AdChoice",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.log.info("Ad Choice ".concat(e.type," initialized.")),this.container=e.container,this.parentPlaceholder=e.parent,this.placementType=e.type,this.shouldHandelDetachAttach=n.UNIT_TYPES[this.model.get("unitType")]===n.UNIT_TYPES.FEED_MANAGER&&this.placementType!==n.AD_CHOICE_TYPE.TITLE,this.placementModel=this._getAdChoicePlacementModel(e.type),this.titlePosition=this.model.get("components.adChoice.position"),this.icon=this.model.get("components.adChoice.icon"),this._translateText(),this._bindEvents(),this.render(),this._firstVideoViewStateHandle(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=Zl.template('<a class="_cm-ad-choice-text" target="_blank">{{text}}</a> <a class="_cm-ad-choice-logo" target="_blank"></a>'),this.$el.append(this.template(this.placementModel)),this.$el.children("._cm-ad-choice-logo").css({background:"url("+this.icon+") no-repeat"}),this.placementModel.isActive&&(this.placementModel.adViewStyle&&this.$el.css(Zl.toCssObj(this.placementModel.adViewStyle)),this.$el.find("._cm-ad-choice-text").css(Zl.toCssObj(this.placementModel.style)),this.$el.find("._cm-ad-choice-logo").css(Zl.toCssObj(this.placementModel.logoStyle))),this._setAdChoiceUrl(),this._alignTitle(),(0,E.default)(this.container).append(this.el)},_bindEvents:function(){this.shouldHandelDetachAttach&&(this.log.info("Ad Choice ".concat(this.placementType," is listening to videoViewState")),this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this))),this.listenTo(this.model,"change:adPlayingWithAdChoice",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:content.isContentPlay",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:adjustWideFeed",this._onAdjustWideFeed.bind(this));var e=this.model.get("wurfl.browser.name");e!==n.BROWSER.IE&&e!==n.BROWSER.EDGE||this.listenTo(this.model,"change:isExpandEnded",this._onExpandEnded.bind(this))},_onExpandEnded:function(){this.log.info("onExpandEnded - IE or Edge detected");var e=this;this.$el.hide(),window.setTimeout((function(){e.$el.show()}),0)},_getAdChoicePlacementModel:function(e){var t;switch(e){case n.AD_CHOICE_TYPE.TITLE:t=this.model.get("components.adChoice.title");break;case n.AD_CHOICE_TYPE.VIDEO_AD:t=this.model.get("components.adChoice.videoAd");break;case n.AD_CHOICE_TYPE.SLIDER:t=this.model.get("components.adChoice.slider");break;default:t={text:"",style:{},logoStyle:{}}}return t},_getSCardSelector:function(){var e;switch(n.UNIT_TYPES[this.model.get("unitType")]){case n.UNIT_TYPES.WIDGET_ITEM:e='*[data-placement-name="'+this.model.get("placement")+'"]';break;case n.UNIT_TYPES.FEED_MANAGER:e=".tbl-feed-container .trc-content-sponsored";break;case n.UNIT_TYPES.INLINE_INSTREAM:case n.UNIT_TYPES.INLINE:case n.UNIT_TYPES.SLIDER_INSTREAM:e=".trc_rbox_container .trc-content-sponsored";break;default:e=""}return e},_setAdChoiceUrl:function(){this._selector=this._getSCardSelector();var e=this._extractUrl(this._selector);(0,E.default)("._cm-ad-choice-text",this.$el).attr("href",e),(0,E.default)("._cm-ad-choice-logo",this.$el).attr("href",e)},_extractUrl:function(e){var t,i,n=(0,E.default)(e)[0];n?((0,E.default)(window).width()<=768||this.model.get("isMobile")?(t=(0,E.default)(n).find("a.trc_mobile_adc_link"),this._isOpenNewTab=!0):t=(0,E.default)(n).find("a.trc_desktop_adc_link"),i=t.length>0?(0,E.default)(t[0]).attr("href").replace(/(Card)(\D*)(\d+)/,"Card "+this.model.get("cardNumber")):this.model.get("components.adChoice.fallbackUrl")):(((0,E.default)(window).width()<=768||this.model.get("isMobile"))&&(this._isOpenNewTab=!0),i=this.model.get("components.adChoice.fallbackUrl"));return i},_alignTitle:function(){if(this.placementType===n.AD_CHOICE_TYPE.TITLE&&this._selector){var e=getComputedStyle((0,E.default)(this._selector)[0]);e&&"rtl"===e.direction&&(0,E.default)(this.container).css("text-align","left !important")}},_firstVideoViewStateHandle:function(){n.UNIT_TYPES[this.model.get("unitType")]===n.UNIT_TYPES.FEED_MANAGER&&this.placementType!==n.AD_CHOICE_TYPE.TITLE&&this._handleVideoViewState()},_handleVideoViewState:function(){switch(this.model.get("videoViewState")){case a.videoViewState.attached:this._onAttach();break;case a.videoViewState.detached:this._onDetach()}},_onAttach:function(){switch(this.placementType){case n.AD_CHOICE_TYPE.VIDEO_AD:this._show();break;case n.AD_CHOICE_TYPE.SLIDER:this._hide()}},_onDetach:function(){switch(this.placementType){case n.AD_CHOICE_TYPE.VIDEO_AD:this._hide();break;case n.AD_CHOICE_TYPE.SLIDER:this._show()}this._updateAdChoicesVisibility()},_openAdChoice:function(e){this._firePixel("pixels.adChoice","adChoice click pixel."),window.TRC&&(this._isOpenNewTab||window.TRC.aboutUs&&window.TRC.aboutUs.open&&window.TRC.aboutUs.open(e))},_firePixel:function(e,t){var i=this.model.getPixel(e);Zl.firePixel(i,t)},_show:function(){this.placementModel.isActive&&!this.model.get("adPlayingWithAdChoice")&&this.$el.show(),this._validateComponentVisibilityStatus(!0)},_hide:function(){this.placementModel.isActive&&this.$el.hide(),this._validateComponentVisibilityStatus(!1)},_validateComponentVisibilityStatus:function(e){var t=this.componentsVisibilityListener&&this.model.get(this.componentsVisibilityListener);void 0!==t&&e!==t&&this.model.set(this.componentsVisibilityListener,e)},_updateAdChoicesVisibility:function(){this.model.get("adPlayingWithAdChoice")&&this.placementType!==n.AD_CHOICE_TYPE.TITLE?this._hide():this._show()},_onAdPlayingWithAdChoiceChange:function(){this.model.get("content.isContentPlay")&&!this.model.get("components.adChoice.isActiveOnContent")?this._hide():this.shouldHandelDetachAttach?this._handleVideoViewState():this._updateAdChoicesVisibility()},_onAdjustWideFeed:function(){var e=this.model.get("adjustWideFeed");this.titlePosition===n.TITLE_POSITION.BELOW&&(e?(0,E.default)(this.parentPlaceholder).addClass("_cm-wide-feed-title-below"):(0,E.default)(this.parentPlaceholder).removeClass("_cm-wide-feed-title-below"))},_translateText:function(){this.model.get("components.adChoice.isTranslateText")&&this.model.get("language")&&this.model.set("components.adChoice.videoAd.text",Xl[this.model.get("language").toUpperCase()])},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this._hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this._show():this._hide()}});function ec(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec(e)}function tc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ic(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ic(e,t)}function nc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=oc(e);if(t){var r=oc(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return rc(this,i)}}function rc(e,t){if(t&&("object"===ec(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oc(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oc(e)}i(9288);var sc=i(9652),ac=(o.s,i(9288)),lc=i(1999),cc=i(9652),dc={display:"inline !important"},uc={display:"none !important"},hc={transition:"width 2000ms !important",width:"32px !important"},pc={width:"32px !important"},fc=(ac.View.extend({className:"_cm-volume-area",id:"_cm-css-reset",events:{click:"_toggleVolume"},initialize:function(e){this._setInitialParameters(e),this._isHandleDetach(),this._hasCloseButton(),this._initVolumeState(),this._createStatesAction(),this._setMinimizeOnClickCallback(),this._bindEvents(),this.render(),this.log.info("Volume Button initialized.")},_bindEvents:function(){this.listenTo(this.currModel,"change:volumeMuted",this._onVolumeChange.bind(this)),this.listenTo(this.currModel,"startVolumeAnimation",this._minimizeAfterRender.bind(this)),this._handleDetach&&this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this)),this.currModel.on("lastVolumeStateCheck",this._onLastVolumeStateCheck,this),this.model.on("change:viewTopComponent",this.setButtonVisible,this),this.listenTo(this.model,"change:adQState",this._onAdStateChange),this.model.on("showVolumeButtonOnBackFromSwap",this.show,this)},_setComponentsVisibilityListener:function(){this.model.on("change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange,this),this.model.get(this.componentsVisibilityListener)||this.hide()},render:function(){this._initTemplate(),this._setPosition(),this._styleCustomization(),this._checkIfMinimized(),this._renderComponent()},_initTemplate:function(){var e=lc.template('<div class="_cm-volume-border"> <svg class="_cm-volume-mute" data-name="—ÎÓÈ_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 351.22 266.75"> <defs> <style>.cls-1{fill:#fff}</style> </defs> <g id="_Group_" data-name="&lt;Group&gt;"> <g id="_Group_2" data-name="&lt;Group&gt;"> <path class="cls-1" d="M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z" transform="translate(-155.91 -178.44)"/> </g> </g> <path class="cls-1" d="M486.13,381.62a20.93,20.93,0,0,1-14.85-6.15l-97.62-97.62a21,21,0,1,1,29.69-29.7L501,345.77a21,21,0,0,1-14.85,35.85Z" transform="translate(-155.91 -178.44)"/> <path class="cls-1" d="M388.5,381.62a21,21,0,0,1-14.84-35.85l97.62-97.62a21,21,0,1,1,29.7,29.7l-97.63,97.62A20.93,20.93,0,0,1,388.5,381.62Z" transform="translate(-155.91 -178.44)"/> </svg> <svg class="_cm-volume-unmute" data-name="—ÎÓÈ_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 311.81 266.75"> <defs> <style>.cls-1{fill:#fff}</style> </defs> <g id="_Group_" data-name="&lt;Group&gt;"> <path id="_Path_" data-name="&lt;Path&gt;" class="cls-1" d="M465.85,290.12A124.1,124.1,0,0,0,453.19,253a127.55,127.55,0,0,0-21.66-29.51c-3.38-3.47-7.4-5.23-12.25-4.6a13.27,13.27,0,0,0-11.5,9.27c-1.87,5.38-.66,10.26,3.23,14.43,1,1.05,2,2,2.95,3.1a96.67,96.67,0,0,1,25.09,55.19,95.28,95.28,0,0,1-1.17,29.52,96.57,96.57,0,0,1-26.52,50.23,13.74,13.74,0,0,0-4.23,12.12,13.25,13.25,0,0,0,9.2,11.27c5.3,1.85,10.15.74,14.31-3.08.82-.74,1.57-1.56,2.33-2.36a125,125,0,0,0,34.74-87.88A131.18,131.18,0,0,0,465.85,290.12Z" transform="translate(-155.91 -178.44)"/> <path id="_Path_2" data-name="&lt;Path&gt;" class="cls-1" d="M420.23,307.35a87,87,0,0,0-6.32-28.82A88,88,0,0,0,395,249.69a14,14,0,0,0-24.29,11.22,16.39,16.39,0,0,0,4.73,8.92c13.86,14.79,19.22,32.3,16.05,52.27a58.5,58.5,0,0,1-16.83,32.54A14,14,0,0,0,388.48,378c3.13-.88,5.44-2.88,7.6-5.18,16.05-17.16,23.94-37.57,24.15-61C420.23,310.31,420.29,308.83,420.23,307.35Z" transform="translate(-155.91 -178.44)"/> <path id="_Path_3" data-name="&lt;Path&gt;" class="cls-1" d="M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z" transform="translate(-155.91 -178.44)"/> </g> </svg> <div class="_cm-volume-text">{{expandedText}}</div> </div> ')(this._settings);this.$el.append(e)},_renderComponent:function(){var e=this,t=this.model.get("wurfl.browser.name");t===n.BROWSER.IE||t===n.BROWSER.EDGE?setTimeout((function(){(0,E.default)(e.container).append(e.el)}),200):(0,E.default)(this.container).append(this.el)},_setInitialParameters:function(e){this.log=new cc({unitType:this.model.get("unitType"),className:"volumeButtonView"}),this.container=e.container,this.currModel=e.globalModel?e.globalModel:this.model,this._settings=this.model.get("components.volume"),this._isMuted=!0,this._unitType=n.UNIT_TYPES[this.model.get("unitType")],this._isAlwaysBottom=this.model.get("components.volume.isAlwaysBottom"),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},_initVolumeState:function(){void 0===this.currModel.get("volumeMuted")&&this.currModel.set("volumeMuted",!0)},_setMinimizeOnClickCallback:function(){this._minimizeOnClick=lc.once(this._minimize.bind(this,hc))},_onLastVolumeStateCheck:function(){this._onVolumeChange()},_toggleVolume:function(){this._isMuted?(this._unMute(),this._fireUnmute()):(this._mute(),this._fireMute()),this._minimizeOnClick(),this.currModel.set("volumeUserInteraction",!0)},_mute:function(){this._showMute(),this._hideUnmute(),this._isMuted=!0},_unMute:function(){this._hideMute(),this._showUnmute(),this._isMuted=!1},_fireMute:function(){this.currModel.set("volumeMuted",!0),this.currModel.set("onUnMuteClicked",!1)},_fireUnmute:function(){this.currModel.set("volumeMuted",!1),this.currModel.set("onUnMuteClicked",!0)},_onVolumeChange:function(){this.currModel.get("volumeMuted")?this._mute():this._unMute()},_minimizeAfterRender:function(){this.currModel.get("volumeMustBeMinimized")?this._minimize(pc):setTimeout(function(){this._isMinimized||this._minimize(hc)}.bind(this),this._settings.timeToMinimize)},_minimize:function(e){(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(e),this._isMinimized=!0,this.currModel.set("volumeMustBeMinimized",!0)},_hideMute:function(){(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(uc)},_showMute:function(){(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(dc)},_hideUnmute:function(){(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(uc)},_showUnmute:function(){(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(dc)},_setPosition:function(){this.hasCloseButton||this._isAlwaysBottom?this.$el.addClass("_cm-volume-area-bottom"):this.$el.addClass("_cm-volume-area-top"),this._handleDetach&&this._handleVideoViewState()},_isHandleDetach:function(){this._handleDetach=!1,this._unitType===n.UNIT_TYPES.FEED_MANAGER&&!1===this.model.get("hasCloseButton")&&!0===this.model.get("detachToSlider.hasCloseButton")&&(this._handleDetach=!0)},_hasCloseButton:function(){this._unitType!==n.UNIT_TYPES.FEED_MANAGER&&this._unitType!==n.UNIT_TYPES.INLINE_INSTREAM&&this._unitType!==n.UNIT_TYPES.MSN_WIDGET||(this.hasCloseButton=this.model.get("closeButton.hasCloseButton")),this._unitType!==n.UNIT_TYPES.WIDGET_ITEM&&this._unitType!==n.UNIT_TYPES.EXPANDABLE&&this._unitType!==n.UNIT_TYPES.EXPANDABLE_MOBILE||(this.hasCloseButton=this.model.get("components.CloseButtonView.hasCloseButton")),this._unitType,n.UNIT_TYPES.SLIDER_INSTREAM,this._unitType,n.UNIT_TYPES.EXPANDABLE},_handleVideoViewState:function(){if(!this._isAlwaysBottom){var e=this.model.get("videoViewState");e===a.videoViewState.attached&&(this.$el.addClass("_cm-volume-area-top"),this.$el.removeClass("_cm-volume-area-bottom")),e===a.videoViewState.detached&&this.hasCloseButton&&(this.$el.addClass("_cm-volume-area-bottom"),this.$el.removeClass("_cm-volume-area-top"))}},_styleCustomization:function(){this._settings.style&&(lc.isEmpty(this._settings.style.border)||(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(this._settings.style.border),lc.isEmpty(this._settings.style.mute)||(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(this._settings.style.mute),lc.isEmpty(this._settings.style.unmute)||(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(this._settings.style.unmute),lc.isEmpty(this._settings.style.text)||(0,E.default)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-text").css(this._settings.style.text))},_checkIfMinimized:function(){this._unitType===n.UNIT_TYPES.FEED_MANAGER&&this.currModel.get("volumeMinimized")&&this._minimize(pc)},setButtonVisible:function(){this.log.info("_onTopComponentChange",this.model.get("viewTopComponent")),this.model.get("viewTopComponent")===n.FLOATING_VIEW_TOP_COMPONENT.video?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_createStatesAction:function(){this.adStateActions={q0:this.show.bind(this),completed:this.hide.bind(this),repeating:this.show.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onComponentsVisibilityChange:function(){this.currModel.get(this.componentsVisibilityListener)?this.show():this.hide()}}),'<div class="_cm-ad-loading-progress-container"> <div class="_cm-ad-loading-progress-bar-container"> <div class="_cm-ad-loading-progress-title"> <span class="_cm-ad-loading-progress_title_span"></span> <span class="_cm-ad-loading-progress_percent_span">0%</span> </div> <div class="_cm-ad-loading-progress-bar"> <div class="_cm-ad-loading-progress-bar-loaded"> </div> </div> </div> </div>'),mc=i(9288),gc=i(1999),yc=i(9652);mc.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(e){this.model.set("progressLoaderInit",!0),this._setInitialParameters(e),this._bindEvents(),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show()),this.render(),this.log.info("ad-loading-progress initialize")},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenTo(this.currModel,"change:isFirstAdLoaded",this._onFirstAdLoaded.bind(this)),this.listenToOnce(this.currModel,"change:hasReadyAd",this._onAdImpression.bind(this)),this.listenTo(this.currModel,"ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(e){this.log=new yc({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.currModel=e.globalModel?e.globalModel:this.model,this.$el=(0,E.default)(this.el),this.viewPercent=this.currModel.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.currModel.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.currModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/50,this.showProgress=this.currModel.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this.model.get("eligiblePlaceholder")?this._renderComponent():this.model.once("change:eligiblePlaceholder",this._renderComponent.bind(this))},_renderComponent:function(){this.container=this.model.get("eligiblePlaceholder");var e={width:this.model.get("width")+3+"px",height:this.model.get("height")+2+"px"};this.$el.css(e),this.$el.css(this._getPosition(this.model.get("eligiblePlaceholder"))),(0,E.default)("body").append(this.el),this.$el.css(),(0,E.default)("._cm-ad-loading-progress_title_span").text(this.currModel.get("components.adLoadingProgress.title")),this.showProgress&&(0,E.default)("._cm-ad-loading-progress-container").css({display:"block"})},_initTemplate:function(){var e=gc.template(fc)(this._settings);this.$el.append(e),this.$loadingPercentElement=(0,E.default)("._cm-ad-loading-progress_percent_span")},_onFirstAdLoaded:function(){this.log.info("FirstAd _onFirstAdLoaded loaded"),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show())},_startWatchingViewPort:function(){this.listenTo(mc,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1));var e=this.$el.parent().height();this.$el.parent().height(e+1)},_calculateViewPortIntersection:function(){if(!this.stopWatchingViewPort){var e=gc.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.currModel.get("scrollSelector"));this.log.info("currViewPercent: ",e||0),this.viewPercent<=e&&(this._startLoadingTimer(),this.stopWatchingViewPort=!0)}},_onAdImpression:function(){this.model.get("progressLoaderTimerReached")&&this.model.set("eligiblePlaceholder",!1),this.close()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this.log.info("Loading timer progress reached"),this.currModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress(),(0,E.default)("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})}.bind(this),this.progressTik)},_calculateLoadingProgress:function(){(0,E.default)("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=2,this.currModel.set("loaderCurrCount",this.count))},_restart:function(){this.container=this.model.get("eligiblePlaceholder"),this._renderComponent(),this._hide(),this.currModel.set("progressLoaderTimerReached",!1),(0,E.default)("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,(0,E.default)("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.stopWatchingViewPort=!1,this._show()},_show:function(){this.$el.css({display:"flex"})},_hide:function(){this.$el.css({display:"none"})},close:function(){this.model.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(mc,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive".false)},_customize:function(){var e=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(gc.toCssObj(e))},_getPosition:function(e){var t=e.getBoundingClientRect(),i=document.body.getBoundingClientRect();return{top:t.top-i.top-1+"px",left:t.left+"px"}}});function vc(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(e)}function bc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wc(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wc(e,t)}function Tc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Sc(e);if(t){var r=Sc(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Pc(this,i)}}function Pc(e,t){if(t&&("object"===vc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Sc(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sc(e)}i(1999);var Ac={id:"_cm-static-banner-view",className:"_cm-static-banner-view"};o.s;function Ec(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ec(e)}function Cc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kc(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},kc(e,t)}function Oc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ic(e);if(t){var r=Ic(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Dc(this,i)}}function Dc(e,t){if(t&&("object"===Ec(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ic(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ic(e)}var Rc=i(1999),xc=(o.s,i(9288)),Bc=i(1999),Vc=i(9652),Fc=(i(9831),xc.View.extend({className:"_cm-skip-ad-area",id:"_cm-skip-ad-area",events:{"click ":"_onClick"},initialize:function(e){this.log=new Vc({unitType:e.unitType,className:"SkipAdButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=fl.L,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){this._rendered=!0,this._settings=this.model.get("components.skipAdButton");var e=Bc.template('<div class="_cm-skip-ad-border"> <div class="_cm-skip-ad-text">{{skipAdText}}</div> <div class="_cm-skip-ad-icon"> <svg width="14" height="12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200"> <line x1="2" y1="2" x2="98" y2="110" style="stroke:#fffefd;stroke-width:40"/> <line x1="2" y1="198" x2="98" y2="90" style="stroke:#fffefd;stroke-width:40"/> Sorry, your browser does not support inline SVG. </svg> </div></div>')(this._settings);this.$el.append(e),this.container.appendChild(this.el)}},_bindEvents:function(){},_onClick:function(e){e.stopPropagation(),this.model.increaseCounter("skipButtonClicked")},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),i(9288)),Mc=(i(1999),i(9652)),Nc=Fc.View.extend({className:"video_controls show",id:"video_controls",initialize:function(e){this.log=new Mc({unitType:e.unitType,className:"progressBarView"}),this.model=e.model,this.container=e.container,this.video=e.video,this._bindEvents(),this.render()},_bindEvents:function(){this.video.addEventListener("ended",this.resetProgress.bind(this)),this.model.listenTo(this.model,"change:mute",this.muteChanged.bind(this)),this.model.listenTo(this.model,"change:content.startProgressBar",this.ManageProgressBarInterval.bind(this))},render:function(){this.container.appendChild(this.el),this.$el.append('<div class="video_controls video_controls_main_area"> <div class="cm_video_controls_progressbar_area"> <div class="cm_video_controls_progressbar_bg white_bg"></div> <div class="cm_video_controls_progressbar blue_bg"></div> </div> <div class="cm_video_controls_mute interactive"> <div class="cm_video_controls_volume display_mute"></div> <div class="cm_video_controls_volume display_unmute"></div> </div> <div class="cm_video_controls_playpause interactive show"> <div class="pause show"></div> <div class="play hide"></div> </div> </div> '),this.setControls(),this.show()},setControls:function(){this.setProgressBarComponent(),this.setPlayPauseButton(),this.setMuteButton()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},setProgressPercent:function(e){this.progressDiv.style.width=e+"%"},resetProgress:function(){this.progressDiv.classList.add("init_bg"),this.setProgressPercent(0)},playClicked:function(){this.model.set("content.playClicked",!0),this.model.set("content.pauseClicked",!1),this.pauseButton.classList.add("show"),this.pauseButton.classList.remove("hide"),this.playButton.classList.remove("show"),this.playButton.classList.add("hide")},pauseClicked:function(){this.model.set("content.pauseClicked",!0),this.playButton.classList.add("show"),this.playButton.classList.remove("hide"),this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")},muteClicked:function(){this.model.get("mute")?this.unMute():this.mute()},muteChanged:function(){this.model.get("mute")?this.setMuteClasses():this.setUnMuteClasses()},mute:function(){this.model.set("mute",!0),this.setMuteClasses()},unMute:function(){this.model.set("mute",!1),this.setUnMuteClasses()},setMuteClasses:function(){this.muteImg.style.display="block",this.unmuteImg.style.display="none"},setUnMuteClasses:function(){this.muteImg.style.display="none",this.unmuteImg.style.display="block"},setProgressBarComponent:function(){this.progressDiv=this.$el.find(".blue_bg")[0],this.progressComponentDiv=this.$el.find(".cm_video_controls_progressbar_area")[0],this.model.get("components.contentVideo.hideProgressBar")&&(this.progressComponentDiv.style.display="none"),this.resetProgress()},setMuteButton:function(){this.muteButton=this.$el.find(".cm_video_controls_mute").get(0),this.model.get("components.contentVideo.hideMuteButton")&&(this.muteButton.style.display="none"),this.muteImg=this.$el.find(".cm_video_controls_mute .display_mute").get(0),this.unmuteImg=this.$el.find(".cm_video_controls_mute .display_unmute").get(0),this.muteImg.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.muteImgUrl"),'")'),this.unmuteImg.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.unmuteImgUrl"),'")'),this.muteButton.onclick=this.muteClicked.bind(this),this.muteChanged()},setPlayPauseButton:function(){this.playButton=this.$el.find(".play")[0],this.pauseButton=this.$el.find(".pause")[0],this.pauseButton.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.pauseImgUrl"),'")'),this.model.get("components.contentVideo.hidePlayButton")&&(this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")),this.playButton.onclick=this.playClicked.bind(this),this.pauseButton.onclick=this.pauseClicked.bind(this)},ManageProgressBarInterval:function(){this.model.get("content.startProgressBar")?this.progressInterval=setInterval(this.setProgress.bind(this),100):this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)},setProgress:function(){this.setProgressPercent(this.video.currentTime/this.video.duration*100)}}),Lc=i(9288),jc=i(1999),Uc=i(9652),Wc=(Lc.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(e){e.isActive&&(this.model=e.model,this.container=e.container,this._setInitialParameters(e),this._bindEvents(),this.render(),this._startWatchingViewPort(),this.log.info("ad-loading-progress initialize"))},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenToOnce(this.model,"change:hasReadyAd",this.close.bind(this)),this.listenTo(this.model,"change:ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(e){this.log=new Uc({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.globalModel=e.globalModel||this.model,this.globalModel.set("progressLoaderInit",!0),this.$el=(0,E.default)(this.el),this.viewPercent=this.model.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.model.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.globalModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/100,this.showProgress=this.model.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this._renderComponent(),this._show()},_initTemplate:function(){var e=jc.template(fc)(this._settings);this.$el.append(e),this.$loadingPercentElement=(0,E.default)("._cm-ad-loading-progress_percent_span")},_customize:function(){var e=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(jc.toCssObj(e))},_renderComponent:function(){var e={width:this.model.get("width")+"px",height:this.model.get("height")+"px"};this.$el.css(e),(0,E.default)(this.container).append(this.el),(0,E.default)("._cm-ad-loading-progress_title_span").text(this.model.get("components.adLoadingProgress.title")),this.showProgress&&(0,E.default)("._cm-ad-loading-progress-container").css({display:"block"})},_startWatchingViewPort:function(){this.listenTo(Lc,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1)),this._calculateViewPortIntersection()},_calculateViewPortIntersection:function(){var e=jc.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.model.get("scrollSelector"));!this.calculationRunning&&this.viewPercent<=e&&this._startLoadingTimer(),this.calculationRunning&&!e&&this.el.getBoundingClientRect().top<0&&this._stopCalculation()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this._stopCalculation()}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationRunning=!0,this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress()}.bind(this),this.progressTik),(0,E.default)("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})},_stopLoadingTimer:function(){this.loadingTimer&&clearTimeout(this.loadingTimer)},_stopCalculation:function(){this.calculationRunning=!1,this.globalModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null},_calculateLoadingProgress:function(){(0,E.default)("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=1,this.globalModel.set("loaderCurrCount",this.count))},_restart:function(){this._stopLoadingTimer(),this.globalModel.set("progressLoaderTimerReached",!1),this.model.get("ProgressLoaderRepositioned")&&((0,E.default)("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,(0,E.default)("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.calculationRunning=!1,this.model.set("ProgressLoaderRepositioned",!1))},_show:function(){this.$el.css({display:"flex"}),this.model.set("isProgressLoaderViewRunning",!0)},_hide:function(){this.$el.css({display:"none"})},close:function(){this.log.info("close loader"),this.model.set("isProgressLoaderViewRunning",!1),this.globalModel.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(Lc,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive",!1)}}),i(9288)),Hc=i(1999),qc=i(9652),Gc=Wc.View.extend({className:"_cm-click-blocker-container",initialize:function(e){this.log=new qc({unitType:e.unitType,className:"clickBlockerView"}),this.options=e,this.model=e.model,this.container=e.container,this.render()},render:function(){this.template=Hc.template('<div class="_cm-click-blocker _cm-click-blocker-top"></div> <div class="_cm-click-blocker _cm-click-blocker-bottom"></div> <div class="_cm-click-blocker _cm-click-blocker-left"></div> <div class="_cm-click-blocker _cm-click-blocker-right"></div>'),this.$el.append(this.template(this.options)),this.SetClickBlockerDivStyle(),this.options.style&&this.$el.css(this.options.style),this.container.appendChild(this.el)},SetClickBlockerDivStyle:function(){var e=this;this.containerDimentions=this.container.getBoundingClientRect();var t=this.$el.children();t.forEach((function(t){return e.setBasicBlockerDivStyle(t)}));var i=this.model.get("components.ClickBlocker.blockPercent.vertical"),n=this.model.get("components.ClickBlocker.blockPercent.horizontal");t[0].style.height=this.containerDimentions.height*i+"px",t[1].style.height=this.containerDimentions.height*i+"px",t[2].style.width=this.containerDimentions.width*n+"px",t[3].style.width=this.containerDimentions.width*n+"px"},setBasicBlockerDivStyle:function(e){e.style.width=this.containerDimentions.width+"px",e.style.height=this.containerDimentions.height+"px"}});function $c(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$c(e)}function zc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kc(e,t){return Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Kc(e,t)}function Yc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Zc(e);if(t){var r=Zc(this).constructor;Reflect.construct(n,arguments,r)}else n.apply(this,arguments);return Qc(this,i)}}function Qc(e,t){if(t&&("object"===$c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zc(e){return Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zc(e)}var Xc=i(1999),Jc="_cm-native-ad",ed={title:"._cm-native-ad-title",ctaButtone:"._cm-native-ad-cta-button",description:"._cm-native-ad-description",icon:"._cm-native-ad-icon",branding:"._cm-native-ad-branding",adChoice:"._cm-ad-choice",placeholder:"._cm-feed-manager-video-placeHolder",wrapper:"._cm-native-ad-bottom"};o.s;i(1999);var td=i(9288),id=i(1999),nd=i(9652),rd=td.View.extend({className:"_cm-content-carousel-item",events:{"click ":"_onClick"},initialize:function(e){this.log=new nd({unitType:e.unitType,className:"ContentCarouselItemView"}),this.model=e.model,this.itemId=e.itemId,this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=fl.L,(0,E.default)(this.container).append(this.$el),this._setInfo(),this.render()},render:function(){if(!this._rendered){var e=id.template('<img src="{{image}}" height="70" width="120" class="_cm-content-carousel-item-image"/> <div class="_cm-content-carousel-item-description {{selected}}"> {{title}} </div> <div class="_cm-content-carousel-item-play-icon {{selected}}"> <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM6 12V4L11.5 8L6 12Z" fill="white"/> </svg> </div> <div class="_cm-content-carousel-item-playing-now {{selected}}"> {{playingNowString}} </div>')(this.itemInfo);this.$el.append(e),this.imageNode=this.$el.find("._cm-content-carousel-item-image"),this.imageNode.css({"background-image":' url("'.concat(this.model.get("components.contentCarousel.backgroundImage"),'")')})}},_bindEvents:function(){},_onClick:function(){this.itemInfo.selected||this.model.set("playlistItemClicked",this.itemId)},_setInfo:function(){this.itemInfo=this.model.get("player.playlist")[this._getItemIndex()],this.itemInfo.description=this.itemInfo.title.replace(/-/g," "),this.itemInfo.playingNowString=this.model.get("playingNowString"),this.updateSelected()},updateSelected:function(){this.itemInfo.selected=this.model.get("player.playlist")[this._getItemIndex()].selected,(0,E.default)(this.$el).removeClass("true"),(0,E.default)(this.$el).removeClass("false"),(0,E.default)(this.$el).addClass(this.itemInfo.selected.toString())},_getItemIndex:function(){for(var e=this.model.get("player.playlist"),t=0,i=0;i<e.length;i++)if(e[i].id===this.itemId){t=i;break}return t}}),od=i(9288),sd=(i(1999),i(9652));od.View.extend({className:"_cm-content-carousel-area",id:"_cm-content-carousel-area",initialize:function(e){this.log=new sd({unitType:e.unitType,className:"ContentCarouselView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=fl.L,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener(),(0,E.default)(this.container).append(this.$el)},render:function(){this._rendered?this.updatePlaylistItem():(this._rendered=!0,this.$el.append('<div class="_cm-content-carousel-items-container-wrapper"> <div class="_cm-content-carousel-items-container"> </div> </div> <div class="_cm-content-carousel-arrows"> <div class="_cm-content-carousel-arrow _cm-content-carousel-arrow-left"> <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M0.999999 12L7 6.5L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" transform="rotate(-180 4,6.5) "/> </svg> </div> <div class="_cm-content-carousel-arrow _cm-content-carousel-arrow-right"> <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M0.999999 12L7 6.5L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/> </svg> </div> </div> <div class="_cm-content-carousel-blocker"> </div> '),this.listContainer=this.$el.find("._cm-content-carousel-items-container"),this.blockDiv=this.$el.find("._cm-content-carousel-blocker"),this.scrollElement=document.querySelector("div._cm-content-carousel-items-container-wrapper"),this.listItemsArray=[],this.unBlockView(),this._createListItems(),this._setScrollButtons())},_createListItems:function(){for(var e=this.model.get("player.playlist"),t=0;t<e.length;t++)e[t].id=t,e[t].selected=!1;this.model.set("player.playlist",e);for(var i=0;i<e.length;i++){var n=new rd({model:this.model,container:this.listContainer,itemId:i});this.listItemsArray.push(n)}},_bindEvents:function(){},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},_setScrollButtons:function(){var e=this.$el.find("._cm-content-carousel-arrow-left"),t=this.$el.find("._cm-content-carousel-arrow-right");e.on("click",this._scrollLeft.bind(this)),t.on("click",this._scrollRight.bind(this))},_scrollLeft:function(){this.scrollElement.scrollBy(-100,0)},_scrollRight:function(){this.scrollElement.scrollBy(100,0)},hide:function(){this.$el.hide()},show:function(){this.$el.show()},blockView:function(){this.blockDiv.css({display:"block"})},unBlockView:function(){this.blockDiv.css({display:"none"})},updatePlaylistItem:function(){for(var e=0;e<this.listItemsArray.length;e++)this.listItemsArray[e].updateSelected()}}),i(9652);function ad(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ld=i(1999),cd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.urlParams=t.urlParams,this.maxWFRetries=t.wfRetries,this.wfRetries=0,this.isFirePiggies=t.isFirePiggies,this.secondsBW=t.secondsBW,this.log=new s.Z({className:"Waterfall Manager"}),this.wfUrl=t.wfUrl,this.wfUrl.startsWith("//")||(this.wfUrl="//"+this.wfUrl),this.isRon=ld.rollNumbers(t.ronPercent)}var t,i,n;return t=e,(i=[{key:"updateUrlParams",value:function(e){this.urlParams=E.default.extend(!0,{},this.urlParams,e)}},{key:"callWaterfall",value:function(e,t){this.successCallback=e,this.errorCallback=t;var i=this.wfUrl;this.wfRetries++;var n={cb:(new Date).getTime(),height:this.urlParams.height,oid:this.urlParams.originId,pubid:this.urlParams.pubId,tagid:this.urlParams.tagId,width:this.urlParams.width,noaop:this.urlParams.noaop,crid:this.urlParams.crid,sortOrderType:0,mindur:1,maxdur:60,minbr:1,maxbr:512,proto:"2,3,5,6",st:0,mimes:Object.keys(r().MIME_TYPES).toString(),dtagid:this.urlParams.dtagid,dpubid:this.urlParams.dpubid,viewable:this.urlParams.isViewable};this.isRon&&(n.noaop=1,n.sortOrderType=2),this.urlParams.cirf&&(n.cirf=encodeURIComponent(decodeURIComponent(this.urlParams.cirf))),i=ld.addParametersToUrl(i,n,!0),i+="callback=&",E.default.ajax({type:"GET",url:i,success:this.onWaterfallSuccess.bind(this),error:this.recallWF.bind(this)})}},{key:"recallWF",value:function(){this.wfRetries>=this.maxWFRetries?this.errorCallback():window.setTimeout(this.callWaterfall.bind(this,this.successCallback,this.errorCallback),1e3*this.secondsBW)}},{key:"onWaterfallSuccess",value:function(e,t,i){if(!i)return this.log.error("The request is empty!"),void this.recallWF();var n=new Function("try { return "+i.responseText+";} catch(e){return false}")();n=this.handleWaterfallObject(n),this.successCallback(n)}},{key:"handleWaterfallObject",value:function(e){var t=/http(?:s:|:)([^'"]*)/g;return this.isFirePiggies&&this._firePiggies(e.pixel_piggies),ld.each(e.tags,(function(e,i,n){e.id=Date.now()+Math.floor(1e3*Math.random()),e.seqNum=i+1,e.dast=e.pixel?this._getDastFromPixel(e.pixel):"",e.isRon=this.isRon;var r=t.exec(e.pixel);r&&r.length>1&&(e.pixel=r[1])}),this),e}},{key:"_firePiggies",value:function(e){ld.each(e,(function(e){ld.fireIframePixel(e.url,"Piggie")}))}},{key:"replaceMacros",value:function(e,t){var i=ld.extend({},{ua:encodeURIComponent(navigator.userAgent),cb:Date.now(),keywords:""},t),n=(new Date).getTime();return e=this._replaceMacro(/%%referrer%%/gi,i.referrer,e),e=this._replaceMacro(/%%domain%%/gi,i.domain,e),e=this._replaceMacro(/%%video-url%%/gi,i.videoUrl,e),e=this._replaceMacro(/%%page-url%%/gi,i.pageUrl,e),e=this._replaceMacro(/%%player-width%%/gi,i.playerWidth,e),e=this._replaceMacro(/%%player-height%%/gi,i.playerHeight,e),e=this._replaceMacro(/%%timestamp%%/gi,Math.floor(n/1e3),e),e=this._replaceMacro(/%%vidlength%%/gi,i.videoLength,e),e=this._replaceMacro(/%%keywords%%/gi,i.keywords,e),e=this._replaceMacro(/%%description%%/gi,i.description,e),e=this._replaceMacro(/%%vertical%%/gi,i.vertical,e),e=this._replaceMacro(/%%title%%/gi,i.title,e),e=this._replaceMacro(/%%cirf%%/gi,i.cirf,e),e=this._replaceMacro(/%%cb%%/gi,i.cb,e),e=this._replaceMacro(/%%ip%%/gi,i.ip,e),e=this._replaceMacro(/%%UA%%/gi,i.ua,e),e=this._replaceMacro(/%%country%%/gi,i.country,e),e=this._replaceMacro(/%%latitude%%/gi,i.lat,e),e=(e=this._replaceMacro(/%%longitude%%/gi,i.long,e)).replace(/%%[^%]*%%/gi,"")}},{key:"_replaceMacro",value:function(e,t,i){return void 0===t&&(t=""),i.replace(e,t)}},{key:"_getDastFromPixel",value:function(e){var t=e.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=t.length)return"";var i=t[1].split(/\?|&/gi);for(var n in i)if(i[n]){var r=i[n].split(/=(.+)?/gi,2);if(2==r.length&&"dast"==r[0])return r[1]}return""}}])&&ad(t.prototype,i),n&&ad(t,n),e}(),dd=cd;function ud(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hd=i(1999),pd=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.log=new s.Z({className:"StreamRail Player"}),this.streamRailId="streamrail-jssdk",this.options=t,this.model=this.options.model,this.isMultiAd=hd.parseBool(this.model.get("isMultiAd")),!document.getElementById(this.streamRailId)){var i=this.model.get("player.urls.wfRequest");if(this.waterfall=new dd({wfUrl:i,wfRetries:this.model.get("retriesLWF"),secondsBW:this.model.get("secondsLWF"),isFirePiggies:this.model.get("player.settings.fire_piggies"),ronPercent:this.model.get("ronPercent"),urlParams:{cirf:this.model.get("referrer"),height:this.options.height,originId:this.model.get("originId"),pubId:this.model.get("pubId"),tagId:this.model.get("pubTagId"),width:this.options.width,noaop:this.model.get("noaop"),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),crid:this.model.get("creativeId"),isViewable:this.model.get("isPlayerViewable")}}),this.model.has("demandConfig.waterfall")){var n=this.waterfall.handleWaterfallObject(this.model.get("demandConfig.waterfall"));this._handleWfResponce("preroll",n)}else this.waterfall.callWaterfall(this._handleWfResponce.bind(this,"preroll"),this._waterfallError.bind(this))}}var t,i,n;return t=e,i=[{key:"_waterfallError",value:function(){this.log.error("There was an error with the waterfall!"),hd.firePixel(this.model.getPixel("pixels.networkError"),"WF Network Error")}},{key:"_handleWfResponce",value:function(e,t){this.wf||(this.wf={}),this.wf.preroll=t,this._generateSRInit()}},{key:"_generateSRInit",value:function(){if(!this.wf.preroll||!this.wf.preroll.tags||hd.isEmpty(this.wf.preroll.tags))return this.log.warning("The waterfall is empty"),void this.waterfall.recallWF();if(this._srPlaylist=[],this.isMultiAd){var e=this.model.get("player.playlist");if(0==e.length)return void this.model.listenToOnce(this.model,"change:player.playlist",this._generateSRInit.bind(this));hd.each(e,this._SRPlaylistAdapter,this)}var t=this.model.get("player.urls.oppsRequest");this.oppManager=new Zn(t,{"auc-dast":this.model.get("cmDast"),pv:100,vpd:this.model.get("pubId"),vptd:this.model.get("pubTagId"),pt:hd.crc32(this.model.get("abTest")||999)}),hd.each(this.wf.preroll.tags,this._SRTagAdapter,this),window.srAsyncInit=this._srInit.bind(this),this._createSRPlayer()}},{key:"_SRPlaylistAdapter",value:function(e){var t=hd.extend({},e);t.id=e.filename,t.categories=this.model.get("category"),this._srPlaylist.push(t)}},{key:"_SRTagAdapter",value:function(e){var t={cirf:encodeURIComponent(this.model.get("cirf")),country:this.model.get("country"),domain:this.model.get("domain"),ip:this.model.get("ip"),playerHeight:Number(this.options.height),playerWidth:Number(this.options.width),referrer:encodeURIComponent(this.model.get("referrer")),vertical:this.model.get("vertical"),videoLength:"",description:"",title:"",videoUrl:"",pageUrl:this.model.get("referrer"),ua:"[DEV_UA]"};if(this._srPlaylist&&this._srPlaylist.length>0){var i=this._srPlaylist[0];t.videoLength=i.vidlength,t.videoUrl=encodeURIComponent(i.fullPath),t.description=i.title,t.title=i.title}if(e.macros&&(t=hd.extend(t,{ip:"[CLIENT_IP]",playerHeight:"[HEIGHT]",playerWidth:"[WIDTH]"})),e.url)e.url=this.waterfall.replaceMacros(e.url,t);else try{e.url=decodeURIComponent(e.vast)}catch(t){e.url=e.vast}e.adCancelTimeout=1e3*Number(this.model.get("defaultTagTimeout"))}},{key:"_srInit",value:function(){var e={partnerID:"fd925f23-e608-4807-9a9e-ebe550860bc3",ads:{schedule:[],skip:{enabled:!1,seconds:5,btnText:"Continue"}},adRequestThrottle:1e3*Number(this.model.get("secondsBW")),autoplay:hd.parseBool(this.model.get("autoPlay")),bgColor:"black",contentAutoplay:hd.parseBool(this.model.get("autoPlay")),height:this.options.height,hideContentBeforePreRoll:hd.parseBool(this.model.get("isShowOnAd")),loop:hd.parseBool(this.model.get("repeat")),muted:"on"!==this.model.get("volume"),mobileSpriteTimeout:1e3*this.model.get("mobileSpriteTimeoutSeconds"),scaleMode:"original",width:this.options.width};this.isMultiAd?(e.playlist=this._srPlaylist,e.breakingAds={enabled:!0,hideContentControls:!hd.parseBool(this.model.get("player.hasControls")),minTimeBetweenAds:1e3*Number(this.model.get("timeBetweenAds")),on:"AdImpression"},e.ads.schedule=[{position:"pre-roll",server:{tags:this.wf.preroll.tags}}]):e.ads.schedule=[{position:"pre-roll",server:{tags:this.wf.preroll.tags}}],this.log.info("SR Options",e),this.player=SR(this.options.targetId,e),this._bindEvents()}},{key:"_bindEvents",value:function(){this.player.on("AdVideoFirstQuartile",this._fireQuartileOpp.bind(this,"AdVideoFirstQuartile")),this.player.on("AdVideoMidpoint",this._fireQuartileOpp.bind(this,"AdVideoMidpoint")),this.player.on("AdVideoThirdQuartile",this._fireQuartileOpp.bind(this,"AdVideoThirdQuartile")),this.player.on("AdVideoComplete",this._fireQuartileOpp.bind(this,"AdVideoComplete")),this.player.on("AdImpression",this._onAdImpression.bind(this)),this.player.on("AdVideoComplete",this._onAdEnded.bind(this)),this.player.on("AdError",this._onAdError.bind(this)),this.player.on("AdRequest",this._onAdRequest.bind(this)),this.player.on("AdPaused",this._onAdPaused.bind(this)),this.player.on("AdPlaying",this._onAdPlaying.bind(this)),this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("firstplay",this._onFirstPlay.bind(this)),this.model.on("change:isPlayerViewable",this.changeViewability,this)}},{key:"_onAdClickThru",value:function(){hd.firePixel(this.model.getPixel("pixels.clickthrough"),"Click Through")}},{key:"_onAdRequest",value:function(e){this.log.debug("onAdRequest",e),e?(this._createActiveTag(e),this.activeTag.requestTime=Date.now(),this._fireOpp(this.oppManager.pixelType.tagStarted),!this.activeTag.tagTimeoutTimer&&this.activeTag.adCancelTimeout&&(this.activeTag.tagTimeoutTimer=window.setTimeout(this._onAdLoadTimeout.bind(this),this.activeTag.adCancelTimeout))):this.log.warning("onAdRequest Tag is undefined")}},{key:"_onAdLoadTimeout",value:function(){this.log.debug("onAdLoadTimeout"),this._fireOpp(this.oppManager.pixelType.tagTimeout),this.activeTag=null}},{key:"_onAdError",value:function(e){if(this.log.debug("onAdError",e),!this.activeTag){if(!e)return void this.log.warning("onAdError Tag is undefined");this.log.info("onAdError without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),this._fireOpp(this.oppManager.pixelType.tagError),this.options.onAdError(),this.activeTag=null}},{key:"_onAdImpression",value:function(e){if(this.log.debug("onAdImpression",e),!this.activeTag){if(!e)return void this.log.warning("onAdImpression Tag is undefined");this.log.info("onAdImpression without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),hd.firePixel(this.activeTag.pixel,"Tag Pixel"),this._fireOpp(this.oppManager.pixelType.tagImpression),this._resetViewabilityTimer(),this.options.onAdImpression()}},{key:"_stopViewabilityTimer",value:function(){this.viewabilityTimer&&(window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=null)}},{key:"_resetViewabilityTimer",value:function(){if(this._stopViewabilityTimer(),this.activeTag&&this.model.get("isPlayerViewable")&&!this.activeTag.isViewed){var e=this.model.get("traceViewabilitySeconds");this.viewabilityTimer=window.setTimeout(this._onViewability.bind(this),1e3*e)}}},{key:"_onViewability",value:function(){this.activeTag.isViewed=!0,this._fireOpp(this.oppManager.pixelType.viewability)}},{key:"_onAdPaused",value:function(){this.log.debug("onAdPaused"),this._stopViewabilityTimer()}},{key:"_onAdPlaying",value:function(){this.log.debug("onAdPlaying"),this.isPaused?this.pause():this._resetViewabilityTimer()}},{key:"_onAdEnded",value:function(){this.log.debug("onAdEnded"),this.options.onAdEnded(),this._stopViewabilityTimer(),this.activeTag=null}},{key:"_fireQuartileOpp",value:function(e,t){if(this.log.debug("on"+e,t),!this.activeTag){if(!t)return void this.log.warning("on"+e+" tag is undefined");this.log.info("Quartile "+e+" without active tag"),this._createActiveTag(t)}this._fireOpp(this.oppManager.pixelType[e])}},{key:"_onFirstPlay",value:function(){this.options.onFirstPlay&&this.options.onFirstPlay()}},{key:"_createActiveTag",value:function(e){if(!e)return this.activeTag=null,!1;var t=this._getRollType(e.analytics.adPosition),i=this._getTagById(e.analytics.adsourceid,t);return this.activeTag=i,this.activeTag.rollType=t,this.activeTag.tryId=Date.now(),!0}},{key:"_getRollType",value:function(e){return e.replace("-","")}},{key:"_getTagById",value:function(e,t){if(this.wf[t]){var i=hd.find(this.wf[t].tags,(function(t){return String(t.id)===e}));return hd.extend({},i)}}},{key:"_createSRPlayer",value:function(){var e=document.getElementById(this.options.targetId),t=document.createElement("script");t.id=this.streamRailId,this.model.get("srSrc")?t.src=this.model.get("srSrc"):hd.parseBool(this.model.get("srOldVersion"))?t.src="https://sdk.streamrail.com/test/player/89afe692a142c57fff97a01259e030e6c15e5cf6/sr.ads.js":t.src="https://sdk.streamrail.com/player/sr.ads.js",e.appendChild(t)}},{key:"_fireOpp",value:function(e){this.activeTag?this.oppManager.send({rs:1,st:r().ROLL_TYPE[this.activeTag.rollType],os:this.activeTag.seqNum,rst:e,d:Date.now()-this.activeTag.requestTime,dast:this.activeTag.dast,impid:this.activeTag.tryId,vmt:Number(this.activeTag.isRon)}):this.log.info("There is no active unit! Cannot fire opp.")}},{key:"pause",value:function(){this.player&&(this.isPaused=!0,this.player.pause())}},{key:"resume",value:function(){this.player&&(this.isPaused=!1,this.player.play())}},{key:"close",value:function(){this.player&&(this.player.off(),this.player.dispose(),this._fireOpp(this.oppManager.pixelType.playerClosed),this.activeTag=null)}},{key:"resize",value:function(e,t){if(this.player){var i=document.getElementById(this.options.targetId);(0,E.default)(i).css({width:e,height:t}),this.player._resize()}}},{key:"mute",value:function(){this.player.muted(!0)}},{key:"unMute",value:function(){this.player.muted(!1)}},{key:"changeViewability",value:function(e,t){t?this._resetViewabilityTimer():this._stopViewabilityTimer()}},{key:"setFdData",value:function(e){}}],i&&ud(t.prototype,i),n&&ud(t,n),e}(),fd=pd;function md(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var gd=i(1999),yd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.model=this.options.model||{},this.log=new s.Z({unitType:"PlayerAPI",className:"DPlayer",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.timers={},this.contentIndex=0,this.targetElem=(0,E.default)("#"+this.options.targetId.toString())[0],!this.model.get("vForce.isSupported")&&this.model.get("vForce.isActive")&&this.model.set("vForce.isActive",!1),this.isMuted="on"!==this.model.get("volume"),this.volume="off"!==this.model.get("volume")?40:0,this.dependencies=[];var i=t.model.get("player.urls.playerLocation");i&&(this.dependencies=[i+"/OvaMediaPlayer.js"]),this.oppManager=new Zn(this.model.get("player.urls.oppsRequest"),{"auc-dast":this.model.get("cmDast"),pt:gd.crc32(this.model.get("abTest")||999)}),this.model.get("canStartPlayer")?this._initPlayer():this.model.on("change:canStartPlayer",this._initPlayer.bind(this))}var t,i,n;return t=e,(i=[{key:"_initPlayer",value:function(){this._fireCMPpixel(),window.OvaMediaPlayer?this._setPlayer():gd.loadJsArr(this.dependencies,this._setPlayer.bind(this))}},{key:"_setPlayer",value:function(){if(this._validatePlayerSize()){if(this._setGeneralPlayingUnitState(!1),this.playlist=this.model.get("player.playlist"),this.playlist&&gd.isEmpty(this.playlist))return void this.model.listenToOnce(this.model,"change:player.playlist",this._setPlayer.bind(this));var e=this.playlist[this.contentIndex];this.player=new OvaMediaPlayer({abTest:this.model.get("abTest"),ad_controls:this.model.get("player.hasAdControls"),aspect_ratio:this.model.get("aspectRatio"),auc_dast:this.model.get("cmDast"),autostart:this.model.get("autoPlay"),base_url:this.model.get("urls.base"),bf_factor:this.model.get("player.bfFactor"),bug_feature:this.model.get("player.hasBFeature"),cfr:this.model.get("cfr"),cipid:this.model.get("cipid"),cirf:decodeURIComponent(this.model.get("referrer")),creativeId:this.model.get("creativeId"),controls:this.model.get("player.hasControls"),country:this.model.get("country"),debug:this.model.get("isDebug")?["*"]:[],default_ad_parameters:this.model.get("defaultAdParameters"),default_ad_timeout:this.model.get("adMaxPlaySeconds"),default_b2b:this.model.get("player.b2b"),fire99:this.model.get("player.isFire99"),ga_factor:this.model.get("gaFactor"),ga_frame_src:this.model.get("gaFrameSrc"),image:this.model.get("loaderImage"),interrupt_loading:this.model.get("interruptLoading"),ip:this.model.get("ip"),isViewable:this.model.get("isPlayerViewable"),keywords:this.model.get("adTitle"),min_vpaid_run_time:this.model.get("player.minVpaidRunTime"),no_debug_report:this.model.get("noDebugReport"),oid:this.model.get("originId"),opps_base_path:this.model.get("player.urls.oppsBasePath"),page_url:decodeURIComponent(this.model.get("referrer")),referrer:decodeURIComponent(this.model.get("referrer")),repeat:this.model.get("repeat"),ron_percent:this.model.get("ronPercent"),schedule_auto:this.model.get("timeBetweenAds"),tags:this.model.get("tags"),time_between_waterfall:this.model.get("secondsBW"),use_flash_bypass:this.model.get("player.isBypassFlash"),use_flash_player:this.model.get("player.isFlashPlayer"),version:this.model.get("adTitle"),vertical:this.model.get("vertical"),wf_base_path:this.model.get("player.urls.wfBasePath"),wf_url:this.model.get("player.urls.wfRequest"),opps_url:this.model.get("player.urls.oppsRequest"),height:""+parseInt(this.model.get("height")),width:""+parseInt(this.model.get("width")),dplayerSettings:this.model.get("player.settings"),loadrsrc:!0,preset:this.model.get("preset"),isDFP:this.model.get("iframeData.inDFP"),can_opt_out:!1,description:e.title,domain:window.location.hostname,mute:this.isMuted,title:e.title,volume:this.volume,target_id:this.options.targetId.toString(),schedule:this.options.scheduleArr,dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),isMobile:this.model.get("isMobile"),queue_size:this.model.get("player.settings.queueSize"),max_ready_vpaid:this.model.get("player.settings.maxReadyVpaid"),adto:this.model.get("player.settings.adto"),vakll:this.model.get("player.settings.vakll"),mintimwf:this.model.get("player.settings.mintimwf"),agressiveLevel:this.model.get("preset.level"),mPre:this.model.get("mPre"),red_id:this.model.get("redId"),vimpFireEvent:this.model.get("vimpFireEvent"),vForce:this.model.get("vForce.isActive"),get_ad_timeout_seconds:this.model.get("vForce.getAdTimeoutSeconds"),wf_manual:this.model.get("wfManual"),wf_dynmc_ps:this.model.get("wfDynamicPause"),run_wf_when_empty:this.model.get("runWfWhenEmpty"),rndmt:this.model.get("rndmt"),unit_name:this.model.get("unitName"),unit_loader_version:this.model.get("version"),unit_main_version:this.model.get("unitVersion"),mprdct:this.model.get("player.settings.mprdct"),gdprApplies:this.model.get("gdprApplies"),cdb:this.model.get("consentDaisyBit"),pixelsUrl:this.model.get("pixels.url"),files:[e],onPlayerClose:this._onPlayerClose.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerStop:this._onPlayerStop.bind(this)}),this.playerQueueSeeker=new co(this.model),this.playerQueueSeeker.registerToPlayerQueueStatusChange({instance:this,type:void 0,typeValue:void 0,status:"startAd",cb:this.isFirstAdLoaded.bind(this),isListenOnce:!0}),this.player.on("queueStatus",this.playerQueueSeeker.updateAdsList.bind(this.playerQueueSeeker)),zn().player=this.player,this.model.get("supportTool")||this.model.get("supportTool.isOpen")||this.model.set("supportTool",{isOpen:!1}),this.model.listenTo(this.model,"change:supportTool.isOpen",this._supportToolStateChange.bind(this)),this._alignPlayer(),this._registerListeners()}}},{key:"_validatePlayerSize",value:function(){var e=this.model.get("width"),t=this.model.get("height"),i=!0;return gd.isWidthValid(e)?gd.isHeightValid(t)||(t=this.model.get("dimensions.minHeight")||gd.getVideoHeight(e),this.model.set("height",t),this.model.set("playerHeightLost",!0)):(i=!1,this.model.set("playerWidthLost",!0)),i}},{key:"_onAdImpression",value:function(e){if(e.hadImpression){this.activeVpaidWrapper=e,this.model.get("components.Repeat.isActive")&&this.activeVpaidWrapper.dontDie&&this.activeVpaidWrapper.dontDie(),this.hasImpression=!0,this._stopTimer("midrollCollapse");var t={lineItemId:this.model.get("lineItemId"),placement:this.model.get("placement"),redId:this.model.get("redId")};this.hadImpression||(k().trigger("filledImpression",t),this.hadImpression=!0),this.model.get("isSendCPM")&&(t.cpm=e.tag.vpaidWrapperData&&e.tag.vpaidWrapperData.vastPrice?e.tag.vpaidWrapperData.vastPrice:e.tag.price),k().trigger("onImpression",t),this.log.debug("onAdImpression",e),window.clearTimeout(this._playerTimeout||0),e.isBf||(this.activeTag=gd.filterObject(e.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),this._updateLastActiveTag(),this._resetViewabilityTimer()),this.options.onAdImpression(e.tag)}}},{key:"_onStop",value:function(e){e&&e.hadImpression&&!e.isBf&&(this.log.debug("onStop",e),this.hasImpression&&(this.hasImpression=!1,this.options.onAdStopped()),this.activeTag&&this.options.onAdStopped(),this.activeTag=null,this._stopTimer("viewability"),this._resetMidrollCollapseTimer(),this._setAdPlayingWithAdChoice(!1))}},{key:"_onVideoComplete",value:function(){this.options.onAdVideoComplete&&this.options.onAdVideoComplete(),this._setAdPlayingWithAdChoice(!1)}},{key:"_onPlayerReady",value:function(){this.log.info("onPlayerReady"),this._initCloseTimers(),this.options.onPlayerReady()}},{key:"_onPlayerStop",value:function(){this.options.onPlayerStop&&this.options.onPlayerStop(),this._stopTimer("viewability")}},{key:"_onPlayerError",value:function(){this.options.onPlayerError&&this.options.onPlayerError(),this._stopTimer("viewability")}},{key:"_initCloseTimers",value:function(){var e=this.model.get("secondsToClose");e&&!this._playerTimeout&&(this.log.info("set secondsToClose",e),this._playerTimeout=window.setTimeout(this._onPlayerTimeout.bind(this),1e3*e));var t=this.model.get("secondsToCloseGlobal");t&&(this._secondsToCloseGlobalTimeout=window.setTimeout(this._onPlayerClose.bind(this),1e3*t));var i=this.model.get("playerEndSeconds");i&&(this._playerEndSecondsTimeout=window.setTimeout(this._onPlayerEndSeconds.bind(this),1e3*i)),this.model.get("secondsToPassback")&&(this.passBackTimer=window.setTimeout(this._triggerPassback.bind(this,"passback timer"),1e3*this.model.get("secondsToPassback")))}},{key:"_supportToolStateChange",value:function(e,t){t?(this.pause(),zn().supportTool=zn().supportTool||{},zn().supportTool.dp=this.activeTag?this.activeTag.dp:void 0,this._stopTimer("midrollCollapse"),window.clearTimeout(this._playerTimeout),window.clearTimeout(this._secondsToCloseGlobalTimeout),window.clearTimeout(this._playerEndSecondsTimeout)):(zn().supportTool.dp=void 0,this._initCloseTimers(),this._resetMidrollCollapseTimer(),this.resume())}},{key:"_resetViewabilityTimer",value:function(){if(this._stopTimer("viewability"),this.activeTag&&this.model.get("isPlayerViewable")&&!this.activeTag.isViewed){var e=this.model.get("traceViewabilitySeconds");this.timers.viewability=window.setTimeout(this._onViewability.bind(this),1e3*e)}}},{key:"_resetMidrollCollapseTimer",value:function(){if(this._stopTimer("midrollCollapse"),this.model.get("midrollCollapse.isActive")&&!this.activeTag&&this.model.get("isUnitViewable")){var e=this.model.get("midrollCollapse.time");this.timers.midrollCollapse=window.setTimeout(this._onPlayerClose.bind(this),1e3*e)}}},{key:"_stopTimer",value:function(e){window.clearTimeout(this.timers[e]),this.timers[e]=null}},{key:"_onViewability",value:function(){this.activeTag.isViewed=!0,this.log.info("Fire viewability opps",this.activeTag),this.oppManager.send(this._getOppParams(30)),this.model.get("isViewavility100Slider")&&this.oppManager.send(this._getOppParams(63))}},{key:"_onPlayerEndSeconds",value:function(){k().trigger("player:end")}},{key:"_onPlayerTimeout",value:function(){this.log.info("onPlayerTimeout"),this.player._pausePlayer(),gd.firePixel(this.model.getPixel("pixels.timeout"),"Player got no impressions")}},{key:"_onPlayerClose",value:function(){this._onStop(),this._setGeneralPlayingUnitState(!1),this.options.onPlayerClose&&this.options.onPlayerClose(),this._stopTimer("viewability")}},{key:"_onInView",value:function(){this._resetViewabilityTimer(),this._resetMidrollCollapseTimer()}},{key:"_onOutOfView",value:function(){this._stopTimer("viewability"),this._stopTimer("midrollCollapse")}},{key:"_setGeneralPlayingUnitState",value:function(e){this.model.set("generalPlayingUnitState",null),this.model.set("generalPlayingUnitState",e)}},{key:"_adPaused",value:function(e){this._setGeneralPlayingUnitState(!1),this.model.get("supportTool.isOpen")&&e.dontDie()}},{key:"_adPlaying",value:function(e){this._setGeneralPlayingUnitState(!0)}},{key:"_registerListeners",value:function(){this.player.on&&(this.player.on("AdVideoComplete",this._onStop.bind(this)),this.player.on("AdVideoComplete",this._onVideoComplete.bind(this)),this.player.on("AdStopped",this._onStop.bind(this)),this.player.on("AdVideoEnd",this._onStop.bind(this)),this.player.on("AdImpression",this._onAdImpression.bind(this)),this.player.on("AdPaused",this._adPaused.bind(this)),this.player.on("AdPlaying",this._adPlaying.bind(this)),this.player.on("AdError",this.options.onAdError),this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("contentChanged",this._onContentChanged.bind(this)),this.player.on("UserInteractionPauseState",this._onPausedChanged.bind(this)),this.player.on("emptyFirstWaterfall",this._triggerPassback.bind(this,"empty first waterfall"))),this.model.on("change:state",this._onPlaying.bind(this)),this.model.on("change:isPlayerViewable",this.changeViewability,this)}},{key:"_onPlaying",value:function(e,t){e.STATE.PLAYING==t&&(this._updateAdChoiceVisibility(),this._setGeneralPlayingUnitState(!0))}},{key:"_onPausedChanged",value:function(e){this._setGeneralPlayingUnitState(!e)}},{key:"_onContentChanged",value:function(){this.log.important("OnContentChanged, current content:",this.playlist[this.contentIndex]),!this.model.get("repeat")&&this.model.get("isPlaylist")&&(this.contentIndex++,this.playlist.length<=this.contentIndex&&(this.contentIndex=0),this.playVideo({fileData:this.playlist[this.contentIndex],imageUrl:this.model.get("loaderImage"),autoplay:this.model.get("autoPlay")})),(this.model.get("repeat")||this.model.get("isPlaylist"))&&k().trigger("change:player:content",this.playlist[this.contentIndex])}},{key:"_onAdClickThru",value:function(){this.lastActiveTag.sequenceId===this.activeTag.sequenceId&&this.lastActiveTag.clickCounter>1||this.oppManager.send(this._getOppParams(33)),this.lastActiveTag.clickCounter++}},{key:"_getOppParams",value:function(e){var t=gd.extend({},this._getBaseOppParams());return t.rst=e,t}},{key:"_getBaseOppParams",value:function(){return{rs:this.activeTag.sequenceId,st:r().ROLL_TYPE[this.activeTag.rollType],sts:this.player.repeatCount,os:Number(this.activeTag.waterfallTagId)+1,d:(new Date).getTime()-this.activeTag.created,dast:this.activeTag.dast,vpd:this.activeTag.pubId,vptd:this.activeTag.tagId,pv:this.player.get("player_version"),dp:gd.crc32(this.activeTag.dp),vmt:Number(this.activeTag.isRon)||0,abt:this.model.get("abTest"),agl:this.model.get("preset.level")?this.model.get("preset.level"):1}}},{key:"_setAdPlayingWithAdChoice",value:function(e){this.model.set("adPlayingWithAdChoice",e)}},{key:"_updateAdChoiceVisibility",value:function(){this.activeVpaidWrapper&&this.activeVpaidWrapper.hasAdChoices?this._setAdPlayingWithAdChoice(!0):this._setAdPlayingWithAdChoice(!1)}},{key:"_updateLastActiveTag",value:function(){this.lastActiveTag={},this.lastActiveTag.sequenceId=this.activeTag.sequenceId,this.lastActiveTag.clickCounter=1}},{key:"_fireCMPpixel",value:function(){this.model.get("hasCMPonPage")?gd.firePixel(this.model.getPixel("pixels.hasCMPonPage"),"GDPR - Has CMP on page"):gd.firePixel(this.model.getPixel("pixels.noCMPonPage"),"GDPR - No CMP on page")}},{key:"_alignPlayer",value:function(){if(this.player.store.get("dataSaver")){var e=this.model.get("playerTextAlign"),t=this.player.store.get("forcecnvsmpg");(e||t)&&this.targetElem&&(0,E.default)(this.targetElem).css({"text-align":"left"})}}},{key:"_triggerPassback",value:function(e){var t=this.model.get("isApiPassbackExist");!this.model.get("isFirstAdLoaded")&&t&&(this.log.info("Triggering passback due to "+e),k().trigger("global:passback",{isApiPassbackExist:t}),this.model.set("closeState",l().closeState.terminate),this.model.set("state",this.model.STATE.DONE))}},{key:"isFirstAdLoaded",value:function(){this.model.set("isFirstAdLoaded",!0)}},{key:"pause",value:function(){this.player&&(this.player.pause(),this._setGeneralPlayingUnitState(!1),this.player.ova.pauseAd(),this._stopTimer("viewability"))}},{key:"resume",value:function(){this.player&&(this.player.play(),this._setGeneralPlayingUnitState(!0),this.player.ova.resumeAd(),this._resetViewabilityTimer())}},{key:"close",value:function(){this.player&&(this._setGeneralPlayingUnitState(!1),this.player.closeCleanPlayer(),this.player=null)}},{key:"resize",value:function(e,t){this.player&&(this.player.resize(e,t),this.player.ova.resizeAd(e,t))}},{key:"playVideo",value:function(e){this.contentIndex=this.playlist.findIndex((function(t){return t.id===e.fileData.id})),this.player.setVideoFile([e.fileData],e.imageUrl,e.autoplay)}},{key:"mute",value:function(e){if(this.unMuteTimer)return clearTimeout(this.unMuteTimer),void(this.unMuteTimer=!1);this.isMuted&&!e||(this.isMuted=!0,this.player&&(this.volume=this.player.volume(),this.player.volume(0),this.player.mute(),this.player.ova.setAdVolume(0),this.player.ova.muteAd()))}},{key:"unMute",value:function(){this.unMuteTimer||!this.model.get("isThrottleUnMute")?(this.unMuteTimer=!1,this.isMuted&&(this.isMuted=!1,this.player&&(this.player.volume(this.volume),this.player.unMute(),this.player.ova.setAdVolume(this.volume),this.player.ova.unmuteAd()))):this.unMuteTimer=window.setTimeout(this.unMute.bind(this),100)}},{key:"changeViewability",value:function(e,t){this.player&&this.player.set&&(this.log.info("Player isViewable",t),this.player.set("isViewable",t)),t?this._onInView():this._onOutOfView()}},{key:"getCurrentContent",value:function(){return!!this.playlist&&this.playlist[this.contentIndex]}},{key:"setFdData",value:function(e){this.player&&this.player.set&&e&&this.player.set("fdScore",e)}},{key:"replay",value:function(){return this.activeVpaidWrapper&&"mp4"===this.activeVpaidWrapper.type&&(this.hasImpression=!0,this.activeVpaidWrapper.restartAd()),this.activeVpaidWrapper.type}},{key:"getAd",value:function(e){if(this.player&&this.player.getAd)return this.log.info("GetAd was called",e),this.player.getAd(e)}},{key:"setVolume",value:function(e){this.volume=e}}])&&md(t.prototype,i),n&&md(t,n),e}(),vd=yd;function bd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _d=i(1999),wd=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.log=new s.Z({className:"AniView Player"}),this.aniViewId="aniViewPlayer",this.viewport=_d.viewport,this.options=t,this.model=this.options.model,this.isMultiAd=_d.parseBool(this.model.get("isMultiAd")),!document.getElementById(this.aniViewId)){this.isFirst=!0;var i=this.model.get("player.urls.wfRequest");this.waterfall=new dd({wfUrl:i,wfRetries:this.model.get("retriesLWF"),secondsBW:this.model.get("secondsLWF"),isFirePiggies:this.model.get("player.settings.fire_piggies"),ronPercent:this.model.get("ronPercent"),urlParams:{cirf:this.model.get("referrer"),height:this.options.height,originId:this.model.get("originId"),pubId:this.model.get("pubId"),tagId:this.model.get("pubTagId"),width:this.options.width,noaop:this.model.get("noaop"),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),crid:this.model.get("creativeId"),isViewable:this.model.get("isPlayerViewable")}}),this._generateAVInit()}}var t,i,n;return t=e,i=[{key:"_generateAVInit",value:function(){if(this._avPlaylist=[],this.isMultiAd){var e=this.model.get("player.playlist");if(0==e.length)return void this.model.listenToOnce(this.model,"change:player.playlist",this._generateAVInit.bind(this));_d.each(e,this._generateAVPlaylist,this)}var t=this.model.get("player.urls.oppsRequest");this.oppManager=new Zn(t,{"auc-dast":this.model.get("cmDast"),pv:200,vpd:this.model.get("pubId"),vptd:this.model.get("pubTagId"),pt:_d.crc32(this.model.get("abTest")||999)});var i={publisherId:"57a0ab940757bb8c528b4587",channelId:"57a0abaf0757bb3d2b8b45a9",width:this.model.get("width"),height:this.model.get("height"),HD:!0,autoPlay:!0,ref1:this.model.get("referrer"),loop:!0,Preroll:1,midRollTime:this.model.get("timeBetweenAds"),soundButton:!0,pauseButton:!0,closeButton:!1,logo:!1,waterfall:this._waterfallFunc.bind(this),position:this.options.targetId,contentUrl:"",vastRetry:this.model.get("vastRetry"),timeout:this.model.get("defaultTagTimeout"),loopVideo:this.model.get("components.Repeat.isActive")};this._avPlaylist&&this._avPlaylist.length>0&&(i.contentUrl=this._avPlaylist[0].url),this.log.info("AniView config",i);var n="";n="https:"===window.location.protocol?"https://aniview.hs.llnwd.net/d1/script/5/aniview.js":"http://data1.ani-view.com/script/5/aniview.js",this._downloadPlayer(n,i)}},{key:"_waterfallFunc",value:function(e){if(this.model.has("demandConfig.waterfall")){var t=this.waterfall.handleWaterfallObject(this.model.get("demandConfig.waterfall"));this._handleWfResponce("preroll",e,t)}else this.waterfall.updateUrlParams({isViewable:this.model.get("isPlayerViewable")}),this.waterfall.callWaterfall(this._handleWfResponce.bind(this,"preroll",e),this._waterfallError.bind(this))}},{key:"_waterfallError",value:function(){this.log.error("There was an error with the waterfall!"),_d.firePixel(this.model.getPixel("pixels.networkError"),"WF Network Error")}},{key:"_handleWfResponce",value:function(e,t,i){if(_d.isEmpty(i.tags))return this.log.warning("The waterfall is empty"),void this.waterfall.recallWF();this.wf||(this.wf={}),this.wf.preroll=i,this.waterfall.handleWaterfallObject(this.wf.preroll),t(this._waterfallAdapter(this.wf),"c7N60dfV90")}},{key:"_waterfallAdapter",value:function(e){var t={data:{}};t.data.tags=[];var i=this;return _d.each(e.preroll.tags,(function(e){e.vpaidLog=_d.createVpaidLog({version:200,model:i.model},_d.extend({},e));var n={asid:e.id,priority:1,price:e.price};if(e.url)i._AVTagAdapter(e),n.type="vast",n.url=e.url;else{n.type="vastxml",n.url="http://";try{n.vastxml=decodeURIComponent(e.vast)}catch(t){n.vastxml=e.vast}}t.data.tags.push(n)})),this._createEventEnum(),t.data.onEvent=this._onEvent.bind(this),t}},{key:"_AVTagAdapter",value:function(e){var t={cirf:encodeURIComponent(this.model.get("cirf")),country:this.model.get("country"),domain:this.model.get("domain"),ip:this.model.get("ip"),playerHeight:Number(this.options.height),playerWidth:Number(this.options.width),referrer:encodeURIComponent(this.model.get("referrer")),vertical:this.model.get("vertical"),videoLength:"",description:"",title:"",videoUrl:"",pageUrl:this.model.get("referrer"),ua:""};if(this._avPlaylist&&this._avPlaylist.length>0){var i=this._avPlaylist[0];t.videoLength=i.vidlength,t.videoUrl=encodeURIComponent(i.fullPath),t.description=i.title,t.title=i.title}e.url=this.waterfall.replaceMacros(e.url,t),e.adCancelTimeout=1e3*Number(this.model.get("defaultTagTimeout"))}},{key:"_createEventEnum",value:function(){this.eventEnum={request:function(e){this._onAdRequest(e),this._pushEventToVpaidLog(e,"fetchVast")},bid:function(e,t){this._pushEventToVpaidLog(e,"event_adWonBid",{media:t.media,mediaType:t.type})},impression:function(e,t){this._onAdImpression(e),this._pushEventToVpaidLog(e,"event_AdImpression",{tabVis:!document.hidden,video:t.video})},firstQuartile:function(e){this._fireQuartileOpp("AdVideoFirstQuartile"),this._pushEventToVpaidLog(e,"event_AdVideoFirstQuartile",{tabVis:!document.hidden})},midPoint:function(e){this._fireQuartileOpp("AdVideoMidpoint"),this._pushEventToVpaidLog(e,"event_AdVideoMidpoint",{tabVis:!document.hidden})},thirdQuartile:function(e){this._fireQuartileOpp("AdVideoThirdQuartile"),this._pushEventToVpaidLog(e,"event_AdVideoThirdQuartile",{tabVis:!document.hidden})},complete:function(e){this._fireQuartileOpp("AdVideoComplete"),this._pushEventToVpaidLog(e,"event_AdVideoComplete",{tabVis:!document.hidden}),this._onAdEnded()},vpaidGeneralError:function(e,t,i){this._reportError(e,"vpaidGeneralError",i,t)},vpaidLoadError:function(e,t,i){this._reportError(e,"vpaidLoadError",i,t)},vpaidLoadTimeout:function(e,t,i){this._reportError(e,"vpaidLoadTimeout",i,t)},vpaidInitAdError:function(e,t,i){this._reportError(e,"vpaidInitAdError",i,t)},vpaidInitAdTimeout:function(e,t,i){this._reportError(e,"vpaidInitAdTimeout",i,t)},vpaidStartAdError:function(e,t,i){this._reportError(e,"vpaidStartAdError",i,t)},vpaidStartAdTimeout:function(e,t,i){this._reportError(e,"vpaidStartAdTimeout",i,t)},vpaidPlayError:function(e,t,i){this._reportError(e,"vpaidPlayError",i,t)},click:function(e,t,i){}}}},{key:"_onEvent",value:function(e,t,i){this.eventEnum[e]&&this.eventEnum[e].call(this,parseInt(t),i)}},{key:"_generateAVPlaylist",value:function(e){var t=_d.extend({},e);t.url=e.fullPath||e.url,t.id=e.filename,t.categories=this.model.get("category"),this._avPlaylist.push(t)}},{key:"_downloadPlayer",value:function(e,t){var i=document.createElement("script");i.src=e,i.onload=function(){this.player=new aniviewPlayer;var e=this;this.player.onPlay=function(t,i,n){e._preventPropagation(),e.isFirst&&e.options.onFirstPlay&&(e.isFirst=!1,e._onFirstPlay()),e._onAdPlaying()},this.player.onReady=function(t,i,n){e._pushEventToVpaidLog(n,"event_AdLoaded",{tabVis:!document.hidden})},this.player.onPause=function(){e._pushEventToVpaidLog(e.activeTag.id,"event_AdPaused"),e._onAdPaused()},this.player.onResume=function(){e._pushEventToVpaidLog(e.activeTag.id,"event_AdPlaying"),e._onAdPlaying()},this.player.onClick=function(){_d.firePixel(this.model.getPixel("pixels.clickthrough"),"Click Through")},this.player.play(t),this.model.on("change:isPlayerViewable",this.changeViewability,this)}.bind(this),document.getElementsByTagName("head")[0].appendChild(i)}},{key:"_fireOpp",value:function(e){this.activeTag?this.oppManager.send({rs:this.activeTag.id,st:r().ROLL_TYPE[this.activeTag.rollType],os:this.activeTag.seqNum,rst:e,d:Date.now()-this.activeTag.requestTime,dast:this.activeTag.dast,impid:this.activeTag.tryId,vmt:Number(this.activeTag.isRon)}):this.log.info("There is no active unit! Cannot fire opp.")}},{key:"_fireQuartileOpp",value:function(e,t){if(this.log.debug("on"+e,t),!this.activeTag){if(!t)return void this.log.warning("on"+e+" tag is undefined");this.log.info("Quartile "+e+" without active tag"),this._createActiveTag(t)}this._fireOpp(this.oppManager.pixelType[e])}},{key:"_createActiveTag",value:function(e){if(!e)return this.activeTag=null,!1;var t=this._getTagById(e);return this.activeTag=t,this.activeTag.tryId=Date.now(),!0}},{key:"_getTagById",value:function(e){var t=_d.find(this.wf.preroll.tags,(function(t){return t.id===e}));return _d.extend({},t)}},{key:"_onAdImpression",value:function(e){if(this.log.debug("onAdImpression",e),!this.activeTag){if(!e)return void this.log.warning("onAdImpression Tag is undefined");this.log.info("onAdImpression without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),_d.firePixel(this.activeTag.pixel,"Tag Pixel"),this._fireOpp(this.oppManager.pixelType.tagImpression),this._resetViewabilityTimer(),this.options.onAdImpression()}},{key:"pause",value:function(){this.player&&(this.isPaused=!0,this.player.pause())}},{key:"resume",value:function(){this.player&&(this.isPaused=!1,this.player.resume())}},{key:"close",value:function(){this.player&&(this.playerClosed=!0,this.player.contentReadyToPlay=!1,this.player.close(),this._fireOpp(this.oppManager.pixelType.playerClosed),this._closeAllVpaids(),this.activeTag=null)}},{key:"resize",value:function(e,t){if(this.player){var i=(0,E.default)("#"+this.options.targetId);i.width(e),i.height(t);var n=-(e-32),r=(0,E.default)("#videoContent"),o=(0,E.default)("#videoAd"),s=(0,E.default)("#playerDiv");s.width(e),s.height(t),o.width(e),o.height(t),r.width(e),r.height(t),i.find("#aniVideoCanvas").width(e),i.find("#aniVideoCanvas").height(t),(0,E.default)("#bottomPlayer").width(e),(0,E.default)("#soundButton").css({right:n})}}},{key:"mute",value:function(){this.player.mute()}},{key:"unMute",value:function(){this.player.unmute()}},{key:"setFdData",value:function(e){}},{key:"_onAdRequest",value:function(e){this.log.debug("onAdRequest",e),e?(this._createActiveTag(e),this.activeTag.requestTime=Date.now(),this._fireOpp(this.oppManager.pixelType.tagStarted),!this.activeTag.tagTimeoutTimer&&this.activeTag.adCancelTimeout&&(this.activeTag.tagTimeoutTimer=window.setTimeout(this._onAdLoadTimeout.bind(this),this.activeTag.adCancelTimeout))):this.log.warning("onAdRequest Tag is undefined")}},{key:"_onAdLoadTimeout",value:function(){this.log.debug("onAdLoadTimeout"),this._fireOpp(this.oppManager.pixelType.tagTimeout),this.activeTag=null}},{key:"_onAdPaused",value:function(){this.log.debug("onAdPaused"),this._stopViewabilityTimer()}},{key:"_onAdPlaying",value:function(){this.log.debug("onAdPlaying"),this._resetViewabilityTimer()}},{key:"_onAdEnded",value:function(){this.log.debug("onAdEnded"),this.options.onAdEnded(),this._stopViewabilityTimer(),this._closeAllVpaids(),this.activeTag=null}},{key:"_onFirstPlay",value:function(){this.options.onFirstPlay&&this.options.onFirstPlay()}},{key:"changeViewability",value:function(e,t){t?this._resetViewabilityTimer():this._stopViewabilityTimer()}},{key:"_stopViewabilityTimer",value:function(){this.viewabilityTimer&&(window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=null)}},{key:"_resetViewabilityTimer",value:function(){if(this._stopViewabilityTimer(),this.activeTag&&this.model.get("isPlayerViewable")&&!this.activeTag.isViewed){var e=this.model.get("traceViewabilitySeconds");this.viewabilityTimer=window.setTimeout(this._onViewability.bind(this),1e3*e)}}},{key:"_onViewability",value:function(){this.activeTag.isViewed=!0,this._fireOpp(this.oppManager.pixelType.viewability)}},{key:"_onAdError",value:function(e){if(this.log.debug("onAdError",e),!this.activeTag){if(!e)return void this.log.warning("onAdError Tag is undefined");this.log.info("onAdError without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),this._fireOpp(this.oppManager.pixelType.tagError),this.options.onAdError(),this.activeTag=null}},{key:"_preventPropagation",value:function(){(0,E.default)(this.player.link).click((function(){return!1}))}},{key:"_closeAllVpaids",value:function(){var e=this;_d.each(this.wf.preroll.tags,(function(t){e._pushEventToVpaidLog(t.id,"adStopped"),t.vpaidLog.saveToDb()}))}},{key:"_reportError",value:function(e,t,i,n){var r={tabVis:!document.hidden};i&&(r.params=i),n&&(r.errorDetails=n),this._pushEventToVpaidLog(e,t,r);var o=this._getTagById(e);this._onAdError(o),o&&o.vpaidLog&&o.vpaidLog.saveToDb()}},{key:"_pushEventToVpaidLog",value:function(e,t,i){var n=this._getTagById(e);n&&n.vpaidLog&&n.vpaidLog.push(t,i)}}],i&&bd(t.prototype,i),n&&bd(t,n),e}(),Td=wd;function Pd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Sd=i(1740),Ad=function(){function e(t,i,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.removeAttribute("autoplay"),this.video=t,this.createCanvas(),this.store=o,this.modifyVideo(t),this.owner=i,this.shouldAutoPlay=n||!1,this.canvasCss=r||{},this.bypass=!1,this.clntRedirRslvWhiteList=this.store.get("mpgclrslv")||[],this.ready=!1,t.setAttribute("muted","")}var t,i,n;return t=e,i=[{key:"backToVideoTag",value:function(){var e=this;if(!this.bypass&&this.src){this.bypass=!0;var t=this.jsmpeg.currentTime,i=this.video.style,n=this.video.parentElement,r=parseInt(n.style.zIndex);this.jsmpeg.stop(),this.jsmpeg=void 0,this.newVid=n.appendChild(document.createElement("video")),this.newVid.className="mc-loud-video",this.newVid.setAttribute("playsinline",""),this.newVid.setAttribute("autoplay",""),this.newVid.style.height=i.height,this.newVid.style.width=i.width,this.newVid.style.top=i.top,this.newVid.style.left=i.left,this.newVid.style.zIndex=r+1,this.newVid.src=this.src,this.newVid.volume=.7,this.newVid.addEventListener("ended",(function(t){e.dispatch("ended")}),!1),this.newVid.currentTime=t,this.newVid.play().then((function(){e.newVid.currentTime=t,e.canvas.style.display="none",e.video.style.display="none"}))}}},{key:"mpegFinish",value:function(){this.dispatch("ended")}},{key:"onLoad",value:function(){var e=this;setTimeout((function(){e.ready=!0,e._play(),e.dispatch("canplay")}),0)}},{key:"createCanvas",value:function(){var e=this,t=document.createElement("canvas");t.className="mc-video",localStorage.mpgCanavs&&localStorage.mpgCanavs.showBorder&&(t.style.border="4px solid pink"),this.canvas=this.video.parentElement.appendChild(t),this.video.parentElement.className+=" mpegcnv",this.canvas.addEventListener("click",(function(t){e.dispatch("click",t)}))}},{key:"onResize",value:function(){this.jsmpeg&&this.canvas&&this.jsmpeg.fitInParent(this.canvas)}},{key:"hookProp",value:function(e,t,i,n){var r="alt_"+t;e.hasOwnProperty(r)||(e[r]="",Object.defineProperty(e,t,{get:function(){return i?i():this[r]},set:function(i){this[r]=i,n&&n(i)&&e.setAttribute(t,i)}}))}},{key:"hookMethod",value:function(e,t,i){this.hooks||(this.hooks=[]),this.hooks[t]=e[t];var n=this;e[t]=function(){var e={};if(i(arguments,e)){var r=n.hooks[t].apply(this,arguments);return e.res?e.res:r}}}},{key:"dispatch",value:function(e,t){var i=t||new Event(e);this.video.dispatchEvent(i)}},{key:"errHndlr",value:function(e){this.owner&&(this.owner.vpaidLog&&this.owner.vpaidLog.push("jsmpegError",e),this.owner._onPlayerError&&this.owner._onPlayerError(e))}},{key:"isUrlInRslvWhiteList",value:function(e){if(!this.clntRedirRslvWhiteList.length)return!0;for(var t=0;t<this.clntRedirRslvWhiteList.length;++t)if(e.indexOf(this.clntRedirRslvWhiteList[t])>-1)return!0;return!1}},{key:"resolveWhitelistRedir",value:function(e,t){if(this.isUrlInRslvWhiteList(e)){var i=new XMLHttpRequest;i.open("GET",e),i.onreadystatechange=function(){var i=this.responseURL||e;t&&(t(i),t=void 0,this.abort())},i.send()}else t(e)}},{key:"setSrc",value:function(e){if(e=e.trim()){var t=this.store.get("cnvsldrt"),i=parseInt(this.store.get("width")),n=parseInt(this.store.get("height")),r={loadeReadyRate:t,canvas:this.canvas,centerVertically:!0,autoplay:this.shouldAutoPlay,loop:this.video.getAttribute("loop"),pcy:n,pcx:i,onload:this.onLoad.bind(this),errHndlr:this.errHndlr.bind(this),onfinished:this.mpegFinish.bind(this),progressive:!0,canvasCss:this.canvasCss,seekable:!0};return this.jsmpeg=new Sd(e,r,this),!1}}},{key:"_play",value:function(){this.ready&&(this.jsmpeg.play(),this.dispatch("playing"),this.status="PLAYING",this._render())}},{key:"_pause",value:function(){this.status="PAUSED",this._render(),this.newVid?this.newVid.pause():this.jsmpeg&&this.jsmpeg.pause()}},{key:"modifyVideo",value:function(e){var t=this,i=this;e._vidSetAttr=e.setAttribute,e.setAttribute=function(i,n){return"src"===i?void t.setSrc(n):e._vidSetAttr(i,n)},this.hookMethod(e,"play",(function(){return i._play(),i.dispatch("playing"),!1})),this.hookMethod(e,"pause",(function(){return i._pause(),!0})),this.hookMethod(e,"stop",(function(){return i.jsmpeg.stop(),!0})),this.hookProp(e,"src",null,this.setSrc.bind(this)),this.hookProp(this.video,"volume",null,(function(e){return!0})),this.hookProp(e,"duration",(function(){var e=i.newVid||i.jsmpeg;return e?e.duration:0}),null),this.hookProp(e,"currentTime",(function(){var e=i.newVid||i.jsmpeg;return e?e.currentTime:0}),null)}},{key:"_render",value:function(){this.newVid||this.canvas}},{key:"hide",value:function(){this.canvas.style.display="none",this._render()}},{key:"show",value:function(){this.canvas.style.display="block",this._render()}},{key:"removeDomMember",value:function(e){e.parentNode.removeChild(e)}},{key:"destroy",value:function(){this.jsmpeg=void 0;var e=this._events;for(var t in e)this.removeAllListeners(t);this.removeDomMember(this.canvas),this.canvas=void 0}}],i&&Pd(t.prototype,i),n&&Pd(t,n),e}(),Ed=i(1999),Cd=k().View.extend({id:"_cm-css-reset",initialize:function(e){this.options=e,this.log=new s.Z({unitType:"PlayerAPI",className:"VideoView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.log.debug("Init"),this.container=e.container||(0,E.default)("#"+e.targetId),this.playlistIndex=0,this.render(),this.bindEvents(),this.addSource()},render:function(){this.video=document.createElement("video"),this.video.oncanplay=function(e){k().trigger("videoCanPlay",e)},this.video.height=this.model.get("height"),this.video.width=this.model.get("width"),this.model.get("autoPlay")&&this.video.setAttribute("autoplay",""),this.model.get("isRepeat")&&this.video.setAttribute("loop",""),(this.model.get("isMobile")||"on"!==this.model.get("volume"))&&(this.video.setAttribute("muted",""),this.video.muted="muted"),this.video.setAttribute("playsinline",""),this.video.volume="off"!==this.model.get("volume")?40:0,this.video.quartile=0,this.container.append(this.video)},addSource:function(){var e=this.model.get("player.playlist")[this.playlistIndex];if(this.model.get("isMobile")&&e.url.match(/\.mpe?g/)&&this.createCanvas(),this.canvas)this.video.setAttribute("src",e.url);else{var t=document.createElement("source");t.setAttribute("src",e.url),t.setAttribute("type",e.type),t.addEventListener("error",this._onPlayerError.bind(this,t,"sourceError")),this.video.appendChild(t),this.video.load()}},bindEvents:function(){this.video.addEventListener("canplay",this._onPlayerReady.bind(this)),this.video.addEventListener("timeupdate",this._onTimeUpdate.bind(this)),this.canvas||this.video.addEventListener("error",this._onPlayerError.bind(this,this.video,"videoError")),this.video.addEventListener("ended",this._onPlayerEnd.bind(this))},createCanvas:function(){this.canvas=new Ad(this.video,this,this.model.get("autoPlay"),{},this.model),this.video.style.display="none"},_onPlayerReady:function(){this.log.info("onPlayerReady"),this.options.onPlayerReady(),this.canvas&&(this.timeUpdateInterval=window.setInterval(this._onTimeUpdate.bind(this),500))},_onTimeUpdate:function(){if(0!=this.video.duration){var e=parseInt(this.video.currentTime);e==parseInt(this.video.duration/4)&&0==this.video.quartile?(this.video.quartile=1,Ed.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.quarterly1"),"First Quarterly"),k().trigger("quarterly",this.video.quartile)):e==parseInt(this.video.duration/2)&&1==this.video.quartile?(this.video.quartile=2,Ed.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.quarterly2"),"Midpoint"),k().trigger("quarterly",this.video.quartile)):e==parseInt(this.video.duration*(3/4))&&2==this.video.quartile?(this.video.quartile=3,Ed.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.quarterly3"),"Third Quarterly"),k().trigger("quarterly",this.video.quartile)):e==parseInt(this.video.duration)&&3==this.video.quartile&&(this.isCompleted=!0,Ed.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.complete"),"Complete"),k().trigger("complete"),this.video.quartile=0,this.log.debug("Complete"))}},_onPlayerError:function(e,t){this.log.error("Player encountered an error",arguments),k().trigger("error",e,t)},_onPlayerEnd:function(){this.model.get("isRepeat")||(this.log.debug("video ended"),this.options.onPlayerStop(),window.clearInterval(this.timeUpdateInterval))},pause:function(){this.log.debug("Pause"),this.video.pause()},resume:function(){this.log.debug("Resume"),this.video.play()},close:function(){this.log.debug("Close")},resize:function(e,t){var i=Ed.getVideoHeight(e);i<=t?t=i:e=Ed.getVideoWidth(t),this.video.width=e,this.video.height=t,this.canvas&&this.canvas.onResize()},playVideo:function(e){},mute:function(e){},unMute:function(){},getCurrentContent:function(){return this.model.get("player.playlist")[this.playlistIndex]},setFdData:function(e){},replay:function(){}}),kd=i(9288),Od=i(1999),Dd=(i(9652),kd.View.extend({videoAdId:Od.now().toString().trim(),_initVjs:function(){if(Od.parseBool(this.model.get("isMobile")))switch(this.model.get("mobilePlayer")){case"AV":this._initAV();break;case"DP":this._initDP();break;default:this._initSR()}else this._initDP()},_initSR:function(){this.player=new fd({model:this.model,isInstream:!1,targetId:this.videoAdId,width:this.model.get("width"),height:this.model.get("height"),onAdImpression:this._onAdImpression.bind(this),onAdEnded:this._onAdStopped.bind(this),onAdError:this._onAdError.bind(this)})},_initAV:function(){this.player=new Td({model:this.model,isViewable:1,isInstream:!0,targetId:this.videoAdId,width:this.model.get("width"),height:this.model.get("height"),onAdImpression:this._onAdImpression.bind(this),onAdError:this._onAdError.bind(this),onAdEnded:this._onAdStopped.bind(this)})},_initDP:function(){var e=function(){},t=this._onAdVideoComplete||e,i=this._onPlayerClose||e;this.player=new vd({model:this.model,isViewable:1,targetId:this.videoAdId,onAdImpression:this._onAdImpression.bind(this),onAdStopped:this._onAdStopped.bind(this),onAdError:this._onAdError.bind(this),onAdVideoComplete:t.bind(this),onPlayerClose:i.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerError:this._onPlayerError.bind(this),scheduleArr:this.model.getScheduleArr()})}})),Id=i(1999),Rd=Dd.extend({className:"_cm-video-ad",events:{},initialize:function(e){this.log=new s.Z({unitType:"InStreamView",className:"InStreamView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this._skipConvertionPixel=e.skipConvertion,this.model.set("isPlayerViewable",!1),this._isSkipViewabilityCheck=e.isSkipViewabilityCheck,this._errorCount=0,this._videoAdId=this.videoAdId,this._waterfallRetries=Number(this.model.get("waterfallRetries")),isNaN(this._waterfallRetries)&&(this._waterfallRetries=0),"onHover"===this.model.get("volume")&&(this.events.mouseenter="unmute",this.events.mouseleave="_onMouseOver"),this._bindEvents(),this.render(),this._setComponents()},render:function(){this.$el.css({height:this.model.get("height"),width:this.model.get("width")}),this.el.id=this._videoAdId,(0,E.default)(this.container).append(this.$el),this._isSkipViewabilityCheck?this.model.set("isPlayerViewable",!0):this._setViewabilityListeners(),this._initVjs()},_bindEvents:function(){this.windowEventManager=el(),this.listenTo(this.model,"change:state",this._onStateChange),this.listenTo(k(),"window:tab:change",this._onTabEvent),this.listenTo(k(),"player:end",this.pause),this.listenTo(k(),"cm:fd:data",this._onFdData),this.model.get("contentClickUrl")&&(this.events.click="_onContentClick")},_onTabEvent:function(e){e===r().TAB_STATE.tabOut&&this.mute()},_onStateChange:function(e,t){if(t===e.STATE.PLAYING)this._onPlaying()},_onPlaying:function(){this.isPlaying||(this.isPlaying=!0,this.log.info("playing"))},_closePlayer:function(){this.player&&this.player.close()},_initVjs:function(){if("direct"===this.model.get("playerType"))this._initDirect();else if(this.model.get("isMobile"))switch(this.model.get("mobilePlayer")){case"AV":this._initAV();break;case"DP":this._initDP();break;default:this._initSR()}else this._initDP()},_initSR:function(){this.player=new fd({model:this.model,isViewable:Number(this.isViewable),targetId:this.el.id,width:this.model.get("width"),height:this.model.get("height"),onAdImpression:this._onAdImpression.bind(this),onAdError:this._onAdError.bind(this),onAdEnded:this._onAdStopped.bind(this),onFirstPlay:this._onPlayerReady.bind(this)})},_initAV:function(){this.player=new Td({model:this.model,isViewable:Number(this.isViewable),targetId:this.el.id,width:this.model.get("width"),height:this.model.get("height"),onAdImpression:this._onAdImpression.bind(this),onAdError:this._onAdError.bind(this),onAdEnded:this._onAdStopped.bind(this),onFirstPlay:this._onPlayerReady.bind(this)})},_initDP:function(){this.player=new vd({model:this.model,targetId:this.el.id,onAdStopped:this._onAdStopped.bind(this),onAdImpression:this._onAdImpressionCM.bind(this),onAdError:this._onAdError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerStop:this._onPlayerStop.bind(this),onPlayerClose:this._onPlayerClose.bind(this),scheduleArr:this.model.getScheduleArr()})},_initDirect:function(){this.player=new Cd({model:this.model,container:this.el,targetId:this.el.id,onAdStopped:this._onAdStopped.bind(this),onAdImpression:this._onAdImpressionCM.bind(this),onAdError:this._onAdError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerStop:this._onPlayerStop.bind(this),onPlayerClose:this._onPlayerClose.bind(this),scheduleArr:this.model.getScheduleArr()})},_onAdStopped:function(){this.model.set("tagCpmFloor",void 0),this.clickThroughView&&this.clickThroughView.show(),this.model.set("state",this.model.STATE.AD_STOPPED)},_onAdImpressionCM:function(e){this.model.set("tagCpmFloor",e.cpmFloor),this._onAdImpression()},_onAdImpression:function(){this._hasImpression=!0,this.log.info("onAdImpression (got ad)"),this._skipConvertionPixel||Id.firePixel(this.model.getPixel("pixels.conversion"),"Conversion"),this.is99Fired||(Id.firePixel(this.model.getImpressionPixel(),"First Convertion 99"),this.is99Fired=!0),this.clickThroughView&&this.clickThroughView.hide(),this.model.set("state",this.model.STATE.GOT_AD)},_onAdError:function(){this.log.error("onAdError"),this._errorCount++,this._waterfallRetries&&!this._hasImpression&&this._errorCount>=this._waterfallRetries&&(this.log.info("number of errors reached the allowed waterfall retries - stopping the unit",this._waterfallRetries),this.model.set("state",this.model.STATE.DONE))},_onPlayerReady:function(){this.log.info("onVjsReady"),this.updateClickThrough(),this.contentCallback(),this.model.set("state",this.model.STATE.PLAYER_READY)},_onPlayerError:function(){this.log.error("onPlayerError"),k().trigger("player:error")},_onPlayerStop:function(){this.model.set("state",this.model.STATE.PLAYER_STOP)},_onPlayerClose:function(){this.model.set("state",this.model.STATE.PLAYER_CLOSE)},playVideo:function(e){this.player.playVideo(e)},resizePlayer:function(e,t){this.$el.css({height:this.model.get("height"),width:this.model.get("width")}),this.player.resize(e,t)},close:function(){this.$el.hide(),this._closePlayer()},_setComponents:function(){this.model.get("components.CloseButtonView.hasCloseButton")&&(this.closeButtonView=new _l({model:this.model,container:this.el})),this.model.get("components.OptOut.hasOptOut")&&(this.optOutView=new Bl({model:this.model,container:this.el})),this.model.get("components.BrandLogo.hasBrandLogo")&&(this.brandLogoView=new hl({model:this.model,container:this.el})),this.model.get("components.ClickThrough.isActive")&&(this.clickThroughView=new pl({model:this.model,container:this.el})),this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.videoAd.isActive")&&(this.adChoice=new Jl({model:this.model,container:this.el,type:r().AD_CHOICE_TYPE.VIDEO_AD}))},_removeComponents:function(){this.closeButtonView&&this.closeButtonView.hide(),this.optOutView&&this.optOutView.hide()},_onMouseOver:function(e){this.mute()},_onFdData:function(e){this.player.setFdData(e)},mute:function(e){this.player&&this.player.mute(e)},unmute:function(){this.player&&this.player.unMute()},pause:function(){this.player&&this.player.pause()},resume:function(){this.player&&this.player.resume()},_setViewabilityListeners:function(){this.listenTo(k(),"window:tab:change",this.checkViewability.bind(this,!0)),this.listenTo(k(),"window:scroll:change",this.checkViewability.bind(this,!1)),this.checkViewability(!1)},checkViewability:function(e,t){this.model.get("isPlayerViewable");if(e&&t===r().TAB_STATE.tabOut)this.model.set("isPlayerViewable",!1);else{var i=this.model.get("width"),n=this.model.get("height"),o=this.el;Id.isInFriendlyIframe(cmTag.config.iframeData)&&(o=cmTag.config.iframeData.iframe),this.model.set("isPlayerViewable",Id.isViewable(o,i,n,50))}},updateClickThrough:function(){var e=this.player.getCurrentContent();e.link&&this.clickThroughView&&this.clickThroughView.updateLink(e.link)},contentCallback:function(){var e=this.player.getCurrentContent(),t=this.model.get("contentCallback");Id.isFunction(t)&&t(e)},_onContentClick:function(){window.open(this.model.get("contentClickUrl"),"_blank")}}),xd=i(1999),Bd=k().View.extend({className:"_cm-custom",id:"_cm-css-reset",initialize:function(){this.log=new s.Z({unitType:"Custom",className:"CustomView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.appendType=r().APPEND_TYPE[this.model.get("appendType")],this.isAfter=!1,this._isInFriendlyIframe()&&(this.model.get("stayInIframe")?!xd.parseBool(this.model.get("isProtectedInIframe"))||cmTag.config.iframeData.iframe.width&&cmTag.config.iframeData.iframe.height||this.model.set("isShowOnAd",!1):this._hideIframe=!0),this._expandedElements=[],this._referrer=this.model.get("referrer"),this.container=(0,E.default)(this.model.get("playerContainer")),this.isContainerSize=!1,this.isPlayTriggered=!1,this.render(),this._setComponents(),this._bindEvents(),this._checkViewability()},_bindEvents:function(){this.wem=el(),this.listenTo(k(),"click",this._onOuterClick),this.listenTo(k(),"play",this._onPlayEvent),this.listenToOnce(k(),"videoCanPlay",this._onVideoCanPlay),this.listenTo(this.model,"change:state",this._onStateChange),this.listenTo(k(),"change:player:content",this._onContentChanged),this.listenTo(k(),"window:scroll:change",this._checkViewability),this.listenTo(this.model,"change:isUnitViewable",this._onUnitViewabilityChange),this.listenTo(this.model,"change:isUnitEligible",this._onUnitEligibleChange),this.listenTo(this.model,"change:multiUnitManager.state",this._onMultiUnitManagerStateChange.bind(this)),this.model.get("isResponsive")&&(this.listenTo(k(),"window:orientation:change",this._onWindowSizeChnage),this.listenTo(k(),"window:resize:change",this._onWindowSizeChnage)),this.model.get("isPlayOnHover")&&this.$el.on("mouseenter",this._onUnitHover.bind(this)),this.listenTo(k(),"error",this._onError)},render:function(){switch(this.log.info("start",this.container),this._template='<div class="_cm-ad-title">Advertisement</div> <div class="_cm-custom-video"> </div>',this.$el.append(this._template),this._setModelSize(),this.$adTitle=this.$el.find("._cm-ad-title"),this.model.get("withAdvertisementText")||this.$adTitle.hide(),this.appendType){case r().APPEND_TYPE.afterbegin:this.container.prepend(this.$el);break;case r().APPEND_TYPE.beforeend:this.container.append(this.$el);break;case r().APPEND_TYPE.afterend:this.$el.insertAfter(this.container)}this.$playerContainer=this.$el.find("._cm-custom-video"),0==this.model.get("width")&&0==this.model.get("height")?(this.isContainerSize=!0,this.model.set({width:this.$playerContainer.width(),height:this.container.height()})):this.$playerContainer.css({width:this.model.get("width"),height:this.model.get("height")}),this.player=new Rd({model:this.model,container:this.$playerContainer[0]}),this._hideIframe&&(cmTag.config.iframeData.iframe.style.display="none"),this._customize(),xd.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.render"),"Render"),k().trigger("render"),this.log.debug("Render"),this._bindClickEvent()},_onOuterClick:function(){xd.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.clickthrough"),"Click")},_onPlayEvent:function(e){"Other units are stopped"!=e&&xd.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.conversion"),"Play")},_onError:function(e,t){if(0==parseInt(Math.random()*this.model.get("gaFactor"))){var i={pageUrl:window.location.href,isMobile:this.model.get("isMobile"),redId:this.model.get("redId"),error:t,ua:window.navigator.userAgent,referer:document.referrer,isRepeat:this.model.get("isRepeat"),videoUrl:this.model.get("player.urls.contentLocation")||this.model.get("pVideoUrl"),posterUrl:this.model.get("components.PosterView.imageLocation")};this.log.ul("pVideoError",i,"p_video_errors")}xd.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.error"),"Error"),this.model.set("viewPercent",101),window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=void 0,this.$el.off("mouseenter"),this._pausePlayer(),this._showPoster()},_onMultiUnitManagerStateChange:function(e,t){if(!e.get("multiUnitManager.isActive"))return!1;switch(t){case"pause":this.onPauseByMultiUnitManager();break;case"play":this.onPlayByMultiUnitManager()}},onPauseByMultiUnitManager:function(){this._pausePlayer(),this._showPoster(),k().trigger("stop","Other units are playing"),xd.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.stopUnit"),"Stop")},onPlayByMultiUnitManager:function(){k().trigger("play","Other units are stopped"),this._resumePlayer(),this._hideBanner()},_isAllowToPlayByMultiUnitManager:function(){return!this.model.get("multiUnitManager.isActive")||(this.model.get("multiUnitManager.isActive")&&!("pause"===this.model.get("multiUnitManager.state"))||!this.model.get("multiUnitManager.isActive"))},_pausePlayer:function(){this.player&&(this._setGeneralPlayingUnitState(!1),this.player.pause())},_setGeneralPlayingUnitState:function(e){this.model.get("generalPlayingUnitState")!==e&&(this.model.set("generalPlayingUnitState",null),this.model.set("generalPlayingUnitState",e))},_resumePlayer:function(){this.player&&this._isAllowToPlayByMultiUnitManager()&&(this._setGeneralPlayingUnitState(!0),this.player.resume())},_onUnitHover:function(){this.viewabilityTimer&&(window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=void 0),this.isplayTriggered||(k().trigger("play","Unit hover."),this.isplayTriggered=!0),this.model.set("isUnitEligible",!0,"Unit hover")},_customize:function(){var e=this.model.get("customization.unitContainer"),t=this.model.get("customization.placeHolder"),i=this.model.get("customization.adTitle");this.$el.css(e),this.$playerContainer.css(t),this.$adTitle.css(i)},_onStateChange:function(e,t){switch(t){case e.STATE.PLAYER_READY:this.model.set("state",this.model.STATE.PLAYING);break;case e.STATE.PLAYING:this._onPlaying();break;case e.STATE.PLAYER_STOP:this._onPlayerStop();break;case e.STATE.STOPPED_BY_USER:case e.STATE.DONE:case e.STATE.PLAYER_CLOSE:this.player.close(),this._collapse(!1);break;case e.STATE.OPT_OUT:this.player.close(),this._collapse(!0)}},_onPlayerStop:function(){this._showPoster()},_onPlaying:function(){this.model.get("isUnitEligible")?this.player&&this._isAllowToPlayByMultiUnitManager()&&this._setGeneralPlayingUnitState(!0):this._pausePlayer()},_onUnitViewabilityChange:function(e,t){t&&!this.viewabilityTimer&&0==this.model.get("isUnitEligible")?(e.get("multiUnitManager.isActive")&&this.model.get("secondsInView")>0&&this._showPoster(),this.viewabilityTimer=window.setTimeout(this._onSecondsInView.bind(this),1e3*this.model.get("secondsInView"))):t&&this.model.get("isUnitEligible")?this._resumePlayer():(window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=void 0,this._pausePlayer())},_onUnitEligibleChange:function(e,t,i){if(this.log.debug("Unit Eligibility Change",t),t){if(this.isPlayTriggered||(xd.firePixelConditional(this.model.get("isFirePixel"),this.model.getPixel("pixels.eligible"),"Eligible"),this.log.debug("Play: "+i),k().trigger("play",i),this.isPlayTriggered=!0),k().trigger("eligible"),!this.model.get("isRepeat")&&this.player.player.isCompleted)return;this._isAllowToPlayByMultiUnitManager()&&this._resumePlayer()}},_onSecondsInView:function(){this.$el.off("mouseenter");var e="In view for "+this.model.get("secondsInView")+" seconds.";this.model.set("isUnitEligible",!0,e)},_expand:function(){this.isExpanded||(this.log.info("expanding view"),this._heightDelta=0,this.model.get("isSkipExpand")||this.model.get("height")==this.model.get("height")||(this._expandParents((0,E.default)(this.el)),this.model.get("stayInIframe")&&this._isInFriendlyIframe()&&(this._heightDelta=0,this._expandParents((0,E.default)(cmTag.config.iframeData.iframe)))),this.isExpanded=!0)},_canExpand:function(e,t){return!!isNaN(t)||e<t},_expandParents:function(e){for(var t=Number(this.model.get("maxParentToExpand")),i=0;0!=e.length&&"BODY"!=e[0].tagName&&this._canExpand(i,t);)this._fitsInside(e)||this._expandElement(e),this._firstInsideWidth(e)||this._expandElementWidth(e),e=e.parent(),i++},_fitsInside:function(e){return e.height()>=this._computeHeight()},_computeHeight:function(){return this.model.get("withAdvertisementText")?this.model.get("height")+14:this.model.get("height")},_firstInsideWidth:function(e){return e.width()>=this.model.get("width")},_expandElement:function(e){this._expandedElements.push(e),!this._heightDelta&&e.height()<this.model.get("height")&&(this._heightDelta=this.model.get("height")-e.height());var t=e.height()+parseInt(this._computeHeight())-this.model.get("height")+this._heightDelta;e.css({height:t+"px",transition:"height .5s, width .5s"})},_expandElementWidth:function(e){var t=this.model.get("width");e.css({width:t+"px",transition:"height .5s, width .5s"})},_collapse:function(e){this.log.info("collapsing view"),this._expandedElements.forEach((function(e){var t=e.height()-this.model.get("height");e.height(parseInt(t))}),this),this._expandedElements=[],this.isExpanded=!1,this.player.close(),e?this._loadD2D(this.model.get("components.OptOut.pubId"),this.model.get("components.OptOut.pubTagId")):(this.d2dBanner||this._loadD2D(),this.d2dBanner.hide(!1))},_setModelSize:function(){this.model.set({width:this.model.get("width"),height:this.model.get("height")})},_loadD2D:function(e,t){this.d2dBanner=new kl({model:this.model,container:this.el,pubId:e,pubTagId:t})},_showPoster:function(){this.posterView&&this.posterView.show()},_hideBanner:function(){this.posterView&&this.posterView.hide()},_onVideoCanPlay:function(e){var t=this;e.target.currentTime>0?this._hideBanner():e.target.onplay=function(){t._hideBanner()}},_bannerClick:function(){this._hidePoster(),this.model.set("state",this.model.STATE.PLAYING)},_onContentChanged:function(){"static"===this.model.get("isShowOnAd")&&"begin"!==this.model.get("isShowOnAdLocation")&&this._showPoster()},_checkViewability:function(){if(this.model.get("isForcePlayOutOfView"))return this.model.set("isUnitViewable",!0),void this.model.set("isUnitEligible",!0);var e=this.el;xd.isInFriendlyIframe(this.model.get("iframeData"))&&(e=cmTag.config.iframeData.iframe);var t=this.model.get("width"),i=this.model.get("height");if(this.model.get("isUnitEligible")){var n=xd.isViewable(e,t,i,1);this.model.set("isUnitViewable",n),this.model.set("isUnitEligible",n),this.model.set("unitViewablePercent",xd.getViewPercent(e,t,i))}else this.model.set("isUnitViewable",xd.isViewable(e,t,i,this.model.get("viewPercent"))),this.model.set("unitViewablePercent",xd.getViewPercent(e,t,i))},_findContainer:function(){var e,t="";return this._isInFriendlyIframe()?this.model.get("stayInIframe")?(0,E.default)("body"):(t=cmTag.config.iframeData.iframe.id,e=document.getElementById(t),this.appendType=r().APPEND_TYPE.afterend,e):this._isInIframe()?(0,E.default)("body"):(t="_cm_videoUnit_placeHolder"+this.model.get("redId"),e=document.getElementById(t),xd.isElementInHead(e)?void this.log.error("The creative is in head element, cannot open video here."):(this.appendType=r().APPEND_TYPE.afterend,e))},_findByParentSelector:function(e){if(xd.isString(e)||xd.isArray(e)){var t=(0,E.default)(e.toString());if(xd.isEmpty(t))return;return t.get().reverse()}},_waitViewability:function(){el(),window.setTimeout(this._onWindowPositionChange.bind(this),200)},_onWindowPositionChange:function(){if(!this.isExpanded){var e=this._getInViewDiv();if(e)return this.container=e,this.model.set("width",this.container.width()),this.model.set("height",Math.ceil(xd.getVideoHeight(this.model.get("width")))),void this.render();this.listenToOnce(k(),"window:scroll:change",this._onWindowPositionChange.bind(this))}},_getInViewDiv:function(){for(var e=this.model.get("viewPercent"),t=0;t<this.parentElements.length;t++){var i=(0,E.default)(this.parentElements[t]),n=i.width(),r=xd.getVideoHeight(n);if(xd.isViewable(this.parentElements[t],n,r,e))return i}},_generatePlaceholders:function(){for(var e=[],t=0;t<this.parentElements.length;t++){var i=document.createElement("div");switch(i.className="_cm-placeholder",this.appendType){case r().APPEND_TYPE.afterbegin:this.parentElements[t].insertBefore(i,this.parentElements[t].firstChild);break;case r().APPEND_TYPE.beforeend:this.parentElements[t].appendChild(i)}e.push(i)}return e},_setComponents:function(){this.model.get("components.ClickBlocker.isActive")&&(this.clickBlockerView=new Gc({model:this.model,container:this.container.parent().parent().parent()[0]})),this.model.get("components.BrandLogo.hasBrandLogo")&&(this.brandLogoView=new hl({model:this.model,container:this.el})),this.model.get("components.PosterView.isActive")&&(this.posterView=new ll({model:this.model,container:this.$playerContainer.find("._cm-video-ad")}),this._showPoster())},_isInIframe:function(){return cmTag.config.iframeData.inIframe||cmTag.config.iframeData.inDFP},_isInFriendlyIframe:function(){return this._isInIframe()&&cmTag.config.iframeData.isFriendlyIframe},_onWindowSizeChnage:function(){this.isContainerSize&&this.model.set({width:this.$el.parent().width(),height:this.$el.parent().height()}),this.player&&this.player.resizePlayer(this.model.get("width"),this.model.get("height"))},_bindClickEvent:function(){var e=this.el.parentElement.parentElement.parentElement.parentElement,t=(0,E.default)(e).find("a"),i=this;t&&t.length>0&&t.on("click",(function(){xd.firePixelConditional(i.model.get("isFirePixel"),i.model.getPixel("pixels.clickthrough"),"click")}))}});window.startCMTagMain=function(e,n){!function(e,i,n){var o,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=!1;rl.beforeCMTag(e);var l={unit:void 0,model:void 0,placement:void 0,isUnitPlay:!1};function c(){nl.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoStartUnitVar",r().TRC_PERFORMANCE_ACTIONS.START),o=m(n.model,e),d(window&&window.TRCImpl&&window.TRCImpl.global&&window.TRCImpl.global["video-split-start-unit"]),nl.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoStartUnitVar",r().TRC_PERFORMANCE_ACTIONS.STOP)}function d(e){e?setTimeout((function(){p(n.unitController,o,void 0,s)}),0):p(n.unitController,o,void 0,s)}function u(){if(e.perfUnitType=h(e.unitType),nl.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoInitToRender".concat(e.perfUnitType),r().TRC_PERFORMANCE_ACTIONS.START),e.unitName=e.cm_unitName?e.cm_unitName:e.unitType,e.urlPrefix){var t=e.urlPrefix.split("/");e.unitVersion=t[t.length-2],e.unitVersion=e.unitVersion.replace(/_/g,"")}else e.unitVersion=e.version.replace(/_/g,"");c(),o.get("multiUnitManager.isActive")&&al.addUnit(o.get("redId"),o),o.get("cookieMatchActive")&&new Fn(o)}function h(e){var t=e.replace(/_/g,"").toLowerCase();return"".concat(t.charAt(0).toUpperCase()).concat(t.substring(1))}function p(t,i,n,r){nl.parseBool(e.isWaitForStartEvent)?(l.unit=t,l.model=i,l.placement=n,l.isUnitPlay=r,i.fireUnitDelayedPixel(),window.TRC=window.TRC||{},window.TRCImpl=window.TRCImpl||{},window.TRC.videoFunctions={},window.TRC.videoFunctions.startEvent=function(){a||(l.model.fireUnitLoadAfterDelayPixel(),f(l.unit,l.model,l.placement,l.isUnitPlay),a=!0)}):f(t,i,n,r)}function f(e,t,n,r){var o=new e({model:t,placementElement:n});r&&(i.play=o.play.bind(o))}function m(t,n){nl.trcPerformanceMeasurement(n.trcPerformanceMeasurementEnabled,"videoCreateUnitModel".concat(n.perfUnitType),r().TRC_PERFORMANCE_ACTIONS.START);var o=new ol.DeepModel;o.set(n),i&&i._settings&&(cmTag&&cmTag.logger&&cmTag.logger.info("settings by FPP",i._settings),o.set(i._settings)),S(o.attributes),new sl(o.attributes);var s=new t(o.attributes);return nl.parseBool(e.isUseCMP)?new Rs(s):s.set("canStartPlayer",!0),g(s),y(s),nl.trcPerformanceMeasurement(n.trcPerformanceMeasurementEnabled,"videoCreateUnitModel".concat(n.perfUnitType),r().TRC_PERFORMANCE_ACTIONS.STOP),s}function g(e){if(!0===e.get("isOppsulaEnabled")){var t={version:e.get("microServices.oppsula.version"),model:e},i=new Ks(t);zn().oppsula=i}}function y(e){zn().serviceLoader.get("video-autoplay-detector",e.get("microServices.autoplayDetector.version"),(function(t){zn().autoPlayDetector=new t(e.handleAutoPlayData.bind(e),{isMobile:e.get("isMobile"),timeout:1e3*e.get("autoplayDetectorTimeoutSec")})}))}function v(){cmTag.units=cmTag.units||{},cmTag.units[nl.now()]=e}function b(){i&&(i._events&&(i._events.forEach((function(e){ol.on(e.name,e.cb)})),i.on=function(e,t){ol.on(e,t)}),i.trigger=function(e,t){ol.trigger(e,t)})}function _(){window.TRC=window.TRC||{},ol.$=E.default,nl.templateSettings={interpolate:/\{\{(.+?)\}\}/g},cmTag.logger||(cmTag.logger=new Ya.Z(e)),e.documentReadyState=document.readyState,cmTag&&cmTag.logger&&cmTag.logger.info("init",e),cmTag.utils=nl,cmTag.$=E.default,b(),cmTag.config||(cmTag.config=e);var t=window;nl.isInFriendlyIframe(cmTag.config.iframeData)&&(t=nl.getTopWindow()),e.isHideIframe&&nl.hideDFPIframe(e.iframeData),cmTag.config.scrollSelector?(new el(t,cmTag.config.scrollSelector),new V(e,t,cmTag.config.scrollSelector)):(new el(t),new V(e,t)),w()}function w(){var e=new ol.DeepModel;e.set({microServices:zn().microServices}),e.set(cmTag.config);var i=e.get("microServices");t().init(i),zn().serviceLoader=t(),T(i)}function T(e){zn().serviceLoader.get("PMS",e.PMS.version,P.bind(this),P.bind(this,il()))}function P(e){cmTag&&cmTag.logger&&cmTag.logger.info("PMS Loaded");var t=new e;zn().pms=t,u(),v()}function S(e){if(e.onPassback)e.isApiPassbackExist=!0;else{if(TRC&&TRC._taboolaClone)for(var t=0;t<TRC._taboolaClone.length;t++)if("video.passback"==TRC._taboolaClone[t].listenTo)return void(e.isApiPassbackExist=!0);e.isApiPassbackExist=!1}}nl.parseBool(e.isStartUnitOnWindowLoaded)?("complete"===document.readyState&&_(),document.onreadystatechange=function(){"complete"===document.readyState&&setTimeout(_,0)}):(0,E.default)("document").ready(_)}(e,n,{model:e.isMobile?i(8542).Z:i(1875).Z,unitController:Bd})}}()}();